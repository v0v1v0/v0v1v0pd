<div class="container">

<table style="width: 100%;"><tr>
<td>gggeo_scale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add a geologic scale below ggplots using <em>grid</em>
</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>
</p>
<p>This function takes a ggplot object and adds a geologic time scale at the
specified side using the grid and gtable packages.
</p>
<p>If custom data is provided (with <code>dat</code>), it should consist of at least 3
columns of data. See <code>data(periods)</code> for an example.
</p>

<ul>
<li>
<p> The <code>name</code> column lists the names of each time interval. These will
be used as labels if no abbreviations are provided.
</p>
</li>
<li>
<p> The <code>max_age</code> column lists the oldest boundary of each time interval.
</p>
</li>
<li>
<p> The <code>min_age</code> column lists the youngest boundary of each time
interval.
</p>
</li>
<li>
<p> The <code>abbr</code> column is optional and lists abbreviations that may be
used as labels.
</p>
</li>
<li>
<p> The <code>color</code> column is also optional and lists a hex color code
(which can be obtained with <code>rgb()</code>) for each time interval.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">gggeo_scale(obj, ...)

## S3 method for class 'gtable'
gggeo_scale(
  obj,
  lims,
  dat = "periods",
  fill = NULL,
  color = "black",
  alpha = 1,
  height = unit(2, "line"),
  pos = "bottom",
  lab = TRUE,
  rot = 0,
  abbrv = TRUE,
  skip = c("Quaternary", "Holocene", "Late Pleistocene"),
  size = 5,
  lwd = 0.25,
  margin = unit(0, "line"),
  neg = FALSE,
  bord = c("left", "right", "top", "bottom"),
  center_end_labels = FALSE,
  ...
)

## S3 method for class 'ggplot'
gggeo_scale(
  obj,
  dat = "periods",
  fill = NULL,
  color = "black",
  alpha = 1,
  height = unit(2, "line"),
  pos = "bottom",
  lab = TRUE,
  rot = 0,
  abbrv = TRUE,
  skip = c("Quaternary", "Holocene", "Late Pleistocene"),
  size = 5,
  lwd = 0.25,
  margin = unit(0, "line"),
  neg = FALSE,
  bord = c("left", "right", "top", "bottom"),
  center_end_labels = FALSE,
  ...
)

## S3 method for class 'geo_scale'
gggeo_scale(
  obj,
  dat = "periods",
  fill = NULL,
  color = "black",
  alpha = 1,
  height = unit(2, "line"),
  pos = "bottom",
  lab = TRUE,
  rot = 0,
  abbrv = TRUE,
  skip = c("Quaternary", "Holocene", "Late Pleistocene"),
  size = 5,
  lwd = 0.25,
  margin = unit(0, "line"),
  neg = FALSE,
  bord = c("left", "right", "top", "bottom"),
  center_end_labels = FALSE,
  ...
)

## S3 method for class 'geo_scale'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>An object of class <code>ggplot</code>, <code>gtable</code>, or <code>geo_scale</code> (as produced
by this function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>grid::grid.draw()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lims</code></td>
<td>
<p>The limits of the axis of the desired side of the plot. Only
required if using a gtable object not created by this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Either A) a string indicating a built-in dataframe with interval
data from the ICS ("periods", "epochs", "stages", "eons", or "eras"),
B) a string indicating a timescale from macrostrat (see list here:
<a href="https://macrostrat.org/api/defs/timescales?all">https://macrostrat.org/api/defs/timescales?all</a>),
or C) a custom dataframe of time interval boundaries (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>The fill color of the boxes. The default is to use the colors
included in <code>dat</code>. If a custom dataset is provided with <code>dat</code> without color
and without fill, a greyscale will be used. Custom fill colors can be
provided with this option and will be recycled if/as necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>The outline color of the interval boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The transparency of the fill colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>The height (or width if <code>pos</code> is <code>left</code> or <code>right</code>) of the
scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>Which side to add the scale to (left, right, top, or bottom).
First letter may also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab</code></td>
<td>
<p>Whether to include labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot</code></td>
<td>
<p>The amount of counter-clockwise rotation to add to the labels (in
degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abbrv</code></td>
<td>
<p>If including labels, whether to use abbreviations instead of
full interval names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>A vector of interval names indicating which intervals should not
be labeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Label size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>The width of the margin around the returned object (can be a
vector of length 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p>Set this to true if your x-axis is using negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bord</code></td>
<td>
<p>A vector specifying on Which sides of the scale to add borders
(same options as <code>pos</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center_end_labels</code></td>
<td>
<p>Should labels be centered within the visible range
of intervals at the ends of the axis?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class geo_scale.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A geo_scale object. Basically a gtable object but with the axis
limits included.
</p>


<h3>Life cycle</h3>

<p>This function is soft-deprecated in favor of <code>coord_geo()</code> as of <strong>deeptime</strong>
version 1.0.0. It may be removed in the future.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)
# bottom scale by default
p &lt;- ggplot() +
  geom_point(aes(y = runif(1000, 0, 8), x = runif(1000, 0, 1000))) +
  scale_x_reverse() +
  coord_cartesian(xlim = c(1000, 0), ylim = c(0, 8), expand = FALSE) +
  theme_classic()
gggeo_scale(p)

# can specify any side of the plot
p &lt;- ggplot() +
  geom_point(aes(x = runif(1000, 0, 8), y = runif(1000, 0, 1000))) +
  scale_y_reverse() +
  coord_cartesian(xlim = c(0, 8), ylim = c(1000, 0), expand = FALSE) +
  theme_classic()
gggeo_scale(p, pos = "left", rot = 90)

# can add multiple scales
p &lt;- ggplot() +
  geom_point(aes(y = runif(1000, 0, 8), x = runif(1000, 0, 100))) +
  scale_x_reverse() +
  coord_cartesian(xlim = c(100, 0), ylim = c(0, 8), expand = FALSE) +
  theme_classic()
p &lt;- gggeo_scale(p, abbrv = FALSE)
p &lt;- gggeo_scale(p, dat = "epochs", height = unit(4, "lines"), rot = 90,
                 size = 2.5, abbrv = FALSE)
gggeo_scale(p, dat = "stages", height = unit(4, "lines"), rot = 90,
            size = 2.5, abbrv = FALSE)
## Not run: 
# intervals on both sides for different timescales (ICS stages vs North
# American Land Mammal Ages)
p &lt;- ggplot() +
  geom_point(aes(x = runif(1000, 0, 10), y = runif(1000, 0, 65))) +
  scale_y_reverse() +
  coord_cartesian(xlim = c(0, 10), ylim = c(65, 0), expand = FALSE) +
  theme_classic()
p &lt;- gggeo_scale(p, dat = "stages", pos = "left", height = unit(4, "lines"),
  size = 2.5, abbrv = FALSE)
gggeo_scale(p, dat = "North American Land Mammal Ages",
            pos = "right", height = unit(4, "lines"),
            size = 2.5, abbrv = FALSE)

## End(Not run)

# can add scales to a faceted plot
# use gggeo_scale_old() if you have more than one column
df &lt;- data.frame(
  x = runif(1000, 0, 541), y = runif(1000, 0, 8),
  z = sample(c(1, 2, 3, 4), 1000, TRUE)
)
p &lt;- ggplot(df) +
  geom_point(aes(x, y)) +
  scale_x_reverse() +
  coord_cartesian(xlim = c(541, 0), ylim = c(0, 8), expand = FALSE) +
  theme_classic() +
  facet_wrap(~z, ncol = 1)
gggeo_scale(p)

# can even add a scale to a phylogeny (using ggtree)

library(phytools)
library(ggtree)
tree &lt;- pbtree(b = .03, d = .01, n = 100)
p &lt;- ggtree(tree) +
  coord_cartesian(xlim = c(-500, 0), ylim = c(-2, Ntip(tree)),
                  expand = FALSE) +
  scale_x_continuous(breaks = seq(-500, 0, 100),
                     labels = abs(seq(-500, 0, 100))) +
  theme_tree2()
p &lt;- revts(p)
gggeo_scale(p, neg = TRUE)

</code></pre>


</div>