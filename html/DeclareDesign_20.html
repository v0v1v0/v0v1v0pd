<div class="container">

<table style="width: 100%;"><tr>
<td>diagnosand_handler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Declare diagnosands</h2>

<h3>Description</h3>

<p>Declare diagnosands
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnosand_handler(data, ..., subset = NULL, alpha = 0.05, label)

declare_diagnosands(..., handler = diagnosand_handler, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>A set of new diagnosands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A subset of the simulations data frame within which to calculate diagnosands e.g. <code>subset = p.value &lt; .05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Alpha significance level. Defaults to <code>.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Label for the set of diagnosands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>handler</code></td>
<td>
<p>a tidy-in, tidy-out function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If term is TRUE, the names of ... will be returned in a <code>term</code> column, and <code>inquiry</code>
will contain the step label. This can be used as an additional dimension for use in diagnosis.
</p>
<p>Diagnosands summarize the simulations generated by <code>diagnose_design</code> or <code>simulate_design</code>. Typically, the columns of the resulting simulations data.frame include the following variables: estimate, std.error, p.value, conf.low, conf.high, and inquiry. Many diagnosands will be a function of these variables.
</p>


<h3>Value</h3>

<p>a function that returns a data.frame
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Two-arm randomized experiment
design &lt;-
  declare_model(
    N = 500,
    gender = rbinom(N, 1, 0.5),
    X = rep(c(0, 1), each = N / 2),
    U = rnorm(N, sd = 0.25),
    potential_outcomes(Y ~ 0.2 * Z + X + U)
  ) +
  declare_inquiry(ATE = mean(Y_Z_1 - Y_Z_0)) +
  declare_sampling(S = complete_rs(N = N, n = 200)) +
  declare_assignment(Z = complete_ra(N = N, m = 100)) +
  declare_measurement(Y = reveal_outcomes(Y ~ Z)) +
  declare_estimator(Y ~ Z, inquiry = "ATE")

## Not run: 
# using built-in defaults:
diagnosis &lt;- diagnose_design(design)
diagnosis

# You can choose your own diagnosands instead of the defaults:

my_diagnosands &lt;-
  declare_diagnosands(median_bias = median(estimate - estimand))

## You can set diagnosands within the diagnose_design function
## using the 'diagnosands =' argument
diagnosis &lt;- diagnose_design(design, diagnosands = my_diagnosands)
diagnosis

## You can also set diagnosands with set_diagnosands 
design &lt;- set_diagnosands(design, diagnosands = my_diagnosands)
diagnosis &lt;- diagnose_design(design)
diagnosis

# If you do not specify diagnosands in diagnose_design, 
#   the function default_diagnosands() is used, 
#   which is reproduced below.

alpha &lt;- 0.05

default_diagnosands &lt;- 
  declare_diagnosands(
    mean_estimand = mean(estimand),
    mean_estimate = mean(estimate),
    bias = mean(estimate - estimand),
    sd_estimate = sqrt(pop.var(estimate)),
    rmse = sqrt(mean((estimate - estimand) ^ 2)),
    power = mean(p.value &lt;= alpha),
    coverage = mean(estimand &lt;= conf.high &amp; estimand &gt;= conf.low)
  )
  
diagnose_design(
  design,
  diagnosands = default_diagnosands
)

# A longer list of potentially useful diagnosands might include:

extended_diagnosands &lt;- 
  declare_diagnosands(
    mean_estimand = mean(estimand),
    mean_estimate = mean(estimate),
    bias = mean(estimate - estimand),
    sd_estimate = sd(estimate),
    rmse = sqrt(mean((estimate - estimand) ^ 2)),
    power = mean(p.value &lt;= alpha),
    coverage = mean(estimand &lt;= conf.high &amp; estimand &gt;= conf.low),
    mean_se = mean(std.error),
    type_s_rate = mean((sign(estimate) != sign(estimand))[p.value &lt;= alpha]),
    exaggeration_ratio = mean((estimate/estimand)[p.value &lt;= alpha]),
    var_estimate = pop.var(estimate),
    mean_var_hat = mean(std.error^2),
    prop_pos_sig = mean(estimate &gt; 0 &amp; p.value &lt;= alpha),
    mean_ci_length = mean(conf.high - conf.low)
  )
  
diagnose_design(
  design,
  diagnosands = extended_diagnosands
)

## End(Not run)
</code></pre>


</div>