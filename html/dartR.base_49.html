<div class="container">

<table style="width: 100%;"><tr>
<td>gl.mahal.assign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assigns individuals to populations with an associated probability</h2>

<h3>Description</h3>

<p>Uses Mahalanobis Distances between individuals and group centroids to
calculate probability of group membership
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.mahal.assign(
  x,
  plot.display = TRUE,
  plot.theme = theme_dartR(),
  plot.colors = NULL,
  plot.file = NULL,
  plot.dir = NULL,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of the genlight object [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.display</code></td>
<td>
<p>If TRUE, resultant plots are displayed in the plot window
[default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.theme</code></td>
<td>
<p>Theme for the plot. See Details for options
[default theme_dartR()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.colors</code></td>
<td>
<p>List of two color names for the borders and fill of the
plots [default c("#2171B5","#6BAED6")].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.file</code></td>
<td>
<p>Name for the RDS binary file to save (base name only, exclude extension) [default NULL]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dir</code></td>
<td>
<p>Directory to save the plot RDS files [default as specified 
by the global working directory or tempdir()]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default NULL, unless specified using gl.set.verbosity]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function generates 200 simulated individuals for each group (=population in the
genlight object) drawing from the observed allele frequencies for each group.
The group centroids and covariance matricies are calculated for these simulated
groups. The covariance matrix is inverted using package MASS::ginv to overcome the
singularities that would otherwise arise with typical SNP data. Mahanobilis
Distances are calculated using stats::mahanalobis for each individual in the
dataset and associated Chi Square probabilities of group membership are calculated for
each individual in the original genlight object. The resultant table can be
used for decisions on group membership. A special group (=population in the
genlight object) called 'unknowns' can be used to specifically identify 
individuals with unknown group membership.
</p>
<p>A color vector can be obtained with gl.select.colors() and then passed to the function
with the plot.colors parameter.
Themes can be obtained from in </p>

<ul>
<li> <p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and </p>
</li>
<li>
<p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a>
</p>
</li>
</ul>
<p>If a plot.file is given, the ggplot arising from this function is saved as an "RDS" 
binary file using saveRDS(); can be reloaded with readRDS(). A file name must be 
specified for the plot to be saved.
If a plot directory (plot.dir) is specified, the ggplot binary is saved to that
directory; otherwise to the tempdir().
</p>


<h3>Value</h3>

<p>The unchanged genlight object
</p>


<h3>Author(s)</h3>

<p>Custodian: Arthur Georges â€“ Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>
</p>


<h3>See Also</h3>

<p>Other matched reports: 
<code>gl.report.bases()</code>,
<code>gl.report.factorloadings()</code>,
<code>gl.report.fstat()</code>,
<code>gl.report.monomorphs()</code>
</p>


</div>