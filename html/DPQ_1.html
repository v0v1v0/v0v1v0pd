<div class="container">

<table style="width: 100%;"><tr>
<td>DPQ-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density, Probability, Quantile ('DPQ') Computations</h2>

<h3>Description</h3>

<p>Computations for approximations and alternatives for the 'DPQ'
  (Density (pdf), Probability (cdf) and Quantile) functions for probability
  distributions in R.
  Primary focus is on (central and non-central) beta, gamma and related
  distributions such as the chi-squared, F, and t.
  –
  For several distribution functions, provide functions implementing formulas from
  Johnson, Kotz, and Kemp (1992) &lt;doi:10.1002/bimj.4710360207&gt;  and
  Johnson, Kotz, and Balakrishnan (1995) for discrete or continuous
  distributions respectively.
  This is for the use of researchers in these numerical approximation
  implementations, notably for my own use in order to improve standard
  R pbeta(), qgamma(), ..., etc: {'"dpq"'-functions}.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file: 
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> DPQ</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Density, Probability, Quantile ('DPQ') Computations</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 0.5-9</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-08-23</td>
</tr>
<tr>
<td style="text-align: left;">
VersionNote: </td>
<td style="text-align: left;"> Last CRAN: 0.5-8 on 2023-11-30;  0.5-7 on 2023-11-03</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(person("Martin","Maechler", role=c("aut","cre"),
                    email="maechler@stat.math.ethz.ch", comment = c(ORCID = "0000-0002-8685-9910"))
  , person("Morten",   "Welinder",    role = "ctb", comment = "pgamma C code, see PR#7307, Jan. 2005; further pdhyper()")
  , person("Wolfgang", "Viechtbauer", role = "ctb", comment = "dtWV(), 2002")
  , person("Ross",     "Ihaka",       role = "ctb", comment = "src/qchisq_appr.c")
  , person("Marius",   "Hofert",      role = "ctb", comment = "lsum(), lssum()")
  , person("R-core", email = "R-core@R-project.org", role = "ctb", comment = "src/{dpq.h, algdiv.c, pnchisq.c, bd0.c}")
  , person("R Foundation", role = "cph", comment = "src/qchisq-appr.c")
  	     )</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Computations for approximations and alternatives for the 'DPQ'
  (Density (pdf), Probability (cdf) and Quantile) functions for probability
  distributions in R.
  Primary focus is on (central and non-central) beta, gamma and related
  distributions such as the chi-squared, F, and t.
  --
  For several distribution functions, provide functions implementing formulas from
  Johnson, Kotz, and Kemp (1992) &lt;doi:10.1002/bimj.4710360207&gt;  and
  Johnson, Kotz, and Balakrishnan (1995) for discrete or continuous
  distributions respectively.
  This is for the use of researchers in these numerical approximation
  implementations, notably for my own use in order to improve standard
  R pbeta(), qgamma(), ..., etc: {'"dpq"'-functions}.</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 4.0.0)</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> stats, graphics, methods, utils, sfsmisc (&gt;= 1.1-14)</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> Rmpfr, DPQmpfr (&gt;= 0.3-1), gmp, MASS, mgcv, scatterplot3d, interp, cobs</td>
</tr>
<tr>
<td style="text-align: left;">
SuggestsNote: </td>
<td style="text-align: left;"> MASS::fractions() in ex | mgcv, scatt.., .., cobs: some tests/</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
<td style="text-align: left;">
Encoding: </td>
<td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
<td style="text-align: left;">
URL: </td>
<td style="text-align: left;"> https://specfun.r-forge.r-project.org/,
https://r-forge.r-project.org/R/?group_id=611,
https://r-forge.r-project.org/scm/viewvc.php/pkg/DPQ/?root=specfun,
svn://svn.r-forge.r-project.org/svnroot/specfun/pkg/DPQ</td>
</tr>
<tr>
<td style="text-align: left;">
BugReports: </td>
<td style="text-align: left;"> https://r-forge.r-project.org/tracker/?atid=2462&amp;group_id=611</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Martin Maechler [aut, cre] (&lt;https://orcid.org/0000-0002-8685-9910&gt;),
  Morten Welinder [ctb] (pgamma C code, see PR#7307, Jan. 2005; further
    pdhyper()),
  Wolfgang Viechtbauer [ctb] (dtWV(), 2002),
  Ross Ihaka [ctb] (src/qchisq_appr.c),
  Marius Hofert [ctb] (lsum(), lssum()),
  R-core [ctb] (src/{dpq.h, algdiv.c, pnchisq.c, bd0.c}),
  R Foundation [cph] (src/qchisq-appr.c)</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
.D_0                    Distribution Utilities "dpq"
Bern                    Bernoulli Numbers
DPQ-package             Density, Probability, Quantile ('DPQ')
                        Computations
Ixpq                    Normalized Incomplete Beta Function "Like"
                        'pbeta()'
M_LN2                   Numerical Utilities - Functions, Constants
algdiv                  Compute log(gamma(b)/gamma(a+b)) when b &gt;= 8
b_chi                   Compute E[chi_nu]/sqrt(nu) useful for t- and
                        chi-Distributions
bd0                     Binomial Deviance - Auxiliary Functions for
                        'dgamma()' Etc
bpser                   'pbeta()' 'bpser' series computation
chebyshevPoly           Chebyshev Polynomial Evaluation
dbinom_raw              R's C Mathlib (Rmath) dbinom_raw() Binomial
                        Probability pure R Function
dgamma.R                Gamma Density Function Alternatives
dhyperBinMolenaar       HyperGeometric (Point) Probabilities via
                        Molenaar's Binomial Approximation
dnbinomR                Pure R Versions of R's C (Mathlib) dnbinom()
                        Negative Binomial Probabilities
dnchisqR                Approximations of the (Noncentral) Chi-Squared
                        Density
dntJKBf1                Non-central t-Distribution Density - Algorithms
                        and Approximations
dpsifn                  Psi Gamma Functions Workhorse from R's API
dtWV                    Asymptotic Noncentral t Distribution Density by
                        Viechtbauer
expm1x                  Accurate exp(x) - 1 - x (for smallish |x|)
format01prec            Format Numbers in [0,1] with "Precise" Result
frexp                   Base-2 Representation and Multiplication of
                        Numbers
gam1d                   Compute 1/Gamma(x+1) - 1 Accurately
gamln1                  Compute log( Gamma(x+1) ) Accurately in [-0.2,
                        1.25]
gammaVer                Gamma Function Versions
hyper2binomP            Transform Hypergeometric Distribution
                        Parameters to Binomial Probability
lbetaM                  (Log) Beta and Ratio of Gammas Approximations
lfastchoose             R versions of Simple Formulas for Logarithmic
                        Binomial Coefficients
lgamma1p                Accurate 'log(gamma(a+1))'
lgammaAsymp             Asymptotic Log Gamma Function
log1mexp                Compute log(1 - exp(-a)) and log(1 + exp(x))
                        Numerically Optimally
log1pmx                 Accurate 'log(1+x) - x' Computation
logcf                   Continued Fraction Approximation of Log-Related
                        Power Series
logspace.add            Logspace Arithmetix - Addition and Subtraction
lssum                   Compute Logarithm of a Sum with Signed Large
                        Summands
lsum                    Properly Compute the Logarithm of a Sum (of
                        Exponentials)
newton                  Simple R level Newton Algorithm, Mostly for
                        Didactical Reasons
p1l1                    Numerically Stable p1l1(t) = (t+1)*log(1+t) - t
pbetaRv1                Pure R Implementation of Old pbeta()
pchisqV                 Wienergerm Approximations to (Non-Central)
                        Chi-squared Probabilities
phyper1molenaar         Molenaar's Normal Approximations to the
                        Hypergeometric Distribution
phyperAllBin            Compute Hypergeometric Probabilities via
                        Binomial Approximations
phyperApprAS152         Normal Approximation to cumulative Hyperbolic
                        Distribution - AS 152
phyperBin.1             HyperGeometric Distribution via Approximate
                        Binomial Distribution
phyperBinMolenaar       HyperGeometric Distribution via Molenaar's
                        Binomial Approximation
phyperIbeta             Pearson's incomplete Beta Approximation to the
                        Hyperbolic Distribution
phyperPeizer            Peizer's Normal Approximation to the Cumulative
                        Hyperbolic
phyperR                 R-only version of R's original phyper()
                        algorithm
phyperR2                Pure R version of R's C level phyper()
phypers                 The Four (4) Symmetric 'phyper()' Calls
pl2curves               Plot 2 Noncentral Distribution Curves for
                        Visual Comparison
pnbetaAppr2             Noncentral Beta Probabilities
pnchi1sq                (Probabilities of Non-Central Chi-squared
                        Distribution for Special Cases
pnchisq                 (Approximate) Probabilities of Non-Central
                        Chi-squared Distribution
pnormAsymp              Asymptotic Approxmation of (Extreme Tail)
                        'pnorm()'
pnormL_LD10             Bounds for 1-Phi(.) - Mill's Ratio related
                        Bounds for pnorm()
pntR                    Non-central t Probability Distribution -
                        Algorithms and Approximations
pow                     X to Power of Y - R C API 'R_pow()'
pow1p                   Accurate (1+x)^y, notably for small |x|
ppoisErr                Direct Computation of 'ppois()' Poisson
                        Distribution Probabilities
pt_Witkovsky_Tab1       Viktor Witosky's Table_1 pt() Examples
qbetaAppr               Compute (Approximate) Quantiles of the Beta
                        Distribution
qbinomR                 Pure R Implementation of R's qbinom() with
                        Tuning Parameters
qchisqAppr              Compute Approximate Quantiles of the
                        Chi-Squared Distribution
qgammaAppr              Compute (Approximate) Quantiles of the Gamma
                        Distribution
qnbinomR                Pure R Implementation of R's qnbinom() with
                        Tuning Parameters
qnchisqAppr             Compute Approximate Quantiles of Noncentral
                        Chi-Squared Distribution
qnormAppr               Approximations to 'qnorm()', i.e., z_alpha
qnormAsymp              Asymptotic Approximation to Outer Tail of
                        qnorm()
qnormR                  Pure R version of R's 'qnorm()' with
                        Diagnostics and Tuning Parameters
qntR                    Pure R Implementation of R's qt() / qnt()
qpoisR                  Pure R Implementation of R's qpois() with
                        Tuning Parameters
qtAppr                  Compute Approximate Quantiles of the
                        (Non-Central) t-Distribution
qtR                     Pure R Implementation of R's C-level
                        t-Distribution Quantiles 'qt()'
qtU                     'uniroot()'-based Computing of t-Distribution
                        Quantiles
r_pois                  Compute Relative Size of i-th term of Poisson
                        Distribution Series
rexpm1                  TOMS 708 Approximation REXP(x) of expm1(x) =
                        exp(x) - 1
stirlerr                Stirling's Error Function - Auxiliary for
                        Gamma, Beta, etc
</pre>

<p>Further information is available in the following vignettes:<br><br></p>

<table>
<tr>
<td style="text-align: left;">
<code>Noncentral-Chisq</code> </td>
<td style="text-align: left;"> Noncentral Chi-Squared Probabilities -- Algorithms in R (source)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>comp-beta</code> </td>
<td style="text-align: left;"> Computing Beta(a,b) for Large Arguments (source)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>log1pmx-etc</code> </td>
<td style="text-align: left;"> log1pmx, bd0, stirlerr - Probability Computations in R (source)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>qnorm-asymp</code> </td>
<td style="text-align: left;"> Asymptotic Tail Formulas For Gaussian Quantiles (source)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>An important goal is to investigate diverse algorithms and approximations
of <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s own density (<code>d*()</code>), probability (<code>p*()</code>), and
quantile (<code>q*()</code>) functions, notably in “border” cases where
the traditional published algorithms have shown to be suboptimal, not
quite accurate, or even useless.
</p>
<p>Examples are border cases of the beta distribution, or <b>non-central</b>
distributions such as the non-central chi-squared and t-distributions.
</p>


<h3>Author(s)</h3>

<p>Principal author and maintainer: Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;

</p>


<h3>See Also</h3>

<p>The package <span class="pkg">DPQmpfr</span>,
which builds on this package and on
<span class="pkg">Rmpfr</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Show problem in R's non-central t-distrib. density (and approximations):
example(dntJKBf)


</code></pre>


</div>