<div class="container">

<table style="width: 100%;"><tr>
<td>utils.hamming</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the Hamming distance between two DArT trimmed DNA sequences</h2>

<h3>Description</h3>

<p>WARNING: UTILITY SCRIPTS ARE FOR INTERNAL USE ONLY AND SHOULD NOT BE USED BY END USERS AS THEIR USE OUT OF CONTEXT COULD LEAD TO UNPREDICTABLE OUTCOMES.
The algorithm is that of Johann de Jong
<a href="https://johanndejong.wordpress.com/2015/10/02/faster-hamming-distance-in-r-2/">https://johanndejong.wordpress.com/2015/10/02/faster-hamming-distance-in-r-2/</a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">utils.hamming(str1, str2, r = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>str1</code></td>
<td>
<p>String containing the first sequence [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>str2</code></td>
<td>
<p>String containing the second sequence [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Number of bases in the restriction enzyme recognition sequence
[default 4].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hamming distance is calculated as the number of base differences between two
sequences which can be expressed as a count or a proportion. Typically, it is
calculated between two sequences of equal length. In the context of DArT
trimmed sequences, which differ in length but which are anchored to the left
by the restriction enzyme recognition sequence, it is sensible to compare the
two trimmed sequences starting from immediately after the common recognition
sequence and terminating at the last base of the shorter sequence.
The Hamming distance between the rows of a matrix can be computed quickly
by exploiting the fact that the dot product of two binary vectors x and (1-y)
counts the corresponding elements that are different between x and y.
This matrix multiplication can also be used for matrices with more than two
possible values, and different types of elements, such as DNA sequences.
The function calculates the Hamming distance between all columns of a
matrix X, or two matrices X and Y. Again matrix multiplication is used, this
time for counting, between two columns x and y, the number of cases in which
corresponding elements have the same value (e.g. A, C, G or T). This counting
is done for each of the possible values individually, while iteratively adding
the results. The end result of the iterative adding is the sum of all
corresponding elements that are the same, i.e. the inverse of the Hamming
distance. Therefore, the last step is to subtract this end result H from the
maximum possible distance, which is the number of rows of matrix X.
If the two DNA sequences are of differing length, the longer is truncated. The
initial common restriction enzyme recognition sequence is ignored.
</p>


<h3>Value</h3>

<p>Hamming distance between the two strings
</p>


<h3>Author(s)</h3>

<p>Custodian: Arthur Georges (Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>)
</p>


<h3>See Also</h3>

<p>Other utilities: 
<code>gl.alf()</code>,
<code>utils.check.datatype()</code>,
<code>utils.dart2genlight()</code>,
<code>utils.dist.binary()</code>,
<code>utils.flag.start()</code>,
<code>utils.het.pop()</code>,
<code>utils.impute</code>,
<code>utils.is.fixed()</code>,
<code>utils.jackknife()</code>,
<code>utils.n.var.invariant()</code>,
<code>utils.plot.save()</code>,
<code>utils.read.fasta()</code>,
<code>utils.read.ped()</code>,
<code>utils.recalc.avgpic()</code>,
<code>utils.recalc.callrate()</code>,
<code>utils.recalc.freqhets()</code>,
<code>utils.recalc.freqhomref()</code>,
<code>utils.recalc.freqhomsnp()</code>,
<code>utils.recalc.maf()</code>,
<code>utils.reset.flags()</code>,
<code>utils.transpose()</code>,
<code>utils.vcfr2genlight.polyploid()</code>
</p>


</div>