<div class="container">

<table style="width: 100%;"><tr>
<td>qnchisqAppr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Approximate Quantiles of Noncentral Chi-Squared Distribution</h2>

<h3>Description</h3>



<p>Compute quantiles (inverse distribution values) for the <em>non-central</em>
chi-squared distribution.
</p>
<p>....... using Johnson,Kotz,  and other approximations ..............
</p>


<h3>Usage</h3>

<pre><code class="language-R">qchisqAppr.0 (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqAppr.1 (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqAppr.2 (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqAppr.3 (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqApprCF1(p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqApprCF2(p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)

qchisqCappr.2 (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qchisqN       (p, df, ncp = 0, qIni = qchisqAppr.0, ...)

qnchisqAbdelAty  (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qnchisqBolKuz    (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qnchisqPatnaik   (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qnchisqPearson   (p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
qnchisqSankaran_d(p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>



<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom <code class="reqn">&gt; 0</code>, maybe non-integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>non-centrality parameter <code class="reqn">\delta</code>; ....</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail, log.p</code></td>
<td>
<p>logical, see, e.g., <code>qchisq()</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>qIni</code></td>
<td>
<p>a <code>function</code> that computes an approximate
noncentral chi-squared quantile as starting value <code>x0</code> for the
Newton algorithm <code>newton()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to <code>newton()</code>, notably
<code>eps</code> or <code>maxiter</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute (approximate) quantiles, using approximations analogous to those
for the probabilities, see <code>pnchisqPearson</code>.
</p>

<dl>
<dt>qchisqAppr.0():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqAppr.1():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqAppr.2():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqAppr.3():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqApprCF1():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqApprCF2():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqCappr.2():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qchisqN():</dt>
<dd>
<p>Uses Newton iterations with <code>pchisq()</code>
and <code>dchisq()</code> to determine <code>qchisq(.)</code> values.</p>
</dd>
<dt>qnchisqAbdelAty():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qnchisqBolKuz():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qnchisqPatnaik():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qnchisqPearson():</dt>
<dd>
<p> ...TODO... </p>
</dd>
<dt>qnchisqSankaran_d():</dt>
<dd>
<p> ...TODO... </p>
</dd>
</dl>
<h3>Value</h3>

<p><code>numeric</code> vectors of (noncentral) chi-squared quantiles,
corresponding to probabilities <code>p</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, from May 1999;  starting from a post to the S-news
mailing list by Ranjan Maitra (@ math.umbc.edu) who showed a version of
our <code>qchisqAppr.0()</code> thanking Jim Stapleton for providing it.
</p>


<h3>References</h3>

<p>Johnson, N.L., Kotz, S. and Balakrishnan, N. (1995)
Continuous Univariate Distributions Vol 2, 2nd ed.; Wiley;
chapter 29 <em>Noncentral <code class="reqn">\chi^2</code>-Distributions</em>;
notably Section <em>8  Approximations</em>, p.461 ff.
</p>


<h3>See Also</h3>

<p><code>qchisq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> pp &lt;- c(.001, .005, .01, .05, (1:9)/10, .95, .99, .995, .999)
 pkg &lt;- "package:DPQ"
 qnchNms &lt;- c(paste0("qchisqAppr.",0:3), paste0("qchisqApprCF",1:2),
              "qchisqN", "qchisqCappr.2", ls(pkg, pattern = "^qnchisq"))
 qnchF &lt;- sapply(qnchNms, get, envir = as.environment(pkg))
 for(ncp in c(0, 1/8, 1/2)) {
   cat("\n~~~~~~~~~~~~~\nncp: ", ncp,"\n=======\n")
   print(sapply(qnchF, function(F) Vectorize(F, "p")(pp, df = 3, ncp=ncp)))
 }

## Bug: qnchisqSankaran_d() has numeric overflow problems for large df:
qnchisqSankaran_d(pp, df=1e200, ncp = 100)

## One current (2019-08) R bug: Noncentral chi-squared quantiles on *LOG SCALE*

## a)  left/lower tail : -------------------------------------------------------
qs &lt;- 2^seq(0,11, by=1/16)
pqL &lt;- pchisq(qs, df=5, ncp=1, log.p=TRUE)
plot(qs, -pqL, type="l", log="xy") # + expected warning on log(0) -- all fine
qpqL &lt;- qchisq(pqL, df=5, ncp=1, log.p=TRUE) # severe overflow :
qm &lt;- cbind(qs, pqL, qchisq=qpqL
	, qchA.0 = qchisqAppr.0 (pqL, df=5, ncp=1, log.p=TRUE)
	, qchA.1 = qchisqAppr.1 (pqL, df=5, ncp=1, log.p=TRUE)
	, qchA.2 = qchisqAppr.2 (pqL, df=5, ncp=1, log.p=TRUE)
	, qchA.3 = qchisqAppr.3 (pqL, df=5, ncp=1, log.p=TRUE)
	, qchACF1= qchisqApprCF1(pqL, df=5, ncp=1, log.p=TRUE)
	, qchACF2= qchisqApprCF2(pqL, df=5, ncp=1, log.p=TRUE)
	, qchCa.2= qchisqCappr.2(pqL, df=5, ncp=1, log.p=TRUE)
	, qnPatnaik   = qnchisqPatnaik   (pqL, df=5, ncp=1, log.p=TRUE)
	, qnAbdelAty  = qnchisqAbdelAty  (pqL, df=5, ncp=1, log.p=TRUE)
	, qnBolKuz    = qnchisqBolKuz    (pqL, df=5, ncp=1, log.p=TRUE)
	, qnPearson   = qnchisqPearson   (pqL, df=5, ncp=1, log.p=TRUE)
	, qnSankaran_d= qnchisqSankaran_d(pqL, df=5, ncp=1, log.p=TRUE)
)

round(qm[ qs %in% 2^(0:11) , -2])
#=&gt; Approximations don't overflow but are not good enough

## b)  right/upper tail , larger ncp -------------------------------------------
qS &lt;- 2^seq(-3, 3, by=1/8)
pqLu &lt;- pchisq(qS, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
## using "the alternative" (here is currently identical):
identical(pqLu, (pqLu.&lt;- log1p(-pchisq(qS, df=5, ncp=100)))) # here TRUE
plot (qS, -pqLu, type="l", log="xy") # fine
qpqLu &lt;- qchisq(pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
cbind(qS, pqLu, pqLu, qpqLu)# # severe underflow
qchMat &lt;- cbind(qchisq = qpqLu
	, qchA.0 = qchisqAppr.0 (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchA.1 = qchisqAppr.1 (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchA.2 = qchisqAppr.2 (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchA.3 = qchisqAppr.3 (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchACF1= qchisqApprCF1(pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchACF2= qchisqApprCF2(pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qchCa.2= qchisqCappr.2(pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qnPatnaik   = qnchisqPatnaik   (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qnAbdelAty  = qnchisqAbdelAty  (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qnBolKuz    = qnchisqBolKuz    (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qnPearson   = qnchisqPearson   (pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	, qnSankaran_d= qnchisqSankaran_d(pqLu, df=5, ncp=100, log.p=TRUE, lower.tail=FALSE)
	)
cbind(L2err &lt;- sort(sqrt(colSums((qchMat - qS)^2))))
##--&gt; "Sankaran_d", "CF1" and "CF2" are good here

plot (qS, qpqLu, type = "b", log="x", lwd=2)
lines(qS, qS, col="gray", lty=2, lwd=3)
top3 &lt;- names(L2err)[1:3]
use &lt;- c("qchisq", top3)
matlines(qS, qchMat[, use]) # 3 of the approximations are "somewhat ok"
legend("topleft", c(use,"True"), bty="n", col=c(palette()[1:4], "gray"),
                  lty = c(1:4,2), lwd = c(2, 1,1,1, 3))
</code></pre>


</div>