<div class="container">

<table style="width: 100%;"><tr>
<td>dfba_bayes_vs_t_power</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulated Distribution-Free Bayesian Power and <em>t</em> Power</h2>

<h3>Description</h3>

<p>The function is a design tool for comparing Bayesian distribution-free
power versus frequentist <em>t</em> power for a range of sample sizes. Allows
for the stipulation of one of nine probability models for data generation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dfba_bayes_vs_t_power(
  n_min = 20,
  delta,
  model,
  design,
  effect_crit = 0.95,
  shape1 = 1,
  shape2 = 1,
  samples = 1000,
  a0 = 1,
  b0 = 1,
  block_max = 0,
  hide_progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_min</code></td>
<td>
<p>Smallest desired value of sample size for power calculations (minimun 20; default is also 20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Offset amount between the two variates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Theoretical probability model for the data. One of <code>"normal"</code>, <code>"weibull"</code>, <code>"cauchy"</code>, <code>"lognormal"</code>, <code>"chisquare"</code>, <code>"logistic"</code>, <code>"exponential"</code>, <code>"gumbel"</code>, or <code>"pareto"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>Indicates the data structure. One of <code>"independent"</code> or <code>"paired"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_crit</code></td>
<td>
<p>Stipulated value for a significant differences for a <em>t</em>-test (1 - <em>p</em>), and the critical probability for the Bayesian alternative hypothesis for a Bayesian distribution-free analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>
<p>The shape parameter for the condition 1 variate for the distribution indicated by the <code>model</code> input (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>
<p>The shape parameter for the condition 2 variate for the distribution indicated by the <code>model</code> input (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>Desired number of Monte Carlo data sets drawn to estimate the power (default is 1000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>The first shape parameter for the prior beta distribution (default is 1). Must be positive and finite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The second shape parameter for the prior beta distribution (default is 1). Must be positive and finite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_max</code></td>
<td>
<p>The maximum size for a block effect (default is 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide_progress</code></td>
<td>
<p>(Optional) If <code>TRUE</code>, hide percent progress while Monte Carlo sampling is running. (default is <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Researchers need to make experimental-design decisions such as the choice
about the sample size per condition and the decision of whether to use a
within-block design or an independent-groups design. These planning issues
arise regardless if one uses either a frequentist or a Bayesian approach to
statistical inference. In the DFBA package, there are a number of functions
to help users with these decisions. The <code>dfba_bayes_vs_t_power()</code> function
produces (a) the Bayesian power estimate from a distribution-free analysis
and (b) the corresponding frequentist power from a parametric <em>t</em>-test
for a set of 11 sample sizes ranging from <code>n_min</code> to <code>n_min + 50</code>
in steps of 5. These estimates are based on a number of different Monte-
Carlo-sampled data sets generated by the <code>dfba_sim_data()</code> function.
</p>
<p>For each data set, statistical tests are performed. If <code>design = "paired"</code>,
the frequentist <em>t</em>-test is a one-tailed test on the within-block
difference scores to assess the null hypothesis that the population mean for
<code>E</code> is greater than the population mean for <code>C</code>; if
<code>design = "independent"</code>, the frequentist <em>t</em>-test is the one-tailed
test to assess if there is a significant difference between the two
independent conditions (<em>i.e.</em> if the mean for condition 2 is
significantly greater than the condition 1 mean). If <code>design = "paired"</code>,
the Bayesian analysis assesses if the posterior probability for <code>phi_w &gt; .5</code>
from the Bayesian Wilcoxon test is greater than <code>effect_crit</code>; if
<code>design = "independent"</code>, the Bayesian analysis assesses if the posterior
probability for <code>omega_E &gt; .5</code> on a Bayesian Mann-Whitney test
is greater than <code>effect_crit</code>. The frequentist power is estimated by
the proportion of the data sets where a parametric <em>t</em>-test detects a
significant effect because the  upper-tail <em>t</em> value has a <em>p</em>-value
less than <code>1-effect_crit</code>. The Bayesian power is the proportion of the
data sets where a posterior probability for the alternative hypothesis is
greater than <code>effect_crit</code>. The default value for the
<code>effect_crit</code> argument is <code>effect_crit = .95</code>. The frequentist
<em>p</em>-value and the Bayesian posterior probability for the
alternative hypothesis are calculated using the <code>dfba_sim_data()</code>
function.
</p>
<p>The arguments for the <code>dfba_sim_data()</code> function are passed from the
<code>dfba_bayes_vs_t_power()</code> function. Besides the sample size <code>n</code>, there
are eight other arguments that are required by the <code>dfba_sim_data()</code>
function, which are passed from the <code>dfba_bayes_vs_t_power()</code> function:
</p>

<ul>
<li> <p><code>a0</code>
</p>
</li>
<li> <p><code>b0</code>
</p>
</li>
<li> <p><code>model</code>
</p>
</li>
<li> <p><code>design</code>
</p>
</li>
<li> <p><code>delta</code>
</p>
</li>
<li> <p><code>shape1</code>
</p>
</li>
<li> <p><code>shape2</code>
</p>
</li>
<li> <p><code>block_max</code>.
</p>
</li>
</ul>
<p>The <code>a0</code> and <code>b0</code> values are the respective first and second beta
shape parameters for the prior distribution needed for the Bayesian
distribution-free tests, which are ultimately done by calling either the
<code>dfba_wilcoxon()</code> function or by the <code>dfba_mann_whitney()</code> function.
</p>
<p>The <code>model</code> argument is one of the following strings:
</p>

<ul>
<li> <p><code>"normal"</code>
</p>
</li>
<li> <p><code>"weibull"</code>
</p>
</li>
<li> <p><code>"cauchy"</code>
</p>
</li>
<li> <p><code>"lognormal"</code>
</p>
</li>
<li> <p><code>"chisquare"</code>
</p>
</li>
<li> <p><code>"logistic"</code>
</p>
</li>
<li> <p><code>"exponential"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"pareto"</code>
</p>
</li>
</ul>
<p>The <code>design</code> argument is either <code>"independent"</code> or <code>"paired"</code>,
and stipulates whether the two sets of scores are either independent or from
a common block such as for the case of two scores for the same person (<em>i.e.</em>,
one in each condition).
</p>
<p>The <code>shape1</code> and <code>shape2</code> arguments are values for the shape parameter
for the respective first and second condition, and their meaning
depends on the probability model. For <code>model="normal"</code>, these
parameters are the standard deviations of the two distributions. For
<code>model = "weibull"</code>, the parameters are the Weibull shape parameters.
For <code>model = "cauchy"</code>, the parameters are the scale factors for the
Cauchy distributions. For <code>model = "lognormal"</code>, the shape
parameters are the standard deviations for log(X). For <code>model = "chisquare"</code>,
the parameters are the degrees of freedom (<em>df</em>) for the two
distributions. For <code>model = "logistic"</code>, the parameters are the scale
factors for the distributions. For <code>model = "exponential"</code>, the parameters
are the rate parameters for the distributions.
</p>
<p>For the Gumbel distribution, the <code>E</code> variate is equal to
<code>delta - shape2*log(log(1/U))</code> where <code>U</code> is a random value sampled
from the uniform distribution on the interval <code>[.00001, .99999]</code>, and
the <code>C</code> variate is equal to <code>-shape1*log(log(1/U))</code> where <code>U</code>
is another score sampled from the uniform distribution. The <code>shape1</code> and
<code>shape2</code> arguments for <code>model = "gumbel"</code> are the scale parameters
for the distributions. The Pareto model is a distribution designed to account
for income distributions as studied by economists (Pareto, 1897). For the
Pareto distribution, the cumulative function is equal to <code>1-(x_m/x)^alpha</code>
where <code>x</code> is greater than <code>x_m</code> (Arnold, 1983). In the <code>E</code>
condition, <code>x_m = 1 + delta</code> and in the <code>C</code> condition <code>x_m = 1</code>.
The alpha parameter is 1.16 times the shape parameters <code>shape1</code> and
<code>shape2</code>. Since the default value for each shape parameter is 1, the
resulting alpha value of 1.16 is the default value. When alpha = 1.16, the
Pareto distribution approximates an income distribution that represents the
80-20 law where 20% of the population receives 80% of the income
(Hardy, 2010).
</p>
<p>The <code>block_max</code> argument provides for incorporating block effects in the
random sampling. The block effect for each score is a separate effect for the
block. The block effect B for a score is a random number drawn from a uniform
distribution on the interval <code>[0, block_max]</code>. When <code>design = "paired"</code>,
the same random block effect is added to the score in the first condition,
which is the random <code>C</code> value, and it is also added to the corresponding
paired value for the <code>E</code> variate. Thus, the pairing research design
eliminates the effect of block variation for the assessment of condition
differences. When <code>design = "independent"</code>, there are different block-effect
contributions to the <code>E</code> and <code>C</code> variates, which reduces the
discrimination of condition differences because it increases the variability
of the difference in the two variates. The user can study the effect of the
relative discriminability of detecting an effect of delta by adjusting the
value of the <code>block_max</code> argument. The default for <code>block_max</code> is 0,
but it can be altered to any non-negative real number.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>
<p>The number of Monte Carlo data sets; equal to the value of the <code>samples</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Probability model for the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>The design for the data; one of <code>"independent"</code> or <code>"paired"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_crit</code></td>
<td>
<p>The criterion probability for considering a posterior probability for the hypothesis that <code>delta &gt; 0</code> to be a detection; it is also <code>1 - p_crit</code> for a frequentist <em>t</em>-test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltav</code></td>
<td>
<p>The offset between the variates; equal to the <code>delta</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>The first shape parameter for the beta prior distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The second shape parameter for the beta prior distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_max</code></td>
<td>
<p>The maximum size of a block effect; equal to <code>block_max</code> argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputdf</code></td>
<td>
<p>A dataframe of possible sample sizes and the corresponding Bayesian and frequentist power values</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Arnold, B. C. (1983). Pareto Distribution. Fairland, MD:
International Cooperative Publishing House.
</p>
<p>Chechile, R. A. (2017). A Bayesian analysis for the Wilcoxon signed-rank
statistic. Communications in Statistics - Theory and Methods,
https://doi.org/10.1080/03610926.2017.1388402
</p>
<p>Chechile, R. A. (2020). A Bayesian analysis for the Mann-Whitney statistic.
Communications in Statistics - Theory and Methods,
https://doi.org/10.1080/03610926.2018.1549247
</p>
<p>Fishman, G. S. (1996) Monte Carlo: Concepts, Algorithms and Applications.
New York: Springer.
</p>
<p>Hardy, M. (2010). Pareto's Law. Mathematical Intelligencer,
32, 38-43.
</p>
<p>Johnson, N. L., Kotz S., and Balakrishnan, N. (1995). Continuous Univariate
Distributions, Vol. 1, New York: Wiley.
</p>
<p>Pareto, V. (1897). Cours d'Economie Politique. Vol. 2,
Lausanne: F. Rouge.
</p>


<h3>See Also</h3>

<p><code>Distributions</code> for details on the
parameters of the normal, Weibull, Cauchy, lognormal, chi-squared, logistic,
and exponential distributions.
</p>
<p><code>dfba_wilcoxon</code>
</p>
<p><code>dfba_mann_whitney</code>
</p>
<p><code>dfba_sim_data</code>  for further details about the data for two
conditions that differ in terms of their theoretical mean by an amount delta.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Note: these examples have long runtimes due to Monte Carlo sampling;
# please feel free to run them in the console.

# Examples for two data sets sampled from standard normal distributions with
# no blocking effect


dfba_bayes_vs_t_power(n_min = 40,
                      delta = .45,
                      model = "normal",
                      design = "paired",
                      samples = 250,
                      hide_progress = TRUE)

dfba_bayes_vs_t_power(n_min = 50,
                      delta = .45,
                      model = "weibull",
                      design = "independent",
                      samples = 250,
                      hide_progress = TRUE)

dfba_bayes_vs_t_power(n_min = 50,
                      delta = .45,
                      model = "weibull",
                      design = "paired",
                      shape1 = .8,
                      shape2 = .8,
                      samples = 250,
                      block_max = 2.3,
                      hide_progress = TRUE)


</code></pre>


</div>