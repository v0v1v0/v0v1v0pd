<div class="container">

<table style="width: 100%;"><tr>
<td>add_asr_node_states</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a model of ancestral state reconstruction of island presence</h2>

<h3>Description</h3>

<p>Fits a model of ancestral state reconstruction of island presence
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_asr_node_states(
  phylod,
  asr_method,
  tie_preference = "island",
  earliest_col = FALSE,
  rate_model = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asr_method</code></td>
<td>
<p>A character string, either "parsimony" or "mk" determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code>castor::asr_max_parsimony()</code> or <code>castor::asr_mk_model()</code> in <code>castor</code> R
package for details on the methods used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tie_preference</code></td>
<td>
<p>Character string, either "island" or "mainland" to
choose the most probable state at each node using the <code>max.col()</code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code>max.col()</code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
"island".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>earliest_col</code></td>
<td>
<p>A boolean to determine whether to take the colonisation
time as the most probable time (FALSE) or the earliest possible colonisation
time (TRUE), where the probability of a species being on the island is
non-zero. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate_model</code></td>
<td>

<p>Rate model to be used for fitting the transition rate matrix. Can be "ER" (all rates equal), "SYM" (transition rate i–&gt;j is equal to transition rate j–&gt;i), "ARD" (all rates can be different), "SUEDE" (only stepwise transitions i–&gt;i+1 and i–&gt;i-1 allowed, all 'up' transitions are equal, all 'down' transitions are equal) or "SRD" (only stepwise transitions i–&gt;i+1 and i–&gt;i-1 allowed, and each rate can be different). Can also be an index matrix that maps entries of the transition matrix to the corresponding independent rate parameter to be fitted. Diagonal entries should map to 0, since diagonal entries are not treated as independent rate parameters but are calculated from the remaining entries in the transition matrix. All other entries that map to 0 represent a transition rate of zero. The format of this index matrix is similar to the format used by the <code>ace</code> function in the <code>ape</code> package. <code>rate_model</code> is only relevant if <code>transition_matrix==NULL</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>rate_model</code> argument documentation is inherited from
<code>castor::asr_mk_model()</code>, therefore, the last sentence about the
<code>transition_matrix</code> argument does not apply to <code>add_asr_node_states()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>phylo4d</code> class with tip and node data
</p>


</div>