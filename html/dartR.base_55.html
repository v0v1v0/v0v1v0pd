<div class="container">

<table style="width: 100%;"><tr>
<td>gl.pcoa.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bivariate or trivariate plot of the results of an ordination generated
using gl.pcoa()</h2>

<h3>Description</h3>

<p>This script takes output from the ordination generated by gl.pcoa() and plots
the individuals classified by population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.pcoa.plot(
  glPca,
  x,
  scale = FALSE,
  ellipse = FALSE,
  plevel = 0.95,
  pop.labels = "pop",
  interactive = FALSE,
  as.pop = NULL,
  hadjust = 1.5,
  vadjust = 1,
  xaxis = 1,
  yaxis = 2,
  zaxis = NULL,
  pt.size = 2,
  pt.colors = NULL,
  pt.shapes = NULL,
  label.size = 1,
  axis.label.size = 1.5,
  plot.file = NULL,
  plot.dir = NULL,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>glPca</code></td>
<td>
<p>Name of the PCA or PCoA object containing the factor scores and
eigenvalues [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of the genlight object or fd object containing the SNP
genotypes or Tag P/A (SilicoDArT) genotypes [required to gain access to metadata].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If TRUE, scale the x and y axes in proportion to % variation
explained [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>If TRUE, display ellipses to encapsulate points for each
population [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plevel</code></td>
<td>
<p>Value of the percentile for the ellipse to encapsulate points
for each population [default 0.95].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.labels</code></td>
<td>
<p>How labels will be added to the plot
['none'|'pop'|'legend', default = 'pop'].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>If TRUE then the populations are plotted without labels,
mouse-over to identify points [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.pop</code></td>
<td>
<p>Assign another metric to represent populations for the plot
[default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hadjust</code></td>
<td>
<p>Horizontal adjustment of label position in 2D plots
[default 1.5].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vadjust</code></td>
<td>
<p>Vertical adjustment of label position in 2D plots [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>Identify the x axis from those available in the ordination
(xaxis &lt;= nfactors) [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>Identify the y axis from those available in the ordination
(yaxis &lt;= nfactors) [default 2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zaxis</code></td>
<td>
<p>Identify the z axis from those available in the ordination for a
3D plot (zaxis &lt;= nfactors) [default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.size</code></td>
<td>
<p>Specify the size of the displayed points [default 2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.colors</code></td>
<td>
<p>Optionally provide a vector of nPop colors
(run gl.select.colors() for color options) [default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.shapes</code></td>
<td>
<p>Optionally provide a vector of nPop shapes
(run gl.select.shapes() for shape options) [default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.size</code></td>
<td>
<p>Specify the size of the point labels [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.label.size</code></td>
<td>
<p>Specify the size of the displayed axis labels
[default 1.5].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.file</code></td>
<td>
<p>Name for the RDS binary file to save (base name only, 
exclude extension) [default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dir</code></td>
<td>
<p>Directory to save the plot RDS files [default as specified 
by the global working directory or tempdir()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The factor scores are taken from the output of gl.pcoa() and the population
assignments are taken from from the original data file. In the bivariate
plots, the specimens are shown optionally with adjacent labels and enclosing
ellipses. Population labels on the plot are shuffled so as not to overlap
(using package {directlabels}).
This can be a bit clunky, as the labels may be some distance from the points
to which they refer, but it provides the opportunity for moving labels around
using graphics software (e.g. Adobe Illustrator).
3D plotting is activated by specifying a zaxis.
Any pair or trio of axes can be specified from the ordination, provided they
are within the range of the nfactors value provided to gl.pcoa().
In the 2D plots, axes can be scaled to represent the proportion of variation
explained. In any case, the proportion of variation explained by each axis is
provided in the axis label.
Colors and shapes of the points can be altered by passing a vector of shapes
and/or a vector of colors. These vectors can be created with
gl.select.shapes() and gl.select.colors() and passed to this script using the
pt.shapes and pt.colors parameters.
Points displayed in the ordination can be identified if the option
interactive=TRUE is chosen, in which case the resultant plot is ggplotly()
friendly. Identification of points is by moving the mouse over them. Refer
to the plotly package for further information.
The interactive option is automatically enabled for 3D plotting.
</p>
<p>If a plot.file is given, the ggplot arising from this function is saved as an "RDS" 
binary file using saveRDS(); can be reloaded with readRDS(). A file name must be 
specified for the plot to be saved.
If a plot directory (plot.dir) is specified, the ggplot binary is saved to that
directory; otherwise to the tempdir().
</p>


<h3>Value</h3>

<p>returns no value (i.e. NULL)
</p>


<h3>Author(s)</h3>

<p>Custodian: Arthur Georges â€“ Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>
</p>


<h3>See Also</h3>

<p><code>gl.pcoa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> test &lt;- gl.pcoa(platypus.gl)
 gl.pcoa.plot(glPca = test, x = platypus.gl)

# SET UP DATASET
gl &lt;- testset.gl
levels(pop(gl))&lt;-c(rep('Coast',5),rep('Cooper',3),rep('Coast',5),
rep('MDB',8),rep('Coast',7),'Em.subglobosa','Em.victoriae')
# RUN PCA
pca&lt;-gl.pcoa(gl,nfactors=5)
# VARIOUS EXAMPLES
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.95, pop.labels='pop', 
axis.label.size=1, hadjust=1.5,vadjust=1)
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.99, pop.labels='legend', 
axis.label.size=1)
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.99, pop.labels='legend', 
axis.label.size=1.5,scale=TRUE)
gl.pcoa.plot(pca, gl, ellipse=TRUE, axis.label.size=1.2, xaxis=1, yaxis=3, 
scale=TRUE)
gl.pcoa.plot(pca, gl, pop.labels='none',scale=TRUE)
gl.pcoa.plot(pca, gl, axis.label.size=1.2, interactive=TRUE)
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.99, xaxis=1, yaxis=2, zaxis=3)
# COLOR AND SHAPE ADJUSTMENTS
shp &lt;- gl.select.shapes(select=c(16,17,17,0,2))
col &lt;- gl.select.colors(library='brewer',palette='Spectral',ncolors=11,
select=c(1,9,3,11,11))
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.95, pop.labels='pop', 
pt.colors=col, pt.shapes=shp, axis.label.size=1, hadjust=1.5,vadjust=1)
gl.pcoa.plot(pca, gl, ellipse=TRUE, plevel=0.99, pop.labels='legend',
 pt.colors=col, pt.shapes=shp, axis.label.size=1)
# DISTANCE MATRIX
 D &lt;- gl.dist.ind(gl)
 pco &lt;- gl.pcoa(D)
 gl.pcoa.plot(pco,gl,ellipse=TRUE)
 
</code></pre>


</div>