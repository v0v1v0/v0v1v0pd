<div class="container">

<table style="width: 100%;"><tr>
<td>plotSimDiags</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic plots for simulated data
</h2>

<h3>Description</h3>

<p>This provides diagnostic plots, closely equivalent to those provided by
<code>plot.lm</code>, for simulated data.  By default, simulated data
are for the fitted model.  Alternatively, simulated data can be
supplied, making it possible to check the effct of fitting, e.g.,
an AR1 model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSimDiags(obj, simvalues = NULL, seed = NULL,
types = NULL, which = c(1:3, 5), layout = c(4, 1), qqline=TRUE,
cook.levels = c(0.5, 1), caption = list("Residuals vs Fitted",
"Normal Q-Q", "Scale-Location", "Cook's distance", "Residuals vs Leverage",
expression("Cook's dist vs Leverage  " * h[ii]/(1 - h[ii]))),
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>

<p>Fitted model object - <code>lm</code> or an object inheriting from <code>lm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simvalues</code></td>
<td>

<p>Optional matrix of simulated data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Random number seed - set this to make results repeatable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>types</code></td>
<td>

<p>If set, this should be a list with six elements, ordinarily with
each list element either <code>"p"</code> or <code>c("p","smooth")</code> or
(<code>which=2</code>, <code>which=6</code>) NULL or (<code>which=4</code>) "h"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>Set to be a subset of the numbers 1 to 6, as for <code>plot.lm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>

<p>Controls the number of simulations and the layout of the plots.
For example <code>layout=c(3,4)</code> will give 12 plots in a 3 by 4 layout.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqline</code></td>
<td>
<p>logical: add line to normal Q-Q plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cook.levels</code></td>
<td>

<p>Levels of Cook's statistics for which contours are to be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>list: Captions for the six graphs
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed to plotting functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Diagnotic plots from repeated simulations from the fitted model
provide a useful indication of the range of variation in the model
diagnistics that are consistent with the fitted model.
</p>


<h3>Value</h3>

<p>A list of lattice graphics objects is returned, one for each value of
<code>which</code>.  List elements for which a graphics object is not
returned are set to NULL.  Or if <code>which</code> is of length 1,
a lattice graphics object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>residVSfitted</code></td>
<td>
<p>Residuals vs fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalQQ</code></td>
<td>
<p>Normal quantile-quantile plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleVSloc</code></td>
<td>
<p>Scale versus location</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CookDist</code></td>
<td>
<p>Cook's distance vs observation number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residVSlev</code></td>
<td>
<p>Standardized residuals (for GLMs, standardized
Pearson residuals) vs leverage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CookVSlev</code></td>
<td>
<p>Cook's distance vs leverage</p>
</td>
</tr>
</table>
<p>For the default <code>which=c(1:3,5)</code>, list items 1, 2, 3 and 5 above
contain graphics objects, with list elements 4 and 6 set to <code>NULL</code>.
</p>


<h3>Note</h3>

<p>The graphics objects contained in individual list elements can be
extracted for printing, or updating and printing, as required.
If the value is returned to the command line, list elements that
are not <code>NULL</code> will be printed in turn.
</p>


<h3>Author(s)</h3>

<p>John Maindonald, with some code chunks adapted from <code>plot.lm</code>
</p>


<h3>References</h3>

<p>See <code>plot.lm</code>
</p>


<h3>See Also</h3>

<p><code>plot.lm</code>, <code>lmdiags</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">women.lm &lt;- lm(height ~ weight, data=women)
gphlist &lt;- plotSimDiags(obj=women.lm, which=c(1:3,5))
</code></pre>


</div>