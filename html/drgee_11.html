<div class="container">

<table style="width: 100%;"><tr>
<td>getScoreResidualsFromClogit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Get the (conditional) score residuals from conditional logistic regression
</h2>

<h3>Description</h3>

<p>A function to obtain the conditional score residuals from conditional
logistic regression as well as the sum of derivatives of these
residuals with respect to the parameters evaluated at the estimated
parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getScoreResidualsFromClogit(fit, coefs, y, x, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>A fitted object. Could be any object that has a
class.function <code>coefficients</code>, but is intended to be used with
<code>clogit</code> in the <code>survival</code> package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>

<p>An estimate of the parameters. If the argument <code>fit</code> is supplied,
this will be replaced by <code>coefficients(fit)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>The observed outcomes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The design matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>The cluster identification variable.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>getScoreResidualsFromClogit</code> calculates the residuals from the
conditional score equations used in conditional logistic regression as
we as the sums of  their derivatives with respect to the paramaters.
</p>
<p>This is useful if one wants to use a calculate the sandwich estimate
of a variance where the uncertainty in the estimation of a
conditional odds ratio needs to be taken into account.
</p>


<h3>Value</h3>

<p><code>getScoreResidualsFromClogit</code> return a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>U </code></td>
<td>

<p>An <code class="reqn">n</code> x <code class="reqn">p</code> matrix, where <code class="reqn">n</code> is the number of observations
and <code class="reqn">p</code> is the length of the estimated parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dU.sum </code></td>
<td>

<p>An <code class="reqn">p</code> x <code class="reqn">p</code> matrix containing the sums of the
derivatives. The rows correspond to the estimating equations and
the columns correspond to the partial derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dU.mean</code></td>
<td>
<p>The mean cluster sum of the derivatives of the score
residuals from the conditional likelihood. 
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Johan Zetterqvist, Arvid Sj√∂lander
</p>


<h3>See Also</h3>

<p><code>robVcov</code>.
</p>


</div>