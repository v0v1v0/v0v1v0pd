<div class="container">

<table style="width: 100%;"><tr>
<td>Counts-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An S4 class to store measurements (count data, sampling fractions),
prior support and posterior parameters</h2>

<h3>Description</h3>

<p>An S4 class to store measurements (count data, sampling fractions),
prior support and posterior parameters
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'Counts'
get_counts(object)

## S4 method for signature 'Counts'
get_fractions(object)

## S4 replacement method for signature 'Counts'
set_counts(object) &lt;- value

## S4 replacement method for signature 'Counts'
set_fractions(object) &lt;- value

## S4 method for signature 'Counts'
compute_posterior(
  object,
  n_start,
  n_end,
  replacement = FALSE,
  b = 1e-10,
  alg = "dup"
)

## S4 method for signature 'Counts'
get_posterior_param(object, low = 0.025, up = 0.975, ...)

## S4 method for signature 'Counts'
plot_posterior(object, low = 0.025, up = 0.975, xlab, step, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>Counts</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>numeric vector of sampling fractions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_start</code></td>
<td>
<p>start of prior support range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_end</code></td>
<td>
<p>end of prior support range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replacement</code></td>
<td>
<p>was sampling performed with replacement? Default to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>prior rate parameter of the gamma distribution used to compute the posterior with Clough. Default to 1e-10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>algorithm to be used to compute posterior. One of ... . Default to "dup"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>
<p>1 - right tail posterior probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>up</code></td>
<td>
<p>left tail posterior probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label. Default to 'n' (no label)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>integer defining the increment for x-axis labels (distance between two consecutive tick marks)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>counts vector from a <code>Counts</code> object
</p>
<p>fractions vector from a <code>Counts</code> object
</p>
<p>an object of class <code>Counts</code>
</p>
<p>an object of class <code>Counts</code>
</p>
<p>an object of class <code>Counts</code>
</p>
<p>an object of class <code>Counts</code>
</p>
<p>no return value, called for side effects
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>get_counts(Counts)</code>: Returns counts from a <code>Counts</code> object
</p>
</li>
<li> <p><code>get_fractions(Counts)</code>: Returns fractions from a <code>Counts</code> object
</p>
</li>
<li> <p><code>set_counts(Counts) &lt;- value</code>: Replaces counts of a <code>Counts</code> object with the provided values
</p>
</li>
<li> <p><code>set_fractions(Counts) &lt;- value</code>: Replaces fractions of a <code>Counts</code> object with the provided values
</p>
</li>
<li> <p><code>compute_posterior(Counts)</code>: Compute the posterior probability distribution of the population size
</p>
</li>
<li> <p><code>get_posterior_param(Counts)</code>: Extract statistical parameters (e.g. credible intervals) 
from a posterior probability distribution
</p>
</li>
<li> <p><code>plot_posterior(Counts)</code>: Plot posterior probability distribution and posterior parameters
</p>
</li>
</ul>
<h3>Slots</h3>


<dl>
<dt><code>counts</code></dt>
<dd>
<p>integer vector of counts (required)</p>
</dd>
<dt><code>fractions</code></dt>
<dd>
<p>numeric vector of sampling fractions (required)</p>
</dd>
<dt><code>n_start</code></dt>
<dd>
<p>start of prior support range. If omitted and total <code>counts</code> greater than zero,
computed as 0.5 * <code>mle</code>, where <code>mle</code> is the maximum likelihood estimate of the population size</p>
</dd>
<dt><code>n_end</code></dt>
<dd>
<p>end of prior support range. If omitted and total <code>counts</code> greater than zero,
computed as 2 * <code>mle</code>, where <code>mle</code> is the maximum likelihood estimate of the population size</p>
</dd>
<dt><code>f_product</code></dt>
<dd>
<p>product of (1-<code>fractions</code>)</p>
</dd>
<dt><code>mle</code></dt>
<dd>
<p>maximum likelihood estimate of the population size (ratio between total counts and total sampling fraction)</p>
</dd>
<dt><code>norm_constant</code></dt>
<dd>
<p>normalization constant</p>
</dd>
<dt><code>posterior</code></dt>
<dd>
<p>numeric vector of posterior probabilities over the prior support</p>
</dd>
<dt><code>map_p</code></dt>
<dd>
<p>maximum of <code>posterior</code> probability</p>
</dd>
<dt><code>map_index</code></dt>
<dd>
<p>index of prior support corresponding to the maximum a posteriori</p>
</dd>
<dt><code>map</code></dt>
<dd>
<p>maximum a posteriori of population size</p>
</dd>
<dt><code>q_low</code></dt>
<dd>
<p>lower bound of the credible interval</p>
</dd>
<dt><code>q_low_p</code></dt>
<dd>
<p>probability of the lower bound of the credible interval</p>
</dd>
<dt><code>q_low_index</code></dt>
<dd>
<p>index of the prior support corresponding to <code>q_low</code></p>
</dd>
<dt><code>q_low_cum_p</code></dt>
<dd>
<p>cumulative posterior probability from <code>n_start</code> to <code>q_low</code> (left tail)</p>
</dd>
<dt><code>q_up</code></dt>
<dd>
<p>upper bound of the credible interval</p>
</dd>
<dt><code>q_up_p</code></dt>
<dd>
<p>probability of the upper bound of the credible interval</p>
</dd>
<dt><code>q_up_index</code></dt>
<dd>
<p>index of the prior support corresponding to <code>q_high</code></p>
</dd>
<dt><code>q_up_cum_p</code></dt>
<dd>
<p>cumulative posterior probability from <code>q_high</code> to <code>n_end</code> (right tail)</p>
</dd>
<dt><code>gamma</code></dt>
<dd>
<p>logical, TRUE if posterior computed using a Gamma approximation</p>
</dd>
</dl>
<h3>Note</h3>

<p>The <code>posterior</code> slot contains either the PMF or a logical value used to 
compute posterior parameters with a Gamma approximation (see reference for details)
</p>
<p>Lower and upper bounds of the credibile interval are computed at a default
confidence level of 95
</p>
<p>For more details on the normalization constant, see Corollary 1 in reference
</p>


<h3>Author(s)</h3>

<p>Federico Comoglio
</p>


<h3>References</h3>

<p>Comoglio F, Fracchia L and Rinaldi M (2013) 
Bayesian inference from count data using discrete uniform priors. 
<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0074388">PLoS ONE 8(10): e74388</a>
</p>


<h3>See Also</h3>

<p>compute_posterior, get_posterior_param
</p>


<h3>Examples</h3>

<pre><code class="language-R"># constructor:
# create an object of class 'Counts'
new_counts(counts = c(30, 35), fractions = c(0.075, 0.1))

# same, using new
new("Counts", counts = c(30, 35), fractions = c(0.075, 0.1))

</code></pre>


</div>