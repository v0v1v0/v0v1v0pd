<div class="container">

<table style="width: 100%;"><tr>
<td>Drug2SPheatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a heat map of the subpathways activity regulated by drugs</h2>

<h3>Description</h3>

<p>The function "Drug2SPheatmap" plots heatmaps of the subpathways that are regulated by drugs. We map subpathways to the disease gene expression through ssgsea to get a subpathway abundance matrix. Then we visualize the matrix by heatmap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Drug2SPheatmap(drugname="",DrugSPPvalue,ExpData,Label,pcut=0.05,
         bk=c(-2,2),cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
         show.colnames=FALSE,col=c("navy","firebrick3"),
         cell.width=NA,cell.height=NA,scale="row",fontsize=7,
         fontsize.row=9,fontsize.col=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>drugname</code></td>
<td>
<p>A character which represent interest drug name with specific concentration, cell line and duration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DrugSPPvalue</code></td>
<td>
<p>A matrix which colunms represent drugs and rows respresent subpathways. Values in this matrix is the pvalue of subpathways centrality score regulated by drugs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ExpData</code></td>
<td>
<p>A gene expression profile of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Label</code></td>
<td>
<p>A character vector consist of "0" and "1" which represent sample class in gene expression profile. "0" means normal sample and "1" means disease sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcut</code></td>
<td>
<p>A numeric value which represent threshold. Subpathways with p-value less than this threshold will be screened out and visualized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bk</code></td>
<td>
<p>A numeric vector that covers the range of values. Users could adjust color depth through this parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.rows</code></td>
<td>
<p>Boolean values determining if rows should be clustered or hclust object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.cols</code></td>
<td>
<p>Boolean values determining if columns should be clustered or hclust object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.rownames</code></td>
<td>
<p>Boolean specifying if row names are be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.colnames</code></td>
<td>
<p>Boolean specifying if column names are be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of colors used in heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.width</code></td>
<td>
<p>Individual cell width in points. If left as NA, then the values depend on the size of plotting window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.height</code></td>
<td>
<p>Individual cell height in points. If left as NA, then the values depend on the size of plotting window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Character indicating if the values should be centered and scaled in either the row direction or the column direction, or none. Corresponding values are "row", "column" and "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize</code></td>
<td>
<p>Base fontsize for the plot (default: 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize.row</code></td>
<td>
<p>Fontsize for rownames (default: 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize.col</code></td>
<td>
<p>Fontsize for colnames (default: 10).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A heat map
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load depend package
library(GSVA)
library(pheatmap)
##Obtain input data
#Statistic significance of centrality score of subpathways
#induced by each drug were stored in package "DRviaSPCNData".
#"DRviaSPCNData" has been uploaded to the github repository.
#Users can download and install through "install_github" function and
#set parameter url="hanjunwei-lab/DRviaSPCNData".
#After installing and loading package "DRviaSPCNData",
#users can use the following command to get the data:
#DrugSPPvalueMatrix&lt;-GetData('DrugSPPvalueMatrix')
GEP&lt;-GetExample('GEP')
Slabel&lt;-GetExample('Slabel')

#Run the function
#Drug2SPheatmap(drugname = "methotrexate_HL60_6_8.8e-06",
#                 DrugSPPvalue=DrugSPPvalueMatrix,
#                 ExpData=GEP,Label=Slabel,pcut=0.05,bk=c(-2,2),
#                 cluster.rows=FALSE,cluster.cols=FALSE,show.rownames=TRUE,
#                 show.colnames=FALSE,col=c("navy","firebrick3"),
#                 cell.width=NA,cell.height=NA,scale="row",fontsize=7,
#                 fontsize.row=9,fontsize.col=10)
</code></pre>


</div>