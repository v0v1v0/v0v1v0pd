<div class="container">

<table style="width: 100%;"><tr>
<td>StuartMaxwellTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stuart-Maxwell Marginal Homogeneity Test

</h2>

<h3>Description</h3>

<p>This function computes the marginal homogeneity test for a <code class="reqn">k \times  k</code> matrix of assignments of objects to <code>k</code> categories or two vectors <code>x</code>, <code>y</code> of category scores for <code>n</code> data objects by two raters. The statistic is distributed as <code class="reqn">\chi^2</code> with <code>k-1</code> degrees of freedom. <br>
It can be viewed as an extension of the McNemar test to <code class="reqn">k \times k</code> table. 

</p>


<h3>Usage</h3>

<pre><code class="language-R">StuartMaxwellTest(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a 2-way <code class="reqn">k \times  k</code> contingency table in matrix form, or a factor.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a factor with the same levels as x; ignored if x is a matrix.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null is that the probabilities of being classified into cells [i, j] and [j, i] are the same.
</p>
<p>If <code>x</code> is a matrix, it is taken as a two-dimensional contingency table, and hence its entries should be nonnegative integers. Otherwise, both x and y must be vectors or factors of the same length and with the same levels. <br>
Incomplete cases are removed, vectors are coerced into factors, and the contingency table is computed from these.
</p>
<p>If there is perfect agreement for any category k, that category must be omitted in order to invert matrix S. 
</p>
<p>If for any category <code>k</code>, all frequencies in row <code>k</code> and column <code>k</code> are 0, except possibly for the main diagonal element (e.g., for perfect agreement for category <code>k</code>, in such cases also the corresponding row and column marginal frequencies would be equal), then the category is not included in the test and should be ignored, say the Stuart-Maxwell test is performed with respect to the remaining categories only. The degree of freedom <code>df</code> in this case can still be considered <code>k - 1</code>, where <code>k</code> is the number of original categories; this treats omitted categories as if they were included but contributed 0 to the value of <code class="reqn">\chi^2</code> - a reasonable view since such categories have equal row and column marginals. (See: <a href="https://www.john-uebersax.com/stat/mcnemar.htm#stuart">https://www.john-uebersax.com/stat/mcnemar.htm#stuart</a>)
</p>



<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andri Signorell &lt;andri@signorell.net&gt;, based on Code from Jim Lemon

</p>


<h3>References</h3>

<p>Stuart, A (1955) A test for homogeneity of the marginal distributions in a two-way classification. <em>Biometrika</em>, 42, 412-416.
</p>
<p>Maxwell, A.E. (1970) Comparing the classification of subjects by two independent judges. <em>British Journal of Psychiatry</em>, 116, 651-655.
</p>
<p>Agresti, A. (2002) <em>Categorical Data Analysis</em>. John Wiley &amp; Sons, pp 86 ff.
</p>



<h3>See Also</h3>

<p><code>BhapkarTest</code> for a more powerful alternative to the Stuart-Maxwell test
</p>
<p><code>mcnemar.test</code>, <code>chisq.test</code>, <code>MHChisqTest</code>,
<code>BreslowDayTest</code>
</p>



<h3>Examples</h3>

<pre><code class="language-R"># Source: https://www.john-uebersax.com/stat/mcnemar.htm#stuart
hyp &lt;- as.table(matrix(c(20,3,0,10,30,5,5,15,40), nrow=3))
StuartMaxwellTest(hyp)

# same as defined with two vectors
d.hyp &lt;- Untable(hyp)
StuartMaxwellTest(x=d.hyp[,1], y=d.hyp[,2])


mc &lt;- as.table(matrix(c(
         732, 1524, 1575, 1577, 1602, 837, 1554, 1437, 
         1672, 1600, 841, 1363, 1385, 1484, 1524, 791), nrow=4))

StuartMaxwellTest(mc)
</code></pre>


</div>