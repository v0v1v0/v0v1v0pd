<div class="container">

<table style="width: 100%;"><tr>
<td>Zncsspline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the design matrix for fitting the random component of a natural 
cubic smoothing spline</h2>

<h3>Description</h3>

<p>Calculates the design matrix, <b>Z</b>, of the random effects for a 
natural cubic smoothing spline as described by Verbyla et al., (1999). 
An initial design matrix, 
<code class="reqn">\bold{\Delta} \bold{\Delta}^{-1} \bold{\Delta}</code>, 
based on the knot points is computed. It can 
then be post multiplied by the power of the tri-diagonal matrix 
<code class="reqn">\bold{G}_s</code> that is proportional to the variance matrix of the 
random spline effects. If the power is set to 0.5 then the random 
spline effects based on the resulting Z matrix will be independent 
with variance <code class="reqn">\sigma_s^2</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">Zncsspline(knot.points, Gpower = 0, print = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>knot.points</code></td>
<td>
<p>A <code>numeric</code> giving the values of the knot points 
to be used in fitting the spline. These must be orderd in increasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gpower</code></td>
<td>
<p>A <code>numeric</code> giving the power of the tri-diagonal matrix 
<code class="reqn">\bold{G}_s</code> from which the variance matrix of the random spline 
effects is caluclated. that the initial design matrix is to be 
the value of the variance component for the random spline effects. 
The smoothing parameter is then the inverse of the ratio of this 
component to the residual variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>A <code>logical</code> indicating whether to print the 
<code class="reqn">\bold{\Delta}</code> and <code class="reqn">\bold{G}_s</code> matrices.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>matrix</code> containing the design matrix.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Verbyla, A. P., Cullis, B. R., Kenward, M. G., and Welham, S. J. (1999). 
The analysis of designed experiments and longitudinal data by using 
smoothing splines (with discussion). <em>Journal of the Royal 
Statistical Society, Series C (Applied Statistics)</em>, <b>48</b>, 269-311.</p>


<h3>See Also</h3>

<p><code>mat.ncssvar</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">Z &lt;- Zncsspline(knot.points = 1:10, Gpower = 0.5)
</code></pre>


</div>