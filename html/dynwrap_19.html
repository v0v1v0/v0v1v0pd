<div class="container">

<table style="width: 100%;"><tr>
<td>add_root</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Root the trajectory</h2>

<h3>Description</h3>

<p>Designates a milestone as root, and changes the direction of any edges so that they move away from the specified root (if <code>flip_edges=TRUE</code>, default).
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_root(
  trajectory,
  root_cell_id = trajectory$root_cell_id,
  root_milestone_id = trajectory$root_milestone_id,
  flip_edges = TRUE
)

add_root_using_expression(
  trajectory,
  features_oi,
  expression_source = "expression"
)

is_rooted(trajectory)

remove_root(trajectory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trajectory</code></td>
<td>
<p>The trajectory as created by <code>infer_trajectory()</code> or <code>add_trajectory()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root_cell_id</code></td>
<td>
<p>The root cell id, not required if root_milestone_id is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root_milestone_id</code></td>
<td>
<p>The root milestone id, not required if root_cell_id is given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip_edges</code></td>
<td>
<p>Whether to flip edges which are going in the other direction compared to the root</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features_oi</code></td>
<td>
<p>The feature ids which will be used to root</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression_source</code></td>
<td>
<p>Source of the expression, either a string or a matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code>root_cell_id</code> can also be specified, and the root milestone will be determined as the milestone with the closest geodesic distance to this cell.
</p>


<h3>Value</h3>

<p>A trajectory, with a <em>root_milestone_id</em> and with adapted <em>milestone_network</em> and <em>progressions</em> based on the rooting.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># add a root using a root cell
trajectory &lt;- example_trajectory
trajectory &lt;- add_root(
  trajectory,
  root_cell_id = sample(trajectory$cell_ids, 1)
)
trajectory$root_milestone_id

# add a root using a root milestone id
trajectory &lt;- add_root(
  trajectory,
  root_milestone_id = "milestone_end"
)
trajectory$root_milestone_id
trajectory$milestone_network

</code></pre>


</div>