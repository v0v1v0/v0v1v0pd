<div class="container">

<table style="width: 100%;"><tr>
<td>degross</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density estimation from tabulated data with given frequencies and group central moments.</h2>

<h3>Description</h3>

<p>Estimation of a density from tabulated summary statistics evaluated within each of the big bins (or classes) partitioning the variable support. These statistics include class frequencies and central moments of orders one up to four. The log-density is modelled using a linear combination of penalized B-splines. The multinomial log-likelihood involving the frequencies adds up to a roughness penalty based on differences of neighboring B-spline coefficients and to the log of a root-n approximation of the sampling density of the observed vector of central moments within each class. The so-obtained penalized log-likelihood is maximized using the EM algorithm to get an estimation of the spline parameters and, hence, of the variable density and related quantities such as quantiles, see Lambert (2021) for details.

</p>


<h3>Usage</h3>

<pre><code class="language-R">degross(degross.data,
       phi0 = NULL, tau0 = 1000,
       use.moments = rep(TRUE,4), freq.min = 20, diag.only=FALSE,
       penalize = TRUE,
       aa = 2, bb = 1e-06, pen.order = 3, fixed.tau = FALSE,
       plotting = FALSE, verbose = FALSE, iterlim=20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>degross.data</code></td>
<td>
<p>A degrossData.object generated by degrossData.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi0</code></td>
<td>
<p>Starting value for the <code>K</code>-vector <code class="reqn">\phi</code> of B-spline parameters specifying the log-density. Default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau0</code></td>
<td>
<p>Starting value for the roughness penalty parameter. Default: 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.moments</code></td>
<td>
<p>Vector with 4 logicals indicating which tabulated sample moments to use as soft constraints. Defaults: <code>rep(TRUE,4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.min</code></td>
<td>
<p>Minimal big bin frequency required to use the corresponding observed moments as soft constraints. Default: <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag.only</code></td>
<td>
<p>Logical indicating whether to ignore the off-diagonal elements of the variance-covariance matrix of the sample central moments. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalize</code></td>
<td>
<p>Logical indicating whether a roughness penalty of order <code>pen.order</code> is required (with <code class="reqn">\tau \sim G(aa,bb)</code>). Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aa</code></td>
<td>
<p>Positive real giving the first parameter in the Gamma prior for <code>tau</code>. Default: <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bb</code></td>
<td>
<p>Positive real giving the second parameter in the Gamma prior for <code>tau</code>. Default: <code>1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.order</code></td>
<td>
<p>Integer giving the order of the roughness penalty. Default: <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.tau</code></td>
<td>
<p>Logical indicating whether the roughness penalty parameter <code>tau</code> is fixed. Default: FALSE, implying its estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotting</code></td>
<td>
<p>Logical indicating whether an histogram of the data with the estimated density should be plotted. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether details on the estimation progress should be displayed. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Maximum number of iterations during the M-step. Default: 20.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>degross</code> containing several components from the density estimation procedure. Details can be found in <code>degross.object</code>. A summary of its content can be printed using <code>print.degross</code> or plotted using <code>plot.degross</code>.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. (2021) Moment-based density and risk estimation from grouped summary statistics. arXiv:2107.03883.
</p>


<h3>See Also</h3>

<p><code>degross.object</code>, <code>ddegross</code>, <code>pdegross</code>, <code>qdegross</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate grouped data
sim = simDegrossData(n=3500, plotting=TRUE,choice=2,J=3)
print(sim$true.density) ## Display density of the data generating mechanism

## Create a degrossData object
obj.data = with(sim, degrossData(Big.bins=Big.bins, freq.j=freq.j, m.j=m.j))
print(obj.data)

## Estimate the density underlying the grouped data
obj.fit = degross(obj.data)

## Plot the estimated density...
plot(obj.fit)
## ... and compare it with the ('target') density used to simulate the data
curve(sim$true.density(x),add=TRUE,col="red",lwd=2)
legend("topleft",
       legend=c("Observed freq.","Target density","Estimated density"),
       col=c("grey85","red","black"), lwd=c(10,2,2),
       lty=c("solid","solid","dashed"), box.lty=0, inset=.02)

</code></pre>


</div>