<div class="container">

<table style="width: 100%;"><tr>
<td>gl.collapse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Collapses a distance matrix by amalgamating populations with pairwise
fixed difference count less that a threshold</h2>

<h3>Description</h3>

<p>This script takes a file generated by gl.fixed.diff and amalgamates
populations with distance less than or equal to a specified threshold. The
distance matrix is generated by gl.fixed.diff().
</p>
<p>The script then applies the new population assignments to the genlight object
and recalculates the distance and associated matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.collapse(fd, tpop = 0, tloc = 0, pb = FALSE, verbose = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fd</code></td>
<td>
<p>Name of the list of matrices produced by gl.fixed.diff() 
[required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpop</code></td>
<td>
<p>Threshold number of fixed differences above which populations
will not be amalgamated [default 0].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tloc</code></td>
<td>
<p>Threshold defining a fixed difference (e.g. 0.05 implies 95:5 vs
5:95 is fixed) [default 0].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>If TRUE, show a progress bar on time consuming loops 
[default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log; 3, progress and results summary; 5, full report
[default 2 or as specified using gl.set.verbosity]</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the gl object x and the following square matrices:
</p>

<ol>
<li>
<p> $gl – the new genlight object with populations collapsed;
</p>
</li>
<li>
<p> $fd – raw fixed differences;
</p>
</li>
<li>
<p> $pcfd – percent fixed differences;
</p>
</li>
<li>
<p> $nobs – mean no. of individuals used in each comparison;
</p>
</li>
<li>
<p> $nloc – total number of loci used in each comparison;
</p>
</li>
<li>
<p> $expfpos – NA's, populated by gl.fixed.diff [by simulation]
</p>
</li>
<li>
<p> $expfpos – NA's, populated by gl.fixed.diff [by simulation]
</p>
</li>
<li>
<p> $prob – NA's, populated by gl.fixed.diff [by simulation]
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Custodian: Arthur Georges – Post to 
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
fd &lt;- gl.fixed.diff(testset.gl,tloc=0.05)
fd
fd2 &lt;- gl.collapse(fd,tpop=1)
fd2
fd3 &lt;- gl.collapse(fd2,tpop=1)
fd3

 fd &lt;- gl.fixed.diff(testset.gl,tloc=0.05)
 fd2 &lt;- gl.collapse(fd)
</code></pre>


</div>