<div class="container">

<table style="width: 100%;"><tr>
<td>Mhat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of the M function
</h2>

<h3>Description</h3>

<p>Estimates the <em>M</em> function
</p>


<h3>Usage</h3>

<pre><code class="language-R">Mhat(X, r = NULL, ReferenceType, NeighborType = ReferenceType,
    CaseControl = FALSE, Individual = FALSE, CheckArguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>A weighted, marked planar point pattern (<code>wmppp.object</code>) or a <code>Dtable</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A vector of distances. If <code>NULL</code>, a default value is set: 64 unequally spaced values are used up to half the maximum distance between points <code class="reqn">d_m</code>. The first value is 0, first steps are small (<code class="reqn">d_m/800</code>) then increase progressively up to <code class="reqn">d_m/40</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ReferenceType</code></td>
<td>

<p>One of the point types.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NeighborType</code></td>
<td>

<p>One of the point types. By default, the same as reference type.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CaseControl</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the case-control version of <em>M</em> is computed. <em>ReferenceType</em> points are cases, <em>NeighborType</em> points are controls.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Individual</code></td>
<td>

<p>Logical; if <code>TRUE</code>, values of the function around each individual point are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CheckArguments</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the function arguments are verified. Should be set to <code>FALSE</code> to save time in simulations for example, when the arguments have been checked elsewhere.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>M</em> is a weighted, cumulative, relative measure of a point pattern structure. Its value at any distance is the ratio of neighbors of the <em>NeighborType</em> to all points around <em>ReferenceType</em> points, normalized by its value over the windows.
</p>
<p>If <em>CaseControl</em> is <code>TRUE</code>, then <em>ReferenceType</em> points are cases and <em>NeighborType</em> points are controls. The univariate concentration of cases is calculated as if <em>NeighborType</em> was equal to <em>ReferenceType</em>, but only controls are considered when counting all points around cases (Marcon et al., 2012). This makes sense when the sampling design is such that all points of <em>ReferenceType</em> (the cases) but only a sample of the other points (the controls) are recorded. Then, the whole distribution of points is better represented by the controls alone.
</p>


<h3>Value</h3>

<p>An object of class <code>fv</code>, see <code>fv.object</code>, which can be plotted directly using <code>plot.fv</code>.
</p>
<p>If <code>Individual</code> is set to <code>TRUE</code>, the object also contains the value of the function around each individual <em>ReferenceType</em> point taken as the only reference point. The column names of the <code>fv</code> are "M_" followed by the point names, i.e. the row names of the marks of the point pattern.
</p>


<h3>References</h3>

<p>Marcon, E. and Puech, F. (2010). Measures of the Geographic Concentration of Industries: Improving Distance-Based Methods. <em>Journal of Economic Geography</em> 10(5): 745-762.
</p>
<p>Marcon, E., F. Puech and S. Traissac (2012). Characterizing the relative spatial structure of point patterns. <em>International Journal of Ecology</em> 2012(Article ID 619281): 11.
</p>
<p>Marcon, E., and Puech, F. (2017). A Typology of Distance-Based Measures of Spatial Concentration. <em>Regional Science and Urban Economics</em> 62:56-67
</p>


<h3>See Also</h3>

<p><code>MEnvelope</code>, <code>Kdhat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(paracou16)
autoplot(paracou16)

# Calculate M
autoplot(Mhat(paracou16, , "V. Americana", "Q. Rosea"))
</code></pre>


</div>