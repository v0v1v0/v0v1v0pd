<div class="container">

<table style="width: 100%;"><tr>
<td>CorPolychor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Polychoric Correlation</h2>

<h3>Description</h3>

<p>Computes the polychoric correlation (and its standard error)
between two ordinal variables or from their contingency table, under the 
assumption that the ordinal variables dissect continuous latent variables that are bivariate normal. Either
the maximum-likelihood estimator or a (possibly much) quicker “two-step” approximation is available. For the ML
estimator, the estimates of the thresholds and the covariance matrix of the estimates are also available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CorPolychor(x, y, ML = FALSE, control = list(), std.err = FALSE, maxcor=.9999)

## S3 method for class 'CorPolychor'
print(x, digits = max(3, getOption("digits") - 3), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a contingency table of counts or an ordered categorical variable; the latter can be numeric, logical, a factor,
or an ordered factor, but if a factor, its levels should be in proper order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if <code>x</code> is a variable, a second ordered categorical variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ML</code></td>
<td>
<p>if <code>TRUE</code>, compute the maximum-likelihood estimate; if <code>FALSE</code>, the default, compute a quicker
“two-step” approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>optional arguments to be passed to the <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>if <code>TRUE</code>, return the estimated variance of the correlation (for the two-step estimator) 
or the estimated covariance matrix (for the ML estimator) of the correlation and thresholds; the default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcor</code></td>
<td>
<p>maximum absolute correlation (to insure numerical stability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>integer, determining the number of digits used to format the printed result
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>std.err</code> is <code>TRUE</code>, 
returns an object of class <code>"polycor"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>set to <code>"polychoric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the CorPolychoric correlation.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the estimated variance of the correlation, or, for the ML estimate, 
the estimated covariance matrix of the correlation and thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations on which the correlation is based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>chi-square test for bivariate normality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for the test of bivariate normality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ML</code></td>
<td>
<p><code>TRUE</code> for the ML estimate, <code>FALSE</code> for the two-step estimate.</p>
</td>
</tr>
</table>
<p>Othewise, returns the polychoric correlation.
</p>


<h3>Note</h3>

<p>This is a verbatim copy from polchor function in the package polycor.</p>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>


<h3>References</h3>

<p>Drasgow, F. (1986) 
CorPolychoric and polyserial correlations. 
Pp. 68–74 in S. Kotz and N. Johnson, eds.,
<em>The Encyclopedia of Statistics, Volume 7.</em> Wiley.
</p>
<p>Olsson, U. (1979)
Maximum likelihood estimation of the CorPolychoric correlation coefficient.
<em>Psychometrika</em> <b>44</b>, 443-460.
</p>


<h3>See Also</h3>

<p><code>hetcor</code>, <code>polyserial</code>, <code>print.CorPolychor</code>, <code>optim</code></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12345)
z &lt;- RndPairs(1000, 0.6)
x &lt;- z[,1]
y &lt;- z[,2]

cor(x, y)                                  # sample correlation
x &lt;- cut(x, c(-Inf, .75, Inf))
y &lt;- cut(y, c(-Inf, -1, .5, 1.5, Inf))

CorPolychor(x, y)                          # 2-step estimate
CorPolychor(x, y, ML=TRUE, std.err=TRUE)   # ML estimate
</code></pre>


</div>