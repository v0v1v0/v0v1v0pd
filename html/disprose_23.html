<div class="container">

<table style="width: 100%;"><tr>
<td>get_seq_for_DB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get nucleotide sequences from NCBI</h2>

<h3>Description</h3>

<p>Retrieves nucleotide sequences from NCBI for given identification numbers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_seq_for_DB(
  ids,
  db,
  check.result = FALSE,
  return = "data.frame",
  fasta.file = NULL,
  exclude.from.download = FALSE,
  exclude.var,
  exclude.pattern,
  exclude.fixed = TRUE,
  verbose = TRUE
)

get_seq_for_DB_fix(res.data, db, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>vector of NCBI sequences' identification numbers: GenBank accession numbers, GenInfo identifiers (GI) or Entrez unique identifiers (UID)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>character; NCBI database for search. See entrez_dbs() for possible values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.result</code></td>
<td>
<p>logical; check if download was done correctly</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>character; sequence returned object; possible values are "vector", "data.frame" and "fasta"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fasta.file</code></td>
<td>
<p>character; FASTA file name and path, only used if <code>return = "fasta"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.from.download</code></td>
<td>
<p>logical; ignore some sequences while downloading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.var</code></td>
<td>
<p>vector that is used to define which sequences should be ignored, only used if <code>exclude.from.download = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.pattern</code></td>
<td>
<p>value that matches to <code>exclude.var</code> and marks unwanted sequences, only used if <code>exclude.from.download = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.fixed</code></td>
<td>
<p>logical; match <code>exclude.pattern</code> as is, only used if <code>exclude.from.download = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; show messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.data</code></td>
<td>
<p>data.frame; data frame of nucleotide ids and previously downloaded sequences</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Master records (for example, in WGS-project) do not contain any nucleotide.
They might be excluded from download with <code>exclude.from.download</code> parameters.
However this has no affect and such ids do not have to be excluded when loading.
</p>
<p>If writing FASTA to existing FASTA file, sequences are appended.
</p>


<h3>Value</h3>

<p>If <code>return = "vector"</code> function returns vector of nucleotide sequences,
<code>return = "data.frame"</code> - data frame with nucleotide ids and nucleotide sequences,
<code>return = "fasta"</code> - writes FASTA file, no data returned.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>get_seq_for_DB</code>: Retrieves NCBI nucleotide sequences for given identification numbers.
</p>
</li>
<li> <p><code>get_seq_for_DB_fix</code>: Checks the downloads and tries to retrieve the compromised data.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Elena N. Filatova
</p>


<h3>Examples</h3>

<pre><code class="language-R">ids&lt;-c(2134240466, 2134240465, 2134240464)
fasta.file&lt;-tempfile()
get_seq_for_DB (ids = ids, db = "nucleotide", check.result = TRUE,
                return = "fasta", fasta.file = fasta.file, exclude.from.download=FALSE)
file.remove(fasta.file)

</code></pre>


</div>