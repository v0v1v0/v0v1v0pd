<div class="container">

<table style="width: 100%;"><tr>
<td>diagis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Auxiliary functions and diagnostic plots for importance sampling</h2>

<h3>Description</h3>

<p>This package contains functions computing weighted (running) summaries and diagonostic plots 
for importance sampling problems.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simple importance sampling example
# true distribution is a standard normal:
p &lt;- function(x) dnorm(x)
# proposal distribution is normal with sd s
q &lt;- function(x, s) dnorm(x, 0, s)

# IS weights have finite variance only if s^2 &gt; 1/2
# variance is s/(2-1/s^2)^(3/2)

#optimal case
set.seed(42)
s_opt &lt;- sqrt(2)
x_opt &lt;- rnorm(1000, sd = s_opt)
w_opt &lt;- p(x_opt) / q(x_opt, s_opt) 
weighted_mean(x_opt, w_opt)
weighted_var(x_opt, w_opt)
s_inf &lt;- 0.25
x_inf &lt;- rnorm(1000, sd = s_inf)
w_inf &lt;- p(x_inf) / q(x_inf, s_inf)
weighted_mean(x_inf, w_inf) #!!
weighted_var(x_inf, w_inf) #!!
# diagnostic plots
weight_plot(w_inf)
weight_plot(w_opt)
</code></pre>


</div>