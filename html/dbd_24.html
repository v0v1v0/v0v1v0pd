<div class="container">

<table style="width: 100%;"><tr>
<td>llPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot the log likelihood surface for the data.
</h2>

<h3>Description</h3>

<p>Plot, as a perspective plot or a contour plot, the log likelihood
surface for the data set from which parameters are being estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">llPlot(x, distr=c("db","betabinom"),ntop, zeta, size, alim = NULL, blim = NULL,
       ngrid = c(100, 100), plotType = c("persp", "contour", "none"),
       theta = -30, phi = 40, ...)  </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A vector of numeric data purportedly arising from a db or beta binomial
distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>

<p>Character string specifying which of the two relevant distributions
(db, or beta binomial) is to be considered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntop</code></td>
<td>

<p>See <code>mleDb()</code> and <code>ddb()</code>.
Ignored if <code>distr</code> is <code>"betabinom"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>

<p>See <code>mleDb()</code> and <code>ddb()</code>.
Ignored if <code>distr</code> is <code>"betabinom"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>Integer scalar specifying the upper limit of the “support”
of the beta binomial distribution under consideration.  The support
is the set of integers <code>{0, 1, ..., size}</code>. (The values
of <code>x</code> may sometimes be considered to be the number of
“successes” in <code>size</code> trials.  The <code>size</code>
argument is ignored if <code>distr</code> is <code>"db"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alim</code></td>
<td>

<p>Numeric vector of length 2; the range of <code>alpha</code> values
over which the surface is to be plotted.  Defaults to <code>c(0,10)</code>
if <code>distr</code> is <code>"db"</code> and to <code>c(0,1)</code> if <code>distr</code>
is <code>"betabinom"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blim</code></td>
<td>

<p>Numeric vector of length 2; the range of <code>beta</code> values over
which the surface is to be plotted.   Defaults to <code>c(0,10)</code> if
<code>distr</code> is <code>"db"</code> and to <code>c(0,100)</code> if <code>distr</code>
is <code>"betabinom"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>

<p>The dimensions of the grid of paramter values at
which the log likelihood is to be evaluated in order to plot
the surface.  Note that <code>ngrid</code> may be supplied as an
integer scalar, in which case it is replicated to a vector
of length 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>

<p>Character string specifying the nature of the plot to be
produced.  If it is <code>"none"</code> then no plot is produced.
The value returned may be plotted at a later occasion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>An argument to be passed to <code>persp()</code>.
Ignored unless <code>plotType</code> is <code>"persp"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>An argument to be passed to <code>persp()</code>.
Ignored unless <code>plotType</code> is <code>"persp"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments that may be passed to <code>persp()</code>
or to <code>contour()</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function could conceivably be useful in diagnosing
problems with parameter estimation should these arise.
</p>


<h3>Value</h3>

<p>A list with entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The vector of values of the first parameter (<code>alpha</code>
for <code>distr="db"</code>, <code>m</code> for <code>distr="betabinom"</code>) over
which the surface is to be plotted.  There are <code>ngrid[1]</code>
such values, ranging from <code>alim[1]</code> to <code>alim[2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The vector of values of the second parameter (<code>beta</code>
for <code>distr="db"</code>, <code>s</code> for <code>distr="betabinom"</code>) over
which the surface is to be plotted.  There are <code>ngrid[2]</code>
such values, ranging from <code>blim[1]</code> to <code>blim[2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>An <code>ngrid[1] x ngrid[2]</code> numeric matrix,
specifying the surface.  the value of <code>z[i,j]</code> is
<code>ll(x[i],y[j])</code> where <code>ll()</code> is the log likelihood
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dxy</code></td>
<td>
<p>A data frame with columns named <code>"alpha"</code> and
<code>"beta"</code> for <code>distr="db"</code> or <code>"m"</code> and <code>"s"</code>
for <code>distr="betabinom"</code>, and <code>ngrid[1]*ngrid[2]</code> rows.  It
is formed by applying <code>expand.grid()</code> to the <code>x</code>
and <code>y</code> entries of this list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fxy</code></td>
<td>
<p>A numeric vector of length <code>ngrid[1]*ngrid[2]</code>.
Its <code>i</code>th value is the log likelihood evaluated at
the <code>i</code>th row of <code>dxy</code>.  Its entries are the
same as the entries of <code>z</code>.</p>
</td>
</tr>
</table>
<p>There is obviously considerable redundancy in the returned
value.
</p>
<p>The names <code>x</code> and <code>y</code> that are used for the first two
entries of this list conform to the names of the
arguments of <code>persp()</code> and <code>contour</code>.
</p>
<p>If <code>plotType</code> is <code>"persp"</code> or <code>"contour"</code> the
value is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Rolf Turner
<a href="mailto:r.turner@auckland.ac.nz">r.turner@auckland.ac.nz</a>
</p>


<h3>See Also</h3>

<p><code>link{mleDb}()</code>
<code>link{mleBb}()</code>
<code>link{persp}()</code>
<code>link{contour}()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">X &lt;- hmm.discnp::SydColDisc
X$y &lt;- as.numeric(X$y)
X &lt;- split(X,f=with(X,interaction(locn,depth)))
x &lt;- X[[19]]$y
srf &lt;- llPlot(x,ntop=5,zeta=FALSE,alim=c(0.5,0.7),blim=c(0.2,0.4),plotType="c")
## Not run: 
if(require(rgl)) {
   with(srf,plot3d(ab$alpha,ab$beta,fab)
# Allows dynamic rotation of the surface.
}

## End(Not run)
# Negative (!) parameters for the db distribution.
set.seed(42)
xs &lt;- rdb(100,-1,-1,5)
fit &lt;- mleDb(xs,5)
llPlot(xs,ntop=5,zeta=FALSE,alim=c(-4,2),blim=c(-4,2),plotType="c",
       main="log likelihood contours")
points(fit[1],fit[2],pch=20,col="red")
points(-1,-1,pch=20,col="blue")
legend("topright",pch=20,col=c("red","blue"),
       legend=c("estimate","true value"),bty="n")
</code></pre>


</div>