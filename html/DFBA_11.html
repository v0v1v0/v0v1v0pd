<div class="container">

<table style="width: 100%;"><tr>
<td>dfba_bivariate_concordance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Distribution-Free Correlation and Concordance</h2>

<h3>Description</h3>

<p>Given bivariate data, computes the sample number of concordant changes <code>nc</code>
between the two variates and the number of discordant changes <code>nd</code>.
Provides the frequentist <code>tau_A</code> correlation coefficient
<code>(nc-nd)/(nc+nd)</code>, and provides a Bayesian analysis of the population
concordance parameter <code>phi</code>: the limit of the proportion of concordance
changes between the variates.
For goodness-of-fit applications, provides a concordance measure that
corrects for the number of fitting parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dfba_bivariate_concordance(
  x,
  y,
  a0 = 1,
  b0 = 1,
  prob_interval = 0.95,
  fitting.parameters = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of x variable values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of y variable values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>First shape parameter for the prior beta distribution (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>Second shape parameter for the prior beta distribution (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_interval</code></td>
<td>
<p>Desired width for interval estimates (default is .95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitting.parameters</code></td>
<td>
<p>(Optional) If either x or y values are generated by a predictive model, the number of free parameters in the model (default is NULL)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The product-moment correlation depends on Gaussian assumptions about the
residuals in a regression analysis. It is not robust because it is strongly
influenced by any extreme outlier scores for either of the two variates. A
rank-based analysis can avoid both of these limitations. The <code>dfba_bivariate_concordance()</code>
function is focused on a nonparametric concordance metric for characterizing
the association between the two bivariate measures.
</p>
<p>To illustrate the nonparametric concepts of concordance and discordance,
consider a specific example where there are five paired scores with
</p>
<p style="text-align: center;"><code class="reqn">x = {3.8, 4.7, 4.7, 4.7, 11.8}</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">y = [5.9, -4.1, 7.3, 7.3, 38.9].</code>
</p>

<p>The ranks for the <code class="reqn">x</code> variate are <code class="reqn">1, 3, 3, 3, 5</code> and the corresponding
ranks for <code class="reqn">y</code> are <code class="reqn">2, 1, 3.5, 3.5, 5</code>, so the five points in terms of
their ranks are <code class="reqn">P_1 = (1, 2)</code>, <code class="reqn">P_2 = (3, 1)</code>, <code class="reqn">P_3 = (3, 3.5)</code>,
<code class="reqn">P_4 = (3, 3.5)</code> and <code class="reqn">P_5 = (5,5)</code>. The relationship between any two
of these points <em>Pi</em> and <em>Pj</em>, is either (1) concordant if the
sign of <code class="reqn">R_{xi} - R_{xj}</code> is the same as the sign of
<code class="reqn">R_{yi} - R_{yj}</code>, (2) discordant if signs are
different between <code class="reqn">R_{xi}-R_{xj}</code> and <code class="reqn">R_{yi}-R_{yj}</code>, or (3) null if
either <code class="reqn">R_{xi}=R_{xj}</code> or if <code class="reqn">R_{yi}=R_{yj}</code>. For the above example,
there are ten possible comparisons among the five points; six are concordant,
one is discordant, and there are three comparisons lost due to ties. In
general, given <code class="reqn">n</code> bivariate scores there are <code class="reqn">n(n-1)/2</code> total
possible comparisons. When there are ties in the <code class="reqn">x</code> variate, there is
a loss of <code class="reqn">T_x</code> comparisons, when there are ties in the <code class="reqn">y</code> variate,
there are <code class="reqn">T_y</code> lost comparisons. Ties in both <code class="reqn">x</code> and <code class="reqn">y</code> are denoted
<code class="reqn">T_{xy}</code>. The total number of possible comparisons,
accounting for ties, is therefore: </p>
<p style="text-align: center;"><code class="reqn">n(n-1)/2-T_x-T_y+T_{xy},</code>
</p>
<p> where <code class="reqn">T_{xy}</code>
is added to avoid double-counting of lost comparisons.
</p>
<p>In the above example, there are three lost comparisons due to ties in <code class="reqn">x</code>,
one lost comparison due to a tie in <code class="reqn">y</code>, and one comparison lost to a tie
in both the <code class="reqn">x</code> and <code class="reqn">y</code> variates. Thus, there are <code class="reqn">[(5*4)/2]-3-1+1=7</code>
comparisons for the above example. The <code class="reqn">\tau_A</code> correlation is defined as
<code class="reqn">(n_c-n_d)/(n_c+n_d)</code>, which is a value on the <code class="reqn">[-1,1]</code> interval. However,
it is important to note the original developer of the frequentist <code class="reqn">\tau</code>
correlation used a different coefficient that has come to be called
<code class="reqn">\tau_B</code>, which is given as
<code class="reqn">(n_c-n_d)/([(n*(n-1)/2)-Tx][(n*(n-1)/2)-Ty])^{.5}</code>. However, <code class="reqn">\tau_B</code>
does not properly correct for tied scores, which is unfortunate
because <code class="reqn">\tau_B</code> is the value returned by the <code>stats</code> function
<code>cor(..., method = "kendall")</code>. If there are no ties, then
<code class="reqn">T_x = T_y = T_{xy} = 0</code> and <code class="reqn">\tau_A = \tau_B</code>. But if there are ties,
then the proper coefficient is given by <code class="reqn">\tau_A</code>. The <code>dfba_bivariate_concordance()</code>
function provides the proper correction for tied scores and outputs a sample
estimate for <code class="reqn">\tau_A</code>.
</p>
<p>The focus for the Bayesian analysis is on the population proportion
of concordance, which is the limit of the ratio <code class="reqn">n_c/(n_c+n_d)</code>. This
proportion is a value on the <code class="reqn">[0,1]</code> interval, and it is called <code class="reqn">\phi</code> (Phi).
<code class="reqn">\phi</code> is also connected to the population <code class="reqn">\tau_A</code> because
<code class="reqn">\tau_A=(2\phi -1)</code>. Moreover, Chechile (2020) showed that the
likelihood function for observing <code class="reqn">n_c</code> concordant changes and <code class="reqn">n_d</code>
discordant changes is a censored Bernoulli process, so the likelihood is
proportional to <code class="reqn">(\phi^{n_c})((1-\phi)^{n_d})</code>. In Bayesian statistics, the
likelihood function is only specified as a proportional function because,
unlike in frequentist statistics, the likelihood of unobserved and more
extreme events are not computed. This idea is the <em>likelihood principle</em>,
and its violation can lead to paradoxes (Lindley &amp; Phillips, 1976). Also, the
likelihood need only be a proportional function because the proportionality
constant appears in both the numerator and denominator of Bayes theorem, so
it cancels out. If the prior for <code class="reqn">\phi</code> is a beta distribution, then it
follows that the posterior is also a beta distribution (<em>i.e.</em>, the beta
is a natural Bayesian conjugate function for Bernoulli processes). The
default prior for the <code>dfba_bivariate_concordance()</code> function is the flat prior (<em>i.e.</em>,
<code>a0 = 1</code> and <code>b0 = 1</code>).
</p>
<p>In the special case where the user has a model for predicting a variate in
terms of known quantities and where there are free-fitting parameters, the
<code>dfba_bivariate_concordance()</code> function's concordance parameter is a goodness-of-fit measure
for the scientific model. Thus, the bivariate pair are the observed value of
a variate along with the corresponding predicted score from the model. The
concordance proportion must be adjusted in these goodness-of-fit applications
to take into account the number of free parameters that were used
in the prediction model. Chechile and Barch (2021) argued that the fitting
parameters increases the number of concordant changes. Consequently, the
value for <code class="reqn">n_c</code> is downward-adjusted as a function of the number of free
parameters. The Chechile-Barch adjusted <code class="reqn">n_c</code> value for a case where there
are <code class="reqn">m</code> free fitting parameters is <code class="reqn">n_c-(n*m)+[m*(m+1)/2]</code>. As an example,
suppose that there are <code class="reqn">n = 20</code> scores, and the prediction equation has
<code class="reqn">m = 2</code> free parameters that result in creating a prediction for each
observed score (<em>i.e.</em>, there are 20 paired values of observed score <code>x</code>
and predicted score <code>y</code>), and further suppose that this model results in
<code class="reqn">n_c = 170</code> and <code class="reqn">n_d = 20</code>. The value of <code>n_d</code> is kept at 20, but
the number of concordant changes is reduced to <code class="reqn">170-(20*2)+(2*3/2) = 133.</code>
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Nonparametric Tau-A correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_p</code></td>
<td>
<p>Sample concordance proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Number of concordant comparisons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd</code></td>
<td>
<p>Number of discordant comparisons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_post</code></td>
<td>
<p>The first shape parameter for the posterior beta distribution for the concordance proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_post</code></td>
<td>
<p>The second shape parameter for the posterior beta distribution for the concordance proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>The first shape parameter for the prior beta distribution for the  concordance proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>The second shape parameter for the prior beta distribution for the concordance proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_interval</code></td>
<td>
<p>The probability within the interval estimates for the phi parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_median</code></td>
<td>
<p>Median of posterior distribution on phi</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eti_lower</code></td>
<td>
<p>Lower limit of the equal-tail interval with width specified by prob_interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eti_upper</code></td>
<td>
<p>Upper limit of the equal-tail interval with width specified by prob_interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_star</code></td>
<td>
<p>Corrected tau_A to account for the number of free fitting parameter in goodness-of-fit applications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc_star</code></td>
<td>
<p>The corrected number of concordant comparisons for a goodness-of-fit application when there is an integer value for <code>fitting.parameters</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd_star</code></td>
<td>
<p>The number of discordant comparison when there is an integer value for <code>fitting.parameters</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_p_star</code></td>
<td>
<p>Correct proportion of concordant comparisons to account for free-fitting parameter for goodness-of-fit applications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_post_star</code></td>
<td>
<p>Corrected value for the first shape parameter for the posterior for the concordance proportion when there are free fitting parameter for goodness-of-fit applications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_post_star</code></td>
<td>
<p>The second shape parameter for the posterior distribution for the concordance proportion when there is a goodness-of-fit application</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_median_star</code></td>
<td>
<p>The posterior median for the concordance proportion when there is a goodness-of-fit application</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eti_lower_star</code></td>
<td>
<p>Lower limit for the interval estimate when there is a goodness-of-fit application</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eti_upper_star</code></td>
<td>
<p>Upper limt for the interval estimate when there is a goodness-of-fit application</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chechile, R.A. (2020). Bayesian Statistics for Experimental Scientists: A
General Introduction Using Distribution_Free Statistics. Cambridge: MIT Press.
</p>
<p>Chechile, R.A., &amp; Barch, D.H. (2021). A distribution-free, Bayesian
goodness-of-fit method for assessing similar scientific prediction equations.
Journal of Mathematical Psychology. https://doi.org/10.1016/j.jmp.2021.102638
</p>
<p>Lindley, D. V., &amp; Phillips, L. D. (1976). Inference for a Bernoulli process
(a Bayesian view). The American Statistician, 30, 112-119.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

x &lt;- c(47, 39, 47, 42, 44, 46, 39, 37, 29, 42, 54, 33, 44, 31, 28, 49, 32, 37, 46, 55, 31)
y &lt;- c(36, 40, 49, 45, 30, 38, 39, 44, 27, 48, 49, 51, 27, 36, 30, 44, 42, 41, 35, 49, 33)

dfba_bivariate_concordance(x, y)

## A goodness-of-fit example for a hypothetical case of fitting data in a
## yobs vector with prediction model

p = seq(.05,.95,.05)
ypred= 17.332 - (50.261*p) + (48.308*p^2)

# Note the coefficients in the ypred equation were found first via a
# polynomial regression

yobs&lt;-c(19.805, 10.105, 9.396, 8.219, 6.110, 4.543, 5.864, 4.861, 6.136,
         5.789,  5.443, 5.548, 4.746, 6.484, 6.185, 6.202, 9.804, 9.332,
         14.408)

dfba_bivariate_concordance(x = yobs,
         y = ypred,
         fitting.parameters = 3)

</code></pre>


</div>