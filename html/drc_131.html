<div class="container">

<table style="width: 100%;"><tr>
<td>neill.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Neill's lack-of-fit test for dose-response models
</h2>

<h3>Description</h3>

<p>'neill.test' provides a lack-of-fit test for non-linear regression models. It is applicable both in cases 
where there are replicates (in which case it reduces to the standard lack-of-fit test against an ANOVA
model) and in cases where there are no replicates, though then a grouping has to be provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  neill.test(object, grouping, method = c("c-finest", "finest", "percentiles"), 
  breakp = NULL, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>object of class 'drc' or 'nls'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>

<p>character or numeric vector that provides the grouping of the dose values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character string specifying the method to be used to generate a grouping of the dose values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakp</code></td>
<td>

<p>numeric vector of break points for generating dose intervals that form a grouping.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>

<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions used the methods <code>df.residual</code> and <code>residuals</code> and the 'data'
component of <code>object</code> (only for determining the number of observations).
</p>


<h3>Value</h3>

<p>The function returns an object of class anova which is displayed using <code>print.anova</code>.
</p>


<h3>Note</h3>

<p>A clustering technique could be employed to determine the grouping to be used in cases where there are
no replicates. There should at most be ceiling(n/2) clusters as otherwise some observations will not be used
in the test. At the other end there need to be more clusters than parameters in the model.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Neill, J. W. (1988) Testing for lack of fit in nonlinear regression, 
<em>Ann. Statist.</em>, <b>16</b>, 733â€“740  
</p>


<h3>See Also</h3>

<p>See also <code>modelFit</code> for details on the lack-of-fit test against an ANOVA model.</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example with 'drc' object

## Lack-of-fit test against ANOVA
ryegrass.m1 &lt;-drm(rootl~conc, data = ryegrass, fct = LL.4())
modelFit(ryegrass.m1)

## The same test using 'neill.test'
neill.test(ryegrass.m1, ryegrass$conc)

## Generating a grouping
neill.test(ryegrass.m1, method="c-finest")
neill.test(ryegrass.m1, method="finest")
neill.test(ryegrass.m1, method="perc")


</code></pre>


</div>