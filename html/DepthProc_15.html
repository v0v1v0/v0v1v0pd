<div class="container">

<table style="width: 100%;"><tr>
<td>CovLP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CovLp</h2>

<h3>Description</h3>

<p>Weighted by <code class="reqn"> L ^ p </code> depth (outlyingness) multivariate location and scatter estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CovLP(x, pdim = 2, la = 1, lb = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data as a matrix or data frame. If it is a matrix or data frame, then each row is viewed as one multivariate observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdim</code></td>
<td>
<p>The parameter of the weighted <code class="reqn"> {L} ^ {p} dim </code> depth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la</code></td>
<td>
<p>parameter of a simple weight function <code class="reqn"> w = ax + b </code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>parameter of a simple weight function <code class="reqn"> w = ax + b </code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using depth function one can define a depth-weighted location and scatter estimators. In case of location estimator we have </p>
<p style="text-align: center;"><code class="reqn"> L(F) = {\int {{x}{{w}_{1}}(D({x}, F))dF({x})}} / {{{w}_{1}}(D({x}, F))dF({x})} </code>
</p>
<p> Subsequently, a depth-weighted scatter estimator is defined as </p>
<p style="text-align: center;"><code class="reqn"> S(F) = \frac{ \int {({x} - L(F)){{({x} - L(F))} ^ {T}}{{w}_{2}}(D({x}, F))dF({x})} }{ \int {{{w}_{2}}(D({x}, F))dF({x})}}, </code>
</p>
<p> where <code class="reqn"> {{w}_{2}}(\cdot) </code> is a suitable weight function that can be different from <code class="reqn"> {{w}_{1}}(\cdot) </code>.
</p>
<p>The <span class="pkg">DepthProc</span> package offers these estimators for weighted <code class="reqn"> {L} ^ {p} </code> depth. Note that <code class="reqn"> L(\cdot) </code> and <code class="reqn"> S(\cdot) </code> include multivariate versions of trimmed means and covariance matrices. Their sample counterparts take the form </p>
<p style="text-align: center;"><code class="reqn"> {{T}_{WD}}({{{X}} ^ {n}}) = {\sum\limits_{i = 1} ^ {n} {{{d}_{i}}{{X}_{i}}}} / {\sum\limits_{i = 1} ^ {n} {{{d}_{i}}}}, </code>
</p>
 <p style="text-align: center;"><code class="reqn"> DIS({{{X}}^{n}}) = \frac{ \sum\limits_{i = 1} ^ {n} {{{d}_{i}}\left( {{{X}}_{i}} - {{T}_{WD}}({{{X}} ^ {n}}) \right){{\left( {{{X}}_{i}} - {{T}_{WD}}({{{X}} ^ {n}}) \right)} ^ {T}}} }{ \sum\limits_{i = 1} ^ {n} {{{d}_{i}}}}, </code>
</p>
<p> where <code class="reqn"> {{d}_{i}} </code> are sample depth weights, <code class="reqn"> {{w}_{1}}(x) = {{w}_{2}}(x) = x </code>.
</p>


<h3>Value</h3>

<p>loc: Robust Estimate of Location:
</p>
<p>cov: Robust Estimate of Covariance:
</p>
<p>Returns depth weighted covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Daniel Kosiorowski and Zygmunt Zawadzki from Cracow University of Economics.
</p>


<h3>See Also</h3>

<p><code>depthContour</code> and <code>depthPersp</code> for depth graphics.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1
x &lt;- mvrnorm(n = 100, mu = c(0, 0), Sigma = 3 * diag(2))
cov_x &lt;- CovLP(x, 2, 1, 1)

# EXAMPLE 2
data(under5.mort, inf.mort, maesles.imm)
data1990 &lt;- na.omit(cbind(under5.mort[, 1], inf.mort[, 1], maesles.imm[, 1]))
CovLP(data1990)

</code></pre>


</div>