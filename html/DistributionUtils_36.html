<div class="container">

<table style="width: 100%;"><tr>
<td>tailPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tail Plot Functions
</h2>

<h3>Description</h3>

<p>Create a left or right tail plot of a data set using
<code>tailPlot</code>. Add a line for any distribution with parameters given
by an argument named <code>param</code>, using <code>tailPlotLine</code>.
Add normal, <code class="reqn">t</code>, or gamma distribution lines to
the plot using <code>normTailPlotLine</code>, <code>tTailPlotLine</code>, or
<code>gammaTailPlotLine</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">tailPlot(x, log = "y", side = c("right", "left"), main = NULL,
         xlab = NULL, ylab = NULL, ...)
tailPlotLine(x, distrFn, param = NULL, side = c("right", "left"), ...)
normTailPlotLine(x, mean = 0, sd = 1, side = c("right", "left"), ...)
tTailPlotLine(x, df = Inf, side = c("right", "left"), ...)
gammaTailPlotLine(x, shape = 1, rate = 1, scale = 1/rate,
                  side = c("right", "left"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of values for which the tail plot is to be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>A character string which contains <code>"x"</code> if the x-axis
is to be logarithmic, <code>"y"</code> if the y-axis is to be logarithmic
and <code>"xy"</code> or <code>"yx"</code> if both axes are to be logarithmic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Character. <code>"right"</code> (the default) for a tail plot of
the right-hand tail, <code>"left"</code> for a tail plot of
the left-hand tail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A label for the x axis, defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A label for the y axis, defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distrFn</code></td>
<td>
<p>Character. The name of the distribution function to be
to be added to the tail plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Vector specifying the parameters of the distribution,
defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>The mean of the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>The standard deviation of the normal distribution. Must be
positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The degrees of freedom of the <code class="reqn">t</code>-distribution, (<code class="reqn">&gt;
      0</code>, may be non-integer). Defaults to <code>Inf</code>, corresponding to
the standard normal distribution. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>The shape parameter of the gamma distribution. Must be
positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The scale parameter of the gamma distribution. Must be
strictly positive, <code>scale</code> strictly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>The rate parameter of the gamma distribution. An
alternative way to specify the scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters (see <code>par</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>tailPlot</code> draws either a left-hand or right-hand tail plot of
the data <code>x</code>. See for example Resnick (2007), p.105. The
left-hand tail plot plots the empirical distribution of the data
against the order statistics, for order statistic values below the
median. The right-hand tail plot plots one minus the empirical
distribution of the data against the order statistics, for order
statistic values above the median. The default is for the y-axis to be
plotted on a log scale.
</p>
<p><code>tailPlotLine</code> adds a line for the specified distribution to an
already drawn tail plot. The distribution can be any distribution
which has default parameters, but if parameters need to be supplied
the distribution must have an argument <code>param</code> which specifies
the parameters. This is the case for all distributions in the form
recommended in Scott <em>et al</em> (2009) and includes distributions
from the packages <span class="pkg">GeneralizedHyperbolic</span>, <span class="pkg">SkewHyperbolic</span>,
<span class="pkg">VarianceGamma</span> and <span class="pkg">NormalLaplace</span> (which is on R-Forge).
</p>
<p><code>normTailPlotLine</code>,<code>tTailPlotLine</code> and
<code>gammaTailPlotLine</code> add the corresponding line
derived respectively from the given normal, <code class="reqn">t</code>, or gamma
distribution to an already drawn tail plot.
</p>


<h3>Value</h3>

<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>
</p>


<h3>References</h3>

<p>Aas, Kjersti and Hobæk Haff, Ingrid (2006)
The generalised hyperbolic skew Student's <code class="reqn">t</code>-distribution.
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275–309.
</p>
<p>Resnick, S. (2007) <em>Heavy-Tail Phenomena</em>, New York: Springer.
</p>
<p>Scott, David J. and Würtz, Diethelm and Dong, Christine
(2009) Software for Distributions in R. UseR: The R User
Conference 2009
<a href="https://www.r-project.org/conferences/useR-2009/slides/Scott+Wuertz+Dong.pdf">https://www.r-project.org/conferences/useR-2009/slides/Scott+Wuertz+Dong.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Draw tail plot of some data
x &lt;- rnorm(100, 1, 2)
tailPlot(x)
### Add normal distribution line
normTailPlotLine(x, mean = 1, sd = 2)
### Add t distribution line
tTailPlotLine(x, df = 5, lty = 2)
### Use fitted values
normTailPlotLine(x, mean = mean(x), sd = sd(x), lty = 3)

### Gamma distribution
x &lt;- rgamma(100, shape = 1, scale = 1)
tailPlot(x)
### Add gamma distribution line
gammaTailPlotLine(x, shape = 1, scale = 1)
### Left tail example
tailPlot(x, side = "l")
### Add gamma distribution line
gammaTailPlotLine(x, shape = 1, scale = 1, side = "l")
### Log scale on both axes
tailPlot(x, side = "l", log = "xy")
### Add gamma distribution line
gammaTailPlotLine(x, shape = 1, scale = 1, side = "l")

### Add line from a standard distribution with default parameters
x &lt;- rlnorm(100)
tailPlot(x)
tailPlotLine(x, distrFn = "lnorm")

### Add line from a distribution with 'param' argument
require(VarianceGamma)
param &lt;- c(0,0.5,0,0.5)
x &lt;- rvg(100, param = param)
tailPlot(x)
tailPlotLine(x, distrFn = "vg", param = param)

</code></pre>


</div>