<div class="container">

<table style="width: 100%;"><tr>
<td>make.M</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision Matrix Function</h2>

<h3>Description</h3>

<p>This function creates the precision matrix for the spatial prior based on thin-plate splines
and returns the matrix M, and its eigenvalues and eigenvectors
</p>


<h3>Usage</h3>

<pre><code class="language-R">make.M(X, covariates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of spatial coordinates. It is recommended that the coordinates be scaled and centred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>the observed values for the covariates (including intercept).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The M matrix is the precision matrix for the
spatial effects from the direct sampling spatial prior (DSSP) model. M is based on
thin plate splines basis functions, see White et. al. 2019 for more details on how the
matrix M is constructed.
</p>


<h3>Value</h3>

<p>A list containing the precision matrix M and the object M.eigen containing
eigenvalues and eigenvectors for the matrix M.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Use the Meuse River dataset from the package 'gstat'

library(sp)
library(gstat)
data(meuse.all)
coordinates(meuse.all) &lt;- ~ x + y
X &lt;- scale(coordinates(meuse.all))
make.M(X)
</code></pre>


</div>