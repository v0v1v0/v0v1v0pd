<div class="container">

<table style="width: 100%;"><tr>
<td>summaryDIRECT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Processing Posterior Estimates for Clustering Under DIRECT
</h2>

<h3>Description</h3>

<p>Function <code>summaryDIRECT</code> processes posterior estimates in the output files from <code>DIRECT</code> for clustering and parameter estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">summaryDIRECT(data.name, PERM.ADJUST = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>

<p>A character string indicating the prefix of output files.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PERM.ADJUST</code></td>
<td>

<p>If TRUE, add 1 to labels of mixture components such that the labels start from 1 instead of 0.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Output files from <code>DIRECT</code> include MCMC samples before relabeling and permuted labels of mixture components after relabeling.  Function <code>summaryDIRECT</code> uses permuted labels stored in output file *_mcmc_perms.out to reorganize the MCMC samples stored in other output files *_mcmc_cs.out, *_mcmc_pars.out and *_mcmc_probs.out.  It defines each mixture component as a cluster.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nitem</code></td>
<td>

<p>The number of items in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclust</code></td>
<td>

<p>The number of inferred clusters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.clust.alloc</code></td>
<td>

<p>A vector of length <code>nitem</code>, each component being the maximum posterior probability of allocating the corresponding item to a cluster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.sizes</code></td>
<td>

<p>Vector of cluster sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top.clust.labels</code></td>
<td>

<p>An integer vector of labels of inferred clusters.  The integers are not necessarily consecutive; that is, an inferred mixture component that is associated with items at small posterior allocation probabilities is dropped from the final list of cluster labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top2allocations</code></td>
<td>

<p>A data frame containing "first", the most likely allocation; "second", the second most likely allocation; "prob1", the posterior allocation probability associated with "first"; and "prob2", the posterior allocation probability associated with "second".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.alloc.probs</code></td>
<td>

<p>A <code>nitem</code>-by-<code>nclust</code> matrix of mean posterior allocation probability matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.clust.pars.mean</code></td>
<td>

<p>A matrix of <code>nclust</code> rows.  Each row, corresponding to an inferred cluster, contains the posterior mean estimates of cluster-specific parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.clust.pars.median</code></td>
<td>

<p>A matrix of <code>nclust</code> rows.  Each row, corresponding to an inferred cluster, contains the posterior median estimates of cluster-specific parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>misc</code></td>
<td>
<p>A list containing two components:
</p>

<ul>
<li> <p><code>post.pars.mean</code>: Matrix each row of which contains the posterior mean estimates of parameters for a mixture component.
</p>
</li>
<li> <p><code>post.pars.median</code>: Matrix each row of which contains the posterior median estimates of parameters for a mixture component. 
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code>DIRECT</code> for what output files are produced.
</p>
<p><code>simuDataREM</code> for simulating data under the mixture random-effects model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See example in DIRECT.
</code></pre>


</div>