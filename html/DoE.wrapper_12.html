<div class="container">

<table style="width: 100%;"><tr>
<td>lhs.design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Functions for accessing latin hypercube sampling designs from package lhs 
or space-filling designs from package DiceDesign</h2>

<h3>Description</h3>

<p>Functions for comfortably accessing latin hypercube sampling designs from package lhs 
or space-filling designs from package DiceDesign, 
which are useful for quantitative factors with many possible levels. In particular, 
they can be used in computer experiments. Most of the designs are random samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lhs.design(nruns, nfactors, type="optimum", factor.names=NULL, seed=NULL, digits=NULL, 
         nlevels = nruns, default.levels = c(0, 1), randomize = FALSE, ...)
lhs.augment(lhs, m=1, type="optAugment", seed=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nruns</code></td>
<td>
<p> number of runs in the latin hypercube sample; <br>
for type <code>fact</code> (a full factorial with equally-space levels), 
if <code>nlevels</code> is not separately specified, 
this number is taken to be the common number of levels of all factors, 
i.e. the resulting design will have <code>nruns^nfactors</code> runs;<br>
alternatively, if <code>nlevels</code> is separately specified as a vector of different numbers of levels, 
<code>nruns</code> can be missing or can be the correctly-specified number of runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfactors</code></td>
<td>
<p> number of factors in the latin hypercube sample </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> character string indicating the type of design or augmentation method;
defaults are “optimum” for <code>lhs.design</code> and “optAugment” 
for <code>lhs.augment</code>.<br><br>
Function <code>lhs.design</code> calls <br>
a function named typeLHS from package 
<span class="pkg">lhs</span> (types <code>genetic</code>, <code>improved</code>, <code>maximin</code>, <code>optimum</code>, <code>random</code>), <br>
a function named typeDesign from package <span class="pkg">DiceDesign</span> (types <code>dmax</code>, <code>strauss</code>, <code>fact</code>)<br>
or function <code>runif.faure</code> from package <span class="pkg">DiceDesign</span> (type <code>faure</code>).<br><br>
Function <code>lhs.augment</code> calls function typeLHS from package <span class="pkg">lhs</span>, <br>
where possible choices for <code>type</code> are <code>augment</code>, <code>optSeeded</code>, or <code>optAugment</code>.<br> 
see the respective functions from packages <span class="pkg">lhs</span> and 
<span class="pkg">DiceDesign</span>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p> seed for random number generation; latin hypercube samples from package 
<span class="pkg">lhs</span> are random samples. Specifying a seed used to make the result reproducible for 
early versions of package <span class="pkg">lhs</span> - lately, 
results are reproducible within a package version, but reproducibility between 
package versions cannot be guaranteed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.names</code></td>
<td>
<p> list of scale end values for each factor; 
names are used as variable names;<br>
the names should not be x1, x2, ..., as this would interfere with usability 
of standard second order analysis methods on the resulting data (<code>link{rsmformula}</code>);<br>
if the list is not named, the variable names are X1, X2 and so forth;
the original unit cube calculated by package <span class="pkg">lhs</span> (scale ends 0 and 1 for each variable) 
is rescaled to the values given in factor.names. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p> digits to which the design columns are rounded; one single value 
(the same for all factors) or a vector of length <code>nfactors</code>;<br>
note that the rounding is applied after generation of the design on the actual 
data scale, i.e. the unit cube generated by the functions from packages <span class="pkg">lhs</span> 
or <span class="pkg">DiceDesign</span> is NOT rounded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>used for type <code>fact</code> only; integer number or numeric vector of <code>nfactor</code> 
integers; specifies the number of levels for each factor. If all factors have the same number 
of levels, the number of levels can also be specified through <code>nruns</code>, which is 
interpreted as the number of levels for type <code>fact</code>, if <code>nlevels</code> is 
not separately specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default.levels</code></td>
<td>
<p>scale ends for all factors; convenient, 
if all factors have the same scaling that deviates from the default 0/1 scale ends. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomize</code></td>
<td>
<p>logical that prevents randomization per default. The option has an effect 
for types <code>fact</code> and <code>faure</code> only. All other types are based on random 
design generation anyway. 
Note that preventing randomization is the default here, because these designs 
are assumed to be used mostly for computer experimentation, where the systematics 
of the non-randomized design may be beneficial. For hardware experimentation, 
randomization should be set to <code>TRUE</code>!<br><br>
If randomization is requested, the following information is relevant:<br>
In R version 3.6.0 and later, the default behavior of function <code>sample</code>
has changed. If you work in a new (i.e., &gt;= 3.6.0) R version want to 
run code interchangeably on R 3.6.0 and an earlier R version,
you have to change the RNGkind setting in the later R version by<br><code>RNGkind(sample.kind="Rounding")</code><br>
before running function <code>lhs.design</code>.<br>
It is recommended to change the setting back to the new recommended way afterwards:<br><code>RNGkind(sample.kind="default")</code><br>
For an example, see the documentation of the example data set <code>VSGFS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhs</code></td>
<td>
<p>design generated by function <code>lhs.design</code> (class <code>design</code>, 
of type <code>lhs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>integer number of additional points to add to design <code>lhs</code> (note, however, 
that <code>optSeeded</code> does not necessarily preserve all original runs!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional arguments to the functions from packages <span class="pkg">lhs</span> 
or <span class="pkg">DiceDesign</span>. 
Refer to their documentation. <br>
Functions for generating lhs designs: 
<code>randomLHS</code>, <code>geneticLHS</code>, 
<code>improvedLHS</code>, <code>maximinLHS</code>, 
<code>optimumLHS</code>, <code>dmaxDesign</code>, 
<code>straussDesign</code>, <code>runif.faure</code>, 
<code>factDesign</code>; <br>
functions for augmenting lhs designs: 
<code>augmentLHS</code>, 
<code>optSeededLHS</code>, 
<code>optAugmentLHS</code>)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>lhs.design</code> creates a latin hypercube sample, 
function <code>lhs.augment</code> augments an existing latin hypercube sample (or in case of 
type <code>optSeeded</code> takes the existing sample as the starting point but potentially modifies it). 
In comparison to direct usage of package <span class="pkg">lhs</span>, the functions add the possibility 
of recoding lhs samples to a desired range, and they embed the lhs designs into 
class <code>design</code>.<br>
Range coding is based on the recoding facility from package <span class="pkg">rsm</span> and the 
<code>factor.names</code> parameter used analogously to packages <span class="pkg">DoE.base</span> and <span class="pkg">FrF2</span>.
</p>
<p>The lhs designs are useful for quantitative factors, if it is considered desirable to uniformly 
distribute design points over a hyperrectangular space. This is e.g. considered interesting 
for computer experiments, where replications of the same settings are often useless.
</p>
<p>Supported design types are described in the documentation for 
packages <code>lhs</code> 
and <code>DiceDesign</code>.
</p>


<h3>Value</h3>

<p>Both functions return a data frame of S3 class <code>design</code> 
with attributes attached. 
The data frame contains the experimental settings as recoded to the scale ends defined in factor.names (if given), 
rounded to the number of digits given in <code>digits</code> (if given).
The experimental factors in the matrix <code>desnum</code> attached as attribute <code>desnum</code> contain the 
design in the unit cube (all experimental factors ranging from 0 to 1) as 
returned by packages <span class="pkg">lhs</span> or <span class="pkg">DiceDesign</span>. <br>
Function <code>lhs.augment</code> preserves additional variables (e.g. responses) that 
have been added to the design <code>lhs</code> before augmenting. Note, however, that 
the response data are NOT used in deciding about which points to augment the design with. 
</p>
<p>The attribute <code>run.order</code> is not very useful for most of these designs, as there is no standard order. 
It therefore is present for formal reasons only and contains three identical columns of 1,2,...,nruns. 
For designs created with <code>type=fact</code> or <code>type=faure</code>, the standard order is the order 
in which package <span class="pkg">DiceDesign</span> creates the design, and the actual run order may be different in case of 
randomization.<br>
In case of <code>lhs.augment</code>, if the design to be augmented had been reordered before, 
the augmented design preserves this reorder and also the respective numbering of the design.
</p>
<p>The attribute <code>design.info</code> is a list of various design properties, with type resolving to “lhs”. 
In addition to the standard list elements (cf. <code>design</code>), the <code>subtype</code> 
element indicates the type of latin hypercube designs and possibly additional augmentations, the element 
<code>quantitative</code> is a vector of <code>nfactor</code> logical TRUEs, 
and the <code>digits</code> elements indicates the digits to which the data were rounded. <br>
For designs created with package <span class="pkg">DiceDesign</span>, special list elements from this package 
are also added to <code>design.info</code>.<br><code>randomize</code> is always TRUE for designs generated by random sampling, but may be FALSE for 
designs created with <code>type=fact</code> or <code>type=faure</code>. <br><code>coding</code> provides formulae for making the designs comfortably usable with 
standard second order methodology implemented in package <span class="pkg">rsm</span>. 
<code>replications</code> is always 1 and <code>repeat.only</code> is always FALSE; 
these elements are only present to fulfill the formal requirements for class <code>design</code>.
</p>


<h3>Warning</h3>

<p>Since R version 3.6.0, the behavior of function <code>sample</code> has changed 
(correction of a biased previous behavior that should not be relevant for the randomization of designs). 
For using code that randomizes a design interchangeably between a new R version (3.6.0 or later) 
and an older one, please follow the steps described with the argument <code>randomize</code>.
</p>
<p>Note also: Package <span class="pkg">lhs</span> does not promise to keep designs reproducible between package versions. Thus, 
please make sure to store important designs for the future, if needed (of course, this is always wise anyway!).
</p>


<h3>Note</h3>

<p> This package is still under (slow) development. Reports about bugs and inconveniences are welcome.  </p>


<h3>Author(s)</h3>

<p> Ulrike Groemping </p>


<h3>References</h3>

 
<p>Beachkofski, B., Grandhi, R. (2002) Improved Distributed Hypercube Sampling. American Institute of Aeronautics and Astronautics Paper 1274.
</p>
<p>Currin C., Mitchell T., Morris M. and Ylvisaker D. (1991) 
Bayesian Prediction of Deterministic Functions With Applications to the Design and Analysis of Computer Experiments, 
<em>Journal of the American Statistical Association</em> <b>86</b>, 953–963.
</p>
<p>Santner T.J., Williams B.J. and Notz W.I. (2003) The Design and Analysis of Computer Experiments, Springer, 121–161.
</p>
<p>Shewry, M. C. and Wynn and H. P. (1987) Maximum entropy sampling. <em>Journal of Applied Statistics</em> <b>14</b>, 165–170.
</p>
<p>Fang K.-T., Li R. and Sudjianto A. (2006) <em>Design and Modeling for Computer Experiments</em>, Chapman &amp; Hall.
</p>
<p>Stein, M. (1987) Large Sample Properties of Simulations Using Latin Hypercube Sampling. <em>Technometrics</em> <b>29</b>, 143–151. 
</p>
<p>Stocki, R. (2005) A method to improve design reliability using optimal Latin hypercube sampling. 
<em>Computer Assisted Mechanics and Engineering Sciences</em> <b>12</b>, 87–105.
</p>


<h3>See Also</h3>

<p> See Also <code>compare</code> for comparing optimality criteria for various 
designs, <br><code>lhs-package</code> and 
<code>DiceDesign-package</code> for the packages that do the calculations,<br><code>FrF2</code>, <code>oa.design</code>, 
<code>fac.design</code>, <code>pb</code> for other possibilites of generating designs</p>


<h3>Examples</h3>

<pre><code class="language-R">   ## maximin design from package lhs
   plan &lt;- lhs.design(20,7,"maximin",digits=2) 
   plan
   plot(plan)
   cor(plan)
   y &lt;- rnorm(20)
   r.plan &lt;- add.response(plan, y)
   
   ## augmenting the design with 10 additional points, default method
   plan2 &lt;- lhs.augment(plan, m=10)
   plot(plan2)
   cor(plan2)
   
   ## purely random design (usually not ideal)
   plan3 &lt;- lhs.design(20,4,"random",
          factor.names=list(c(15,25), c(10,90), c(0,120), c(12,24)), digits=2)
   plot(plan3)
   cor(plan3)
   
   ## optimum design from package lhs (default)
   plan4 &lt;- lhs.design(20,4,"optimum",
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   plot(plan4)
   cor(plan4)
   
   ## dmax design from package DiceDesign
   ## arguments range and niter_max are required
   ## ?dmaxDesign for more info
   plan5 &lt;- lhs.design(20,4,"dmax",
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2,
              range=0.2, niter_max=500)
   plot(plan5)
   cor(plan5)
   
   ## Strauss design from package DiceDesign
   ## argument RND is required
   ## ?straussDesign for more info
   plan6 &lt;- lhs.design(20,4,"strauss",
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2,
              RND = 0.2)
   plot(plan6)
   cor(plan6)
   
   ## full factorial design from package DiceDesign
   ## mini try-out version
   plan7 &lt;- lhs.design(3,4,"fact",
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   plot(plan7)
   cor(plan7)
   
   ## Not run: 
   
   ## full factorial design from package DiceDesign
   ## not as many different levels as runs, but only a fixed set of levels
   ##    caution: too many levels can easily bring down the computer
   ##    above design with 7 distinct levels for each factor, 
   ##    implying 2401 runs 
   plan7 &lt;- lhs.design(7,4,"fact",
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   plot(plan7)
   cor(plan7)
   
   ## equivalent call
   plan7 &lt;- lhs.design(,4,"fact",nlevels=7,
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   
   ## different number of levels for each factor
   plan8 &lt;- lhs.design(,4,"fact",nlevels=c(5,6,5,7),
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   plot(plan8)
   cor(plan8)

   ## equivalent call (specifying nruns, not necessary but a good check)
   plan8 &lt;- lhs.design(1050,4,"fact",nlevels=c(5,6,5,7),
        factor.names=list(torque=c(10,14),friction=c(25,35),
              temperature=c(-5,35),pressure=c(20,50)),digits=2)
   
## End(Not run)
   </code></pre>


</div>