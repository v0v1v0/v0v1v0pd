<div class="container">

<table style="width: 100%;"><tr>
<td>doubconetest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for a vector being in the null space of a double cone
</h2>

<h3>Description</h3>

<p>Given an n-vector y and the model y=m+e, and an m by n "irreducible" matrix amat, test the null hypothesis that the vector m is in the null space of amat.</p>


<h3>Usage</h3>

<pre><code class="language-R">doubconetest(y, amat, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of length n
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>an m by n "irreducible" matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations to approximate null distribution â€“ default is 1000, but choose more if a more precise p-value is desired
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix amat defines a polyhedral convex cone of vectors x such that amat%*%x&gt;=0, and also the opposite cone amat%*%x&lt;=0.   The linear space C is those x such that amat%*%x=0.  The function provides a p-value for the null hypothesis that m=E(y) is in C, versus the alternative that it is in one of the two cones defined by amat.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>The p-value for the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The least-squares fit under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>The least-squares fit to the "positive" cone</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>The least-squares fit to the "negative" cone</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mary C Meyer and Bodhisattva Sen
</p>


<h3>References</h3>

<p>TBA,
Meyer, M.C. (1999) An Extension of the Mixed Primal-Dual Bases Algorithm to the Case of More Constraints than Dimensions, Journal of Statistical Planning and Inference, 81, pp13-31.
</p>


<h3>See Also</h3>

<p><code>agconst</code>,<code>partlintest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## test against a constant function
n=100
x=1:n/n
mu=4-5*(x-1/2)^2
y=mu+rnorm(n)
amat=matrix(0,nrow=n-1,ncol=n)
for(i in 1:(n-1)){amat[i,i]=-1;amat[i,i+1]=1}
ans=doubconetest(y,amat)
ans$pval
plot(x,y,col="slategray");lines(x,mu,lty=3,col=3)
lines(x,ans$p1,col=2)
lines(x,ans$p2,col=4)
</code></pre>


</div>