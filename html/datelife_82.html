<div class="container">

<table style="width: 100%;"><tr>
<td>match_all_calibrations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Match calibrations to nodes of a given tree</h2>

<h3>Description</h3>

<p><code>match_all_calibrations</code> searches a given tree for the most recent common
ancestor (mrca) of all taxon name pairs in a <code>datelifeCalibration</code>. It uses <code>phytools::findMRCA()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">match_all_calibrations(phy, calibrations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibrations</code></td>
<td>
<p>A <code>calibrations</code> object, an output of
<code>extract_calibrations_phylo()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function takes pairs of taxon names in a secondary calibrations data frame,
and looks for them in the vector of tip labels of the tree. If both are present,
then it gets the node that represents the most recent
common ancestor (mrca) for that pair of taxa in the tree.
Nodes of input <code>phy</code> can be named or not.
</p>


<h3>Value</h3>

<p>A list of two elements:
</p>

<dl>
<dt>phy</dt>
<dd>
<p>A <code>phylo</code> object with nodes renamed with <code>tree_add_nodelabels()</code>.</p>
</dd>
<dt>matched_calibrations</dt>
<dd>
<p>A <code>matchedCalibrations</code> object, which is the input <code>calibrations</code>
object with two additional columns storing results from the mrca search with
<code>phytools::findMRCA()</code>: <code style="white-space: pre;">⁠$mrca_node_number⁠</code> and <code style="white-space: pre;">⁠$mrca_node_name⁠</code>.</p>
</dd>
</dl>
</div>