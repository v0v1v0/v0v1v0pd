<div class="container">

<table style="width: 100%;"><tr>
<td>Pnm_all</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The exact distribution of the number of alleles in a m-person DNA mixture</h2>

<h3>Description</h3>

<p>Computes the exact distribution of the number of alleles in a <code class="reqn">m</code>-person DNA
mixture typed with STR loci. For a m-person DNA mixture it is possible to
observe <code class="reqn">1,\ldots,2\times m \times L</code> alleles, where <code class="reqn">L</code> is 
the total number of typed STR loci. The method allows incorporation of the 
subpopulation correction, the so-called <code class="reqn">\theta</code>-correction, to adjust 
for shared ancestry. If needed, the locus-specific probabilities can be obtained using the
<code>locuswise</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Pnm_all(m, theta, probs, locuswise = FALSE)
Pnm_locus(m, theta, alleleProbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The number of contributors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The coancestery coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>List of vectors with allele probabilities for each locus</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locuswise</code></td>
<td>
<p>Logical. If <code>TRUE</code> the locus-wise probabilities will be
returned. Otherwise, the probability over all loci is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleleProbs</code></td>
<td>
<p>Vectors with allele probabilities</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the exact distribution of the number of alleles for a m-person DNA
mixture.
</p>


<h3>Value</h3>

<p>Returns a vector of probabilities, or a matrix of locuswise
probability vectors.
</p>


<h3>Author(s)</h3>

<p>Torben Tvedebrink, James Curran, Mikkel Andersen
</p>


<h3>References</h3>

<p>T. Tvedebrink (2014). 'On the exact distribution of the number of 
alleles in DNA mixtures', International Journal of Legal Medicine; 128(3):427â€“37. 
&lt;https://doi.org/10.1007/s00414-013-0951-3&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## Simulate some allele frequencies:
  freqs &lt;-  structure(replicate(10, { g = rgamma(n = 10, scale = 4, shape = 3); 
                                      g/sum(g)
                                    },
              simplify = FALSE), .Names = paste('locus', 1:10, sep = '.'))

  ## Compute \eqn{\Pr(N(m = 3) = n)}, \eqn{n = 1,\ldots,2 * L *m}, where \eqn{L = 10}
  ## here
  Pnm_all(m = 2, theta = 0, freqs)
  ## Same, but locuswise results
  Pnm_all(m = 2, theta = 0, freqs, locuswise = TRUE)
  
</code></pre>


</div>