<div class="container">

<table style="width: 100%;"><tr>
<td>add_expression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add count and normalised expression values to a dataset</h2>

<h3>Description</h3>

<p>Add count and normalised expression values to a dataset
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_expression(
  dataset,
  counts,
  expression,
  feature_info = NULL,
  expression_future = NULL,
  ...
)

is_wrapper_with_expression(dataset)

get_expression(dataset, expression_source = "expression")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>A dataset created by <code>wrap_data()</code> or <code>wrap_expression()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>The counts values of genes (columns) within cells (rows). This can be both a dense and sparse matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression</code></td>
<td>
<p>The normalised expression values of genes (columns) within cells (rows). This can be both a dense and sparse matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_info</code></td>
<td>
<p>Optional meta-information of the features, a dataframe with at least <em>feature_id</em> as column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression_future</code></td>
<td>
<p>Projected expression using RNA velocity of genes (columns) within cells (rows).  This can be both a dense and sparse matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra information to be stored in the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expression_source</code></td>
<td>
<p>The source of expression, can be "counts", "expression", an expression matrix, or another dataset which contains expression</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dynwrap object with the expression added.
</p>


<h3>Examples</h3>

<pre><code class="language-R">cell_ids &lt;- c("A", "B", "C")
counts &lt;- matrix(sample(0:10, 3*10, replace = TRUE), nrow = 3)
rownames(counts) &lt;- cell_ids
colnames(counts) &lt;- letters[1:10]
expression &lt;- log2(counts + 1)

dataset &lt;- wrap_data(id = "my_awesome_dataset", cell_ids = cell_ids)
dataset &lt;- add_expression(dataset, counts = counts, expression = expression)

str(dataset$expression)
str(dataset$counts)

</code></pre>


</div>