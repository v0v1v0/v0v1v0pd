<div class="container">

<table style="width: 100%;"><tr>
<td>PowerPoint Interface</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add Slides, Insert Texts and Plots to PowerPoint
</h2>

<h3>Description</h3>

<p>A couple of functions to get R-stuff into MS-Powerpoint.
</p>
<p><code>GetNewPP()</code> starts a new instance of PowerPoint and returns its handle. A new presentation with one empty slide will be created thereby. The handle is needed for addressing the presentation afterwards.<br><code>GetCurrPP()</code> will look for a running PowerPoint instance and return its handle. <code>NULL</code> is returned if nothing's found.
<code>PpAddSlide()</code> inserts a new slide into the active
presentation.<br><code>PpPlot()</code> inserts the active plot into PowerPoint. The image is transferred by saving the picture to a file in R and
inserting the file in PowerPoint. The format of the plot can be selected, as well as crop options and the
size factor for inserting.<br><code>PpText()</code> inserts a new textbox with given text and box properties.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GetNewPP(visible = TRUE, template = "Normal")
GetCurrPP()

PpAddSlide(pos = NULL, pp = DescToolsOptions("lastPP"))

PpPlot(type = "png", crop = c(0, 0, 0, 0), picscale = 100, x = 1, y = 1,
       height = NA, width = NA, res=200, dfact=1.6, pp = DescToolsOptions("lastPP"))

PpText(txt, x = 1, y = 1, height = 50, width = 100, fontname = "Calibri", fontsize = 18,
       bold = FALSE, italic = FALSE, col = "black", bg = "white",
       hasFrame = TRUE, pp = DescToolsOptions("lastPP"))

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>visible</code></td>
<td>
<p>logical, should PowerPoint made visible by <code>GetNewPP()</code>? Defaults to TRUE.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>the name of the template to be used for the new presentation.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>position of the new inserted slide within the presentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the format for the picture file, default is <code>"png"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crop</code></td>
<td>
<p>crop options for the picture, defined by a 4-elements-vector. The first element is the bottom side, the second the left and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>picscale</code></td>
<td>
<p>scale factor of the picture in percent, default ist 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>left/upper xy-coordinate for the plot or for the textbox.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>height in cm, this overrides the picscale if both are given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width in cm, this overrides the picscale if both are given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>resolution for the png file, defaults to 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfact</code></td>
<td>
<p>the size factor for the graphic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt</code></td>
<td>
<p>text to be placed in the textbox</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontname</code></td>
<td>
<p>used font for textbox</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize</code></td>
<td>
<p>used fontsize for textbox</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bold</code></td>
<td>
<p>logic. Text is set bold if this is set to <code>TRUE</code> (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>italic</code></td>
<td>
<p>logic. Text is set italic if this is to <code>TRUE</code> (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>font color, defaults to <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>background color for textboxdefaults to <code>"white"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hasFrame</code></td>
<td>
<p>logical. Defines if a textbox is to be framed. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>the pointer to a PowerPoint instance, can be a new one, created by <code>GetNewPP()</code> or
the last created by <code>DescToolsOptions("lastPP")</code> (default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See PowerPoint-objectmodel for further informations.

</p>


<h3>Value</h3>

<p>The functions return the pointer to the created object.
</p>


<h3>Author(s)</h3>

<p>Andri Signorell &lt;andri@signorell.net&gt;
</p>


<h3>See Also</h3>

<p><code>WrdPlot</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: # Windows-specific example

# let's have some graphic
plot(1,type="n", axes=FALSE, xlab="", ylab="", xlim=c(0,1), ylim=c(0,1))
rect(0,0,1,1,col="black")
segments(x0=0.5, y0=seq(0.632,0.67, length.out=100),
  y1=seq(0.5,0.6, length.out=100), x1=1, col=rev(rainbow(100)))
polygon(x=c(0.35,0.65,0.5), y=c(0.5,0.5,0.75), border="white",
  col="black", lwd=2)
segments(x0=0,y0=0.52, x1=0.43, y1=0.64, col="white", lwd=2)
x1 &lt;- seq(0.549,0.578, length.out=50)
segments(x0=0.43, y0=0.64, x1=x1, y1=-tan(pi/3)* x1 + tan(pi/3) * 0.93,
  col=rgb(1,1,1,0.35))


# get a handle to a new PowerPoint instance
pp &lt;- GetNewPP()
# insert plot with a specified height
PpPlot(pp=pp,  x=150, y=150, height=10, width=10)

PpText("Remember?\n", fontname="Arial", x=200, y=70, height=30, fontsize=14,
       bold=TRUE, pp=pp, bg="lemonchiffon", hasFrame=TRUE)

PpAddSlide(pp=pp)
# crop the picture
pic &lt;- PpPlot(pp=pp, x=1, y=200, height=10, width=10, crop=c(9,9,0,0))
pic


# some more automatic procedure
pp &lt;- GetNewPP()
PpText("Hello to my presentation", x=100, y=100, fontsize=32, bold=TRUE,
       width=300, hasFrame=FALSE, col="blue", pp=pp)

for(i in 1:4){
  barplot(1:4, col=i)
  PpAddSlide(pp=pp)
  PpPlot(height=15, width=21, x=50, y=50, pp=pp)
  PpText(gettextf("This is my barplot nr %s", i), x=100, y=10, width=300, pp=pp)
}

## End(Not run)
</code></pre>


</div>