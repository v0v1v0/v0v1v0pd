<div class="container">

<table style="width: 100%;"><tr>
<td>qqplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Methods for Function qqplot in Package ‘distrMod’</h2>

<h3>Description</h3>

<p>We generalize function <code>qqplot</code> from package <span class="pkg">stats</span> to
be applicable to distribution and probability model objects, as well as
to estimate objects. In this context,
<code>qqplot</code> produces a QQ plot of data (argument <code>x</code>) against
a (model) distribution. If the second argument is of class <code>'Estimate'</code>,
<code>qqplot</code> looks at the <code>estimate.call</code>-slot and checks whether
it can use an argument <code>ParamFamily</code> to conclude on the model
distribution. Graphical parameters may be given as arguments to
<code>qqplot</code>.
In all title and label arguments, if <code>withSubst</code> is <code>TRUE</code>,
the following patterns are substituted:
</p>

<dl>
<dt><code>"%C"</code></dt>
<dd>
<p>class of argument <code>x</code></p>
</dd>
<dt><code>"%A"</code></dt>
<dd>
<p>deparsed argument <code>x</code></p>
</dd>
<dt><code>"%D"</code></dt>
<dd>
<p>time/date-string when the plot was generated</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">qqplot(x, y, ...)
## S4 method for signature 'ANY,UnivariateDistribution'
qqplot(x,y,
    n = length(x), withIdLine = TRUE,
    withConf = TRUE, withConf.pw  = withConf, withConf.sim = withConf,
    plot.it = TRUE, datax = FALSE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)),
    ..., width = 10, height = 5.5, withSweave = getdistrOption("withSweave"),
    mfColRow = TRUE, n.CI = n, with.lab = FALSE, lab.pts = NULL, which.lbs = NULL,
    which.Order = NULL, which.nonlbs = NULL, attr.pre = FALSE, order.traf = NULL,
    col.IdL = "red", lty.IdL = 2, lwd.IdL = 2, alpha.CI = .95,
    exact.pCI = (n&lt;100), exact.sCI = (n&lt;100), nosym.pCI = FALSE,
    col.pCI = "orange", lty.pCI = 3, lwd.pCI = 2, pch.pCI = par("pch"),
    cex.pCI = par("cex"),
    col.sCI = "tomato2", lty.sCI = 4, lwd.sCI = 2, pch.sCI = par("pch"),
    cex.sCI = par("cex"), added.points.CI = TRUE,
    cex.pch = par("cex"), col.pch = par("col"),
    cex.pts = 1, col.pts = par("col"), pch.pts = 19,
    cex.npts = 1, col.npts = grey(.5), pch.npts = 20,
    cex.lbs = par("cex"), col.lbs = par("col"), adj.lbs = par("adj"),
    alpha.trsp = NA, jit.fac = 0, jit.tol = .Machine$double.eps,
    check.NotInSupport = TRUE, col.NotInSupport = "red",
    with.legend = TRUE, legend.bg = "white",
    legend.pos = "topleft", legend.cex = 0.8, 
    legend.pref = "", legend.postf = "",  legend.alpha = alpha.CI,
    debug = FALSE, withSubst = TRUE)
## S4 method for signature 'ANY,ProbFamily'
qqplot(x, y,
   n = length(x), withIdLine = TRUE, withConf = TRUE,
   withConf.pw  = withConf,  withConf.sim = withConf,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ...)
## S4 method for signature 'ANY,Estimate'
qqplot(x, y,
   n = length(x), withIdLine = TRUE, withConf = TRUE,
   withConf.pw  = withConf,  withConf.sim = withConf,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data to be checked for compatibility with distribution/model <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>object of class <code>"UnivariateDistribution"</code> or of
class <code>"ProbFamily"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; assumed sample size (by default length of <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withIdLine</code></td>
<td>
<p>logical; shall line <code>y = x</code> be plotted in?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf</code></td>
<td>
<p>logical; shall confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.pw</code></td>
<td>
<p>logical; shall pointwise confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.sim</code></td>
<td>
<p>logical; shall simultaneous confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical; shall be plotted at all (inherited from
<code>qqplot</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datax</code></td>
<td>
<p>logical; shall data be plotted on x-axis?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters for method <code>qqplot</code> with signature
<code>ANY,UnivariateDistribution</code> or with function <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width (in inches) of the graphics device opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>height (in inches) of the graphics device opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withSweave</code></td>
<td>
<p>logical: if <code>TRUE</code> (for working with <code>Sweave</code>)
no extra device is opened and height/width are not set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfColRow</code></td>
<td>
<p>shall default partition in panels be used — defaults to <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.CI</code></td>
<td>
<p>numeric; number of points to be used for confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.lab</code></td>
<td>
<p>logical; shall observation labels be plotted in?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.pts</code></td>
<td>
<p>character or <code>NULL</code>; observation labels to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attr.pre</code></td>
<td>
<p>logical; do graphical attributes for plotted data refer
to indices prior (<code>TRUE</code>) or posterior to selection
via arguments <code>which.lbs</code>, <code>which.Order</code>, <code>which.nonlbs</code>
(<code>FALSE</code>)? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.lbs</code></td>
<td>
<p>integer or <code>NULL</code>; which observations shall be labelled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.Order</code></td>
<td>
<p>integer or <code>NULL</code>; which of the ordered (remaining)
observations shall be labelled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.nonlbs</code></td>
<td>
<p>indices of the observations which should be plotted but
not labelled; either an integer vector with the indices of the observations
to be plotted into graph or <code>NULL</code> — then all non-labelled
observations are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.traf</code></td>
<td>
<p>function or <code>NULL</code>; an optional trafo by which the
observations are ordered (as order(trafo(obs)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.IdL</code></td>
<td>
<p>color for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.IdL</code></td>
<td>
<p>line type for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.IdL</code></td>
<td>
<p>line width for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.CI</code></td>
<td>
<p>confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.pCI</code></td>
<td>
<p>logical; shall pointwise CIs be determined with exact
Binomial distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.sCI</code></td>
<td>
<p>logical; shall simultaneous CIs be determined with
exact Kolmogorov distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym.pCI</code></td>
<td>
<p>logical; shall we use (shortest) asymmetric CIs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pCI</code></td>
<td>
<p>color for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.pCI</code></td>
<td>
<p>line type for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.pCI</code></td>
<td>
<p>line width for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in
pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sCI</code></td>
<td>
<p>color for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.sCI</code></td>
<td>
<p>line type for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.sCI</code></td>
<td>
<p>line width for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.sCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.sCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in
simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>added.points.CI</code></td>
<td>
<p>logical; should CIs be plotted through additional points
(and not only through data points)? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pch</code></td>
<td>
<p>magnification factor for the plotted symbols (for backward
compatibility); it is ignored once <code>col.pts</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pch</code></td>
<td>
<p>color for the plotted symbols (for backward compatibility); it is
ignored once <code>col.pts</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pts</code></td>
<td>
<p>size of the points of the second argument plotted, can be a vector;
if argument <code>attr.pre</code> is <code>TRUE</code>, it is recycled to the length
of all observations and determines the sizes of all plotted symbols,
i.e., the selection is done within this argument; in this case argument
<code>col.npts</code> is ignored. If <code>attr.pre</code> is <code>FALSE</code>,
<code>cex.pts</code> is recycled to the number of the observations selected
for labelling and refers to the index ordering after the
selection. Then argument <code>cex.npts</code> deteremines the sizes
of the shown but non-labelled observations as given in argument
<code>which.nonlbs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pts</code></td>
<td>
<p>color of the points of the second argument plotted, can
be a vector as in <code>cex.pts</code> (with <code>col.npts</code> as counterpart).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pts</code></td>
<td>
<p>symbol of the points of the second argument plotted, can
be a vector as in <code>cex.pts</code> (with <code>pch.npts</code> as counterpart).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.npts</code></td>
<td>
<p>color of the non-labelled points of the <code>data</code> argument
plotted; (may be a vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.npts</code></td>
<td>
<p>symbol of the non-labelled points of the <code>data</code> argument
plotted (may be a vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.npts</code></td>
<td>
<p>size of the non-labelled points of the <code>data</code> argument
plotted (may be a vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lbs</code></td>
<td>
<p>magnification factor for the plotted observation labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lbs</code></td>
<td>
<p>color for the plotted observation labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.lbs</code></td>
<td>
<p>adj parameter for the plotted observation labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.trsp</code></td>
<td>
<p>alpha transparency to be added ex post to colors
<code>col.pch</code> and <code>col.lbs</code>; if one-dim and NA all colors are
left unchanged. Otherwise, with usual recycling rules <code>alpha.trsp</code>
gets shorted/prolongated to length the data-symbols to be plotted.
Coordinates of this vector <code>alpha.trsp</code> with NA are left unchanged,
while for the remaining ones, the alpha channel in rgb space is set
to the respective coordinate value of <code>alpha.trsp</code>. The non-NA
entries must be integers in [0,255] (0 invisible, 255 opaque).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jit.fac</code></td>
<td>
<p>jittering factor used for discrete distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jit.tol</code></td>
<td>
<p>threshold for jittering: if distance between points is smaller
than <code>jit.tol</code>, points are considered replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.NotInSupport</code></td>
<td>
<p>logical; shall we check if all <code>x</code>-quantiles lie
in <code>support(y)</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.NotInSupport</code></td>
<td>
<p>logical; if preceding check <code>TRUE</code> color of
<code>x</code>-quantiles if not in <code>support(y)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>logical; shall a legend be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.bg</code></td>
<td>
<p>background color for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p>position for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>
<p>magnification factor for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pref</code></td>
<td>
<p>character to be prepended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.postf</code></td>
<td>
<p>character to be appended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.alpha</code></td>
<td>
<p>nominal coverage probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical; if <code>TRUE</code> additional output to debug confidence bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withSubst</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) pattern substitution for
titles and axis lables is used; otherwise no substitution is used. </p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>qqplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "UnivariateDistribution")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of distribution <code>y</code>.</p>
</dd>
<dt>qqplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "ProbFamily")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of the model distribution of model <code>y</code>. Passed through
the <code>...</code> argument, all arguments valid for
<code>signature(x = "ANY", y = "UnivariateDistribution")</code>
are also valid for this signature.</p>
</dd>
<dt>qqplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "Estimate")</code>:
produces a QQ plot of a dataset <code>x</code> against the theoretical
quantiles of the model distribution of the model that can be reconstructed
from the estimator <code>y</code>; more specifically, it tries to get hand at the
argument <code>'ParamFamily'</code> of the esimator's call; if this is available,
internally this model is shifted to the estimated parameter by a call to
<code>modifyModel</code>, and then this shifted model is used in a call to the
<code>(x = "ANY", y = "UnivariateDistribution")</code>-method. Passed through
the <code>...</code> argument, all arguments valid for
<code>signature(x = "ANY", y = "UnivariateDistribution")</code>
are also valid for this signature.</p>
</dd>
</dl>
<h3>Value</h3>

<p>As for function <code>qqplot</code> from package <span class="pkg">stats</span>: a
list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The x coordinates of the points that were/would be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The corresponding quantiles of the second distribution,
<em>including <code>NA</code>s</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>A matrix with the lower and upper confidence bounds
(computed by <code>qqbounds</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>logical vector of length 2.</p>
</td>
</tr>
</table>
<p>(elements <code>crit</code> and <code>err</code> are taken from the return
value(s) of <code>qqbounds</code>).
</p>


<h3>Author(s)</h3>

<p>Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code>qqplot</code> from package <span class="pkg">stats</span> – the standard QQ plot
function,  <code>qqplot</code> from package <span class="pkg">distr</span> for
comparisons of distributions, and
<code>qqbounds</code>, used by <code>qqplot</code> to produce confidence
intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x &lt;- rnorm(40,mean=15,sd=30)
qqplot(x, Chisq(df=15))
NF &lt;- NormLocationScaleFamily(mean=15, sd=30)
qqplot(x, NF, with.lab=TRUE, which.Order=1:5, cex.lbs=1.3)
mlE &lt;- MLEstimator(x, NF)
qqplot(x, mlE)
</code></pre>


</div>