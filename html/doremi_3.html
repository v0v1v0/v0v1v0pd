<div class="container">

<table style="width: 100%;"><tr>
<td>calculate.fda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of derivatives using the Functional Data Analysis (FDA) method.</h2>

<h3>Description</h3>

<p><code>calculate.fda</code> estimates the derivatives of a variable using the FDA
method described in several sources, such as in doi: <a href="https://doi.org/10.1007/b98888">10.1007/b98888</a>Ramsay et al. (2009)
and  doi: <a href="https://doi.org/10.1080/00273171.2015.1123138">10.1080/00273171.2015.1123138</a>Chow et al. (2016).
This method estimates a spline function that fits all the data points and then derivates this function to estimate derivatives at those points.
In order for the derivatives to exist, the function must be smooth. A roughness penalty function controlled by a smoothing parameter is then used.
The estimations are done by using the R's base smooth.spline function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate.fda(signal, time, spar = NULL, order = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p>is a vector containing the data from which the derivative is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>is a vector containing the time values corresponding to the signal. Arguments signal and time must have the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spar</code></td>
<td>
<p>is the smoothing parameter used by the roughness penalty function in the smooth.spline R function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>parameter not used, for consistency with calculate.glla and calculate.gold</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing two elements:
</p>
<p>dtime- contains the initial time values provided.
</p>
<p>dsignal- is a data.frame containing three columns and the same number of rows as the signal.
The first column is the signal data points, the second is the first derivative evaluated at those points,
and the third is the second derivative evaluated at those points.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#In the following example the derivatives for the function y(t) = t^2 are calculated.
#The expected results are:
#y'(t) = 2t and y''(t) = 2
time &lt;- c(1:500)/100
signal &lt;- time^2
result &lt;- calculate.fda(signal = signal, time = time)

</code></pre>


</div>