<div class="container">

<table style="width: 100%;"><tr>
<td>fourierAnalysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract seasonal signal from time series </h2>

<h3>Description</h3>

<p>The fast Fourier transform is used to extract the seasonal signal of a time series.  The significant frequencies are found from among periods of length 2-, 3-, 4-, 6-, 12-, and 18-months.  
</p>
<p>The signal may be specified as stationary or non-stationary.  If a non-stationary fit is allowed, simple linear regression estimates the long term linear trend.   The seasonal signal is calculcated from the residuals.
</p>
<p>Predicted flow (and corresponding residual) at each time point is calculated from seasonal signal and, if non-stationary, long term trend coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fourierAnalysis(x, stationary=F)
## S3 method for class 'ssignal'
 plot(x, plot.type="hydrograph", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> An object of class <code>streamflow</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p> Logical; defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p> Indicates the type of plot to create.  The default "hydrograph" produces a plot of ordinary day and log normalized discharge, with the seasonal signal overlaid.  "auto.corr" produces a plot of daily autocorrelation as calculated from the residual flows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>ssignal</code> with items
</p>
<table>
<tr style="vertical-align: top;">
<td><code>signal</code></td>
<td>
<p> Data matrix augmented to included predicted and residual values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p> Matrix containing amplitude, phase, and frequency of seasonal signal.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend.fit</code></td>
<td>
<p> An <code>lm</code> object from regression of discharge on index of observation.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logps.regression</code></td>
<td>
<p> An <code>lm</code> object from regression of log power spectrum on log frequency (where log frequencies have seasonal signal removed.) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rms</code></td>
<td>
 <p><code>list</code> containing RMS amplitude for noise, RMS amplitude for signal, and signal-to-noise ratio. </p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(sycamore)
sycamore.flows&lt;-asStreamflow(sycamore,river.name="Sycamore Creek")
syc.seas&lt;-fourierAnalysis(sycamore.flows)
summary(syc.seas)
</code></pre>


</div>