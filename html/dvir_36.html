<div class="container">

<table style="width: 100%;"><tr>
<td>mergePM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identity and merge matching PM samples</h2>

<h3>Description</h3>

<p>Computes the direct matching LR of each pair of samples, and merges the
matching samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mergePM(
  pm,
  threshold = 10000,
  method = c("mostcomplete", "first", "combine"),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pm</code></td>
<td>
<p>A list of typed singletons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>LR threshold for positive identification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A keyword indicating how to merging matching samples. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The available methods for merging matched samples are:
</p>

<ul>
<li>
<p> "mostcomplete": Use the sample with the highest number of non-missing genotypes
</p>
</li>
<li>
<p> "first": Use the first in each group, according to the input order
</p>
</li>
<li>
<p> "combine": Not implemented yet.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list with the following entries:
</p>

<ul>
<li> <p><code>groups</code>: A list containing the groups of matching samples.
</p>
</li>
<li> <p><code>LRmat</code>: A symmetric matrix (with 0s on the diagonal) containing the direct
matching LR values.
</p>
</li>
<li> <p><code>nonmissing</code>: A named vector reporting the number of non-missing genotypes
for each sample.
</p>
</li>
<li> <p><code>pmReduced</code>: A list of singletons. If <code>use</code> is "best" or "first", this is
a subset of the input <code>pm</code>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>directMatch()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
pm = singletons(c("V1", "V2", "V3")) |&gt; 
  addMarker(V1 = "1/1", V2 = "2/2", V3 = "1/1", 
            afreq = c("1" = 0.01, "2" = 0.99), name = "L1")

mergePM(pm)

</code></pre>


</div>