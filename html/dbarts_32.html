<div class="container">

<table style="width: 100%;"><tr>
<td>dbartsSampler-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "dbartsSampler" of Discrete Bayesian Additive Regression Trees Sampler</h2>

<h3>Description</h3>

<p>A reference class object that contains a Bayesian Additive Regression Trees sampler in such a way that it can be modified, stopped, and started all while maintaining its own state.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'dbartsSampler'
run(numBurnIn, numSamples, updateState = NA)
## S4 method for signature 'dbartsSampler'
sampleTreesFromPrior(updateState = NA)
## S4 method for signature 'dbartsSampler'
sampleNodeParametersFromPrior(updateState = NA)
## S4 method for signature 'dbartsSampler'
copy(shallow = FALSE)
## S4 method for signature 'dbartsSampler'
show()
## S4 method for signature 'dbartsSampler'
predict(x.test, offset.test)
## S4 method for signature 'dbartsSampler'
setControl(control)
## S4 method for signature 'dbartsSampler'
setModel(model)
## S4 method for signature 'dbartsSampler'
setData(data)
## S4 method for signature 'dbartsSampler'
setResponse(y, updateState = NA)
## S4 method for signature 'dbartsSampler'
setOffset(offset, updateScale = FALSE, updateState = NA)
## S4 method for signature 'dbartsSampler'
setSigma(sigma, updateState = NA)
## S4 method for signature 'dbartsSampler'
setPredictor(x, column, updateState = NA)
## S4 method for signature 'dbartsSampler'
setTestPredictor(x.test, column, updateState = NA)
## S4 method for signature 'dbartsSampler'
setTestPredictorAndOffset(x.test, offset.test, updateState = NA)
## S4 method for signature 'dbartsSampler'
setTestOffset(offset.test, updateState = NA)
## S4 method for signature 'dbartsSampler'
printTrees(treeNums)
## S4 method for signature 'dbartsSampler'
plotTree(
    treeNum, treePlotPars = c(
        nodeHeight = 12, nodeWidth = 40, nodeGap = 8),
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numBurnIn</code></td>
<td>

<p>A non-negative integer determining how many iterations the sampler should skip before storing results. If missing or <code>NA</code>, the default is filled in from the sampler's <code>control</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numSamples</code></td>
<td>

<p>A positive integer determining how many posterior samples should be returned. If missing or <code>NA</code>, the default is also filled in from the control object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateState</code></td>
<td>

<p>A logical determining if the local cache of the sampler's state should be updated after the completion of the run. If <code>NA</code>, the default is also filled in from the control object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shallow</code></td>
<td>

<p>A logical determining if the copy should retain the underlying data of the sampler (<code>TRUE</code>) or have its own copies (<code>FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>An object inheriting from <code>dbartsControl</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>An object inheriting from <code>dbartsModel</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An object inheriting from <code>dbartsData</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A numeric response vector of length equal to that with which the sampler was created.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A numeric predictor vector of length equal to that with which the sampler was created. Can be of a distinct number of rows for <code>setTestPredictor</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.test</code></td>
<td>

<p>A new matrix of test predictors, of the number of columns equal to that in the current model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>A numeric vector of length equal to that with which the sampler was created, or <code>NULL</code>. If <code>offset.test</code> was set from <code>offset</code>, will attempt to update that as well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateScale</code></td>
<td>

<p>Logical indicating whether BART's internal scale should update with the new offset. Should only be <code>TRUE</code> during burn-in.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset.test</code></td>
<td>

<p>A numeric vector of length equal to that of the test matrix, or <code>NULL</code>. Can be missing for <code>setTestPredictors</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Numeric vector of residual standard deviations, one for each chain.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>column</code></td>
<td>

<p>An integer or character string vector specifying which column/columns of the predictor matrix is to be replaced. If missing, the entire matrix is substituted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeNums</code></td>
<td>

<p>An integer vector listing the indices of the trees to print.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeNum</code></td>
<td>

<p>An integer listing the indices of the tree to plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treePlotPars</code></td>
<td>

<p>A named numeric vector containing the quantities <code>nodeHeight</code>, <code>nodeWidth</code>, and <code>nodeGap</code>, all of which control aspects of the resulting plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Extra arguments to <code>plot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code>dbartsSampler</code> is a mutable object which contains information pertaining to fitting a Bayesian additive regression tree model. The sampler is first created and then, in a separate instruction, run or modified. In this way, MCMC samplers can be constructed with BART components filling arbitrary roles.
</p>


<h4>Saving</h4>

<p><code>save</code>-ing and <code>load</code>ing a <code>dbarts</code> sampler for future use requires that R's serialization mechanism be able to access the state of the sampler which, for memory purposes, is only made available to R on request. To do this, one must “touch” the sampler's state object before saving, e.g. for the object <code>sampler</code>, execute <code>invisible(sampler$state)</code>. This is in addition to guaranteeing that the <code>state</code> object is not <code>NULL</code>, which can be done by setting the sampler's control to an object with <code>updateState</code> as <code>TRUE</code> or passing <code>TRUE</code> as the <code>updateState</code> argument to any of the sampler's applicable methods.
</p>



<h3>Value</h3>

<p>For <code>run</code>, a named-list with contents <code>sigma</code>, <code>train</code>, <code>test</code>, and <code>varcount</code>.
</p>
<p>For <code>setPredictor</code>, <code>TRUE</code>/<code>FALSE</code> depending on whether or not the operation was successful. The operation can fail if the new predictor results in a tree with an empty leaf-node. If only single columns were replaced, on the update is rolled-back so that the sampler remains in a valid state.
</p>
<p><code>predict</code> keeps the current test matrix in place and uses the current set of tree splits. This function has two use cases. The first is when <code>keepTrees</code> of <code>dbartsControl</code> is <code>TRUE</code>, in which case the sampler should be run to completion and the function can be used to interrogate the existing fit. When <code>keepTrees</code> is <code>FALSE</code>, the function can be used to obtain the likelihood as part of a proposed new set of covariates in a Metropolis-Hastings step in a full-Bayes sampler. This would typically be followed by a call to <code>setPredictor</code> if the step is accepted.
</p>


</div>