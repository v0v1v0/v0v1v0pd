<div class="container">

<table style="width: 100%;"><tr>
<td>DALSM_additive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extraction of the estimated additive terms in a <code>DALSM.object</code>
</h2>

<h3>Description</h3>

<p>Extract the estimated additive terms with their standard errors from a <code>DALSM.object</code> resulting from the fit of a <code>DALSM</code> model.
In addition to the estimated functions in the location and dispersion submodels, their values on a regular grid covering the observed covariate values
are reported together with credible intervals. The mean effective coverage of these pointwise credible intervals
for the additive terms with respect to given (optional) reference functions (such as the ones for the 'true' additive terms used
to generate data in a simulation study) can also be computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DALSM_additive(obj.DALSM, ngrid=101,
       true.loc=NULL, true.disp=NULL, ci.level=NULL,
       verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj.DALSM</code></td>
<td>
<p>a <code>DALSM.object</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>(optional) grid size of covariate values where the additive terms are calculated (default: 101).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.loc</code></td>
<td>
<p>(optional) list of functions containing the 'true' additive terms in the location sub-model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.disp</code></td>
<td>
<p>(optional) list of functions containing the 'true' additive terms in the dispersion sub-model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.level</code></td>
<td>
<p>(optional) level of credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating whether the computed corverages should be printed out (default: TRUE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns an invisible list containing:
</p>

<ul>
<li>
<p><code>J1</code> : <code style="white-space: pre;">⁠ ⁠</code>number of additive terms in the location sub-model.
</p>
</li>
<li>
<p><code>labels.loc</code> : <code style="white-space: pre;">⁠ ⁠</code>labels of the additive terms in the location sub-model.
</p>
</li>
<li>
<p><code>f.loc.grid</code> : <code style="white-space: pre;">⁠ ⁠</code>list of length <code>J1</code> with, for each additive term, a list of length 3 with elements 'x': a vector of <code>ngrid</code> values for the covariate ; 'y.mat': a matrix with 3 columns (est,low,up) giving the additive term and its pointwise credible region ; se: the standard error of the additive term on the x-grid.
</p>
</li>
<li>
<p><code>f.loc</code> : <code style="white-space: pre;">⁠ ⁠</code>a list of length <code>J1</code> with, for each additive term &lt;x&gt;, a list with f.loc$x: a function computing the additive term f.loc(x) for a given covariate value 'x' ; attributes(f.loc$x): support, label, range.
</p>
</li>
<li>
<p><code>se.loc</code> : <code style="white-space: pre;">⁠ ⁠</code>a list of length <code>J1</code> with, for each additive term &lt;x&gt;, a list with se.loc$x: a function computing the s.e. of f(x) for a given covariate value 'x' ; attributes(se.loc$x): support, label, range.
</p>
</li>
<li>
<p><code>coverage.loc</code> : <code style="white-space: pre;">⁠ ⁠</code>if <code>true.loc</code> is provided: a vector of length <code>J1</code> giving the average effective coverage of pointwise credible intervals for each of the additive terms in the location sub-model.
</p>
</li>
<li>
<p><code>J2</code> : <code style="white-space: pre;">⁠ ⁠</code>number of additive terms in the dispersion sub-model.
</p>
</li>
<li>
<p><code>labels.disp</code> : <code style="white-space: pre;">⁠ ⁠</code>labels of the additive terms in the dispersion sub-model.
</p>
</li>
<li>
<p><code>f.disp.grid</code> : <code style="white-space: pre;">⁠ ⁠</code>list of length <code>J2</code> with, for each additive term, a list of length 3 with elements 'x': a vector of <code>ngrid</code> values for the covariate ; 'y.mat': a matrix with 3 columns (est,low,up) giving the additive term and its pointwise credible region ; se: the standard error of the additive term on the x-grid.
</p>
</li>
<li>
<p><code>f.disp</code> : <code style="white-space: pre;">⁠ ⁠</code>a list of length <code>J2</code> with, for each additive term &lt;x&gt;, a list with f.disp$x: a function computing the additive term f.disp(x) for a given covariate value 'x' ; attributes(f.disp$x): support, label, range.
</p>
</li>
<li>
<p><code>se.disp</code> : <code style="white-space: pre;">⁠ ⁠</code>a list of length <code>J2</code> with, for each additive term &lt;x&gt;, a list with se.disp$x: a function computing the s.e. of f(x) for a given covariate value 'x' ; attributes(se.disp$x): support, label, range.
</p>
</li>
<li>
<p><code>coverage.disp</code> : <code style="white-space: pre;">⁠ ⁠</code>if &lt;true.disp&gt; is provided: a vector of length <code>J2</code> giving the average effective coverage of pointwise credible intervals for each of the additive terms in the dispersion sub-model.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. (2021). Fast Bayesian inference using Laplace approximations
in nonparametric double additive location-scale models with right- and
interval-censored data.
<em>Computational Statistics and Data Analysis</em>, 161: 107250.
&lt;doi:10.1016/j.csda.2021.107250&gt;
</p>


<h3>See Also</h3>

<p><code>DALSM.object</code>, <code>DALSM</code>, <code>print.DALSM</code>, <code>plot.DALSM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(DALSM)
data(DALSM_IncomeData)
resp = DALSM_IncomeData[,1:2]
fit = DALSM(y=resp,
            formula1 = ~twoincomes+s(age)+s(eduyrs),
            formula2 = ~twoincomes+s(age)+s(eduyrs),
            data = DALSM_IncomeData)
obj = DALSM_additive(fit)
str(obj)

## Visualize the estimated additive terms for Age
## ... in the location submodel
with(obj$f.loc.grid$age, matplot(x,y.mat,
                                 xlab="Age",ylab="f.loc(Age)",
                                 type="l",col=1,lty=c(1,2,2)))
## ... and in the dispersion submodel
with(obj$f.disp.grid$age, matplot(x,y.mat,
                                 xlab="Age",ylab="f.disp(Age)",
                                 type="l",col=1,lty=c(1,2,2)))
## Also report their values for selected age values
obj$f.loc$age(c(30,40,50)) ; obj$f.disp$age(c(30,40,50))
## ... together with their standard errors
obj$se.loc$age(c(30,40,50)) ; obj$se.disp$age(c(30,40,50))
</code></pre>


</div>