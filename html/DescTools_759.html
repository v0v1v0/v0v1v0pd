<div class="container">

<table style="width: 100%;"><tr>
<td>VarCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence Intervals for the Variance
</h2>

<h3>Description</h3>

<p>Calculates confidence intervals for the variance. Available approachs are the classical one using the ChiSquare distribution, a more robust version proposed by Bonett and the bootstrap options available in the package <code>boot</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VarCI(x, method = c("classic", "bonett", "norm", "basic", "stud", "perc", "bca"),
      conf.level = 0.95, sides = c("two.sided", "left", "right"),
      na.rm = FALSE, R = 999)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>vector of character strings representing the type of intervals required. The value should be any subset of the values <code>"classic"</code>, <code>"bonett"</code>, <code>"norm"</code>, <code>"basic"</code>,  <code>"stud"</code>,  <code>"perc"</code>,  <code>"bca"</code>.
See <code>boot.ci</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the interval.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sides</code></td>
<td>
<p>a character string specifying the side of the confidence interval, must be one of <code>"two.sided"</code> (default), <code>"left"</code> or <code>"right"</code>. You can specify just the initial letter. <code>"left"</code> would be analogue to a hypothesis of <code>"greater"</code> in a <code>t.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should missing values be removed? Defaults to FALSE.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap replicates. Usually this will be a single positive integer. For importance resampling, some resamples may use one set of weights and others use a different set of weights. In this case R would be a vector of integers where each component gives the number of resamples from each of the rows of weights.
See <code>boot</code>.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The confidence interval for the variance is very sensitive to non-normality in the data. Bonett (2006) has proposed an interval that is nearly exact when the data is normally distributed and provides good performance for moderately non-normal data.
See the references for the details.</p>


<h3>Value</h3>

<p>a numeric vector with 3 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwr.ci</code></td>
<td>
<p>lower bound of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upr.ci</code></td>
<td>
<p>upper bound of the confidence interval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andri Signorell &lt;andri@signorell.net&gt;

</p>


<h3>References</h3>

<p>Bonett (2006) Approximate Confidence Interval for Standard Deviation of Nonnormal Distributions, <em>Computational Statistics and Data Analysis</em>, Vol. 50, pp. 775 - 782.<br>
https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/sdconfli.htm (might be outdated)
</p>


<h3>See Also</h3>

<p><code>MeanCI</code>, <code>MedianCI</code>, <code>VarTest</code>, <code>Var</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">VarCI(d.pizza$price, na.rm=TRUE)
VarCI(d.pizza$price, conf.level=0.99, na.rm=TRUE)

x &lt;- c(14.816, 14.863, 14.814, 14.998, 14.965, 14.824, 14.884, 14.838, 14.916,
       15.021, 14.874, 14.856, 14.860, 14.772, 14.980, 14.919)
VarCI(x, conf.level=0.9)

# and for the standard deviation
sqrt(VarCI(x, conf.level=0.9))


# from Bonett's paper
# expected results:
# ------------------------------------
#  conf.lvl       sd      lci      uci
# ------------------------------------
#      90.0   0.5168   0.3592   0.9359
#      95.0   0.5168   0.3263   1.0841
#      99.0   0.5168   0.2607   1.5109

p &lt;- c(15.83, 16.01, 16.24, 16.42, 15.33, 15.44, 16.88, 16.31)
sqrt(VarCI(p, method="bonett", conf.level=0.9))
sqrt(VarCI(p, method="bonett"))
sqrt(VarCI(p, method="bonett", conf.level=0.99))

# some bootstrap intervals
VarCI(x, method="norm")
VarCI(x, method="perc")
VarCI(x, method="bca")
</code></pre>


</div>