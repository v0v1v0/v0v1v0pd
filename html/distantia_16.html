<div class="container">

<table style="width: 100%;"><tr>
<td>plotMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots distance matrices and least cost paths.</h2>

<h3>Description</h3>

<p>Plots the output matrices of <code>distanceMatrix</code> and <code>leastCostMatrix</code>, and superimposes the least cost path generated by <code>leastCostPath</code>. This functions relies on <code>image.plot</code> to plot a color scale along with the matrix plot, or <code>image</code> when a color scale is not needed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMatrix(
  distance.matrix = NULL,
  least.cost.path = NULL,
  plot.columns = NULL,
  plot.rows = NULL,
  legend = TRUE,
  color.palette = "divergent",
  path.color = "black",
  path.width = 1,
  margins = c(2,3,2,4),
  pdf.filename = NULL,
  pdf.width = 7,
  pdf.height = 4,
  pdf.pointsize = 12,
  rotate = FALSE
  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distance.matrix</code></td>
<td>
<p>numeric matrix or list of numeric matrices either produced by <code>distanceMatrix</code> or <code>leastCostMatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>least.cost.path</code></td>
<td>
<p>dataframe or list of fdataframes produced by <code>leastCostPath</code>. If a list, must have the same number of slots as <code>distance.matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.columns</code></td>
<td>
<p>number of columns of the output plot if the inputs are lists. If not provided, it is computed automatically by <code>n2mfrow</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.rows</code></td>
<td>
<p>number of rows of the output plot if the inputs are lists. If not provided, it is computed automatically by <code>n2mfrow</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>boolean. If <code>TRUE</code>, the plot is made with <code>image.plot</code>, and includes a color scale on the right side. If <code>FALSE</code>, the plot is made with <code>image</code>, and the color scale is omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>string defining the color palette to be used, or a color palette. Accepted strings are "divergent" (default), which uses a red-white-blue divergent palette produced by the code <code>colorRampPalette(rev(RColorBrewer::brewer.pal(9, "RdBu")))(100)</code>, and "viridis", which uses the default settings of the <code>viridis</code> function to generate the palette. Both settings are color-blind friendly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.color</code></td>
<td>
<p>string, color of the line representing the least cost path if <code>least.cost.path</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.width</code></td>
<td>
<p>line width (lwd) of the plotted path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>a numeric vector with four positions indicating the margins of each plotted matrix. Order of margins in this vector is: bottom, left, top, right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.filename</code></td>
<td>
<p>character string with the name, without extension, of the pdf to be written. If <code>NULL</code>, no pdf is written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.width</code></td>
<td>
<p>with in inches of the output pdf. Default value is 7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.height</code></td>
<td>
<p>height in inches of the output pdf. Default value is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.pointsize</code></td>
<td>
<p>base font size of the output pdf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>boolean, if <code>TRUE</code>, the matrix is rotated. Allows the user to plot the matrix axes in the desired direction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of dataframes if <code>least.cost.matrix</code> is a list, or a dataframe if <code>least.cost.matrix</code> is a matrix. The dataframe/s have the following columns:
</p>

<ul>
<li> <p><em>A</em> row/sample of one of the sequences.
</p>
</li>
<li> <p><em>B</em> row/sample of one the other sequence.
</p>
</li>
<li> <p><em>distance</em> distance between both samples, extracted from <code>distance.matrix</code>.
</p>
</li>
<li> <p><em>cumulative.distance</em> cumulative distance at the samples <code>A</code> and <code>B</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">

#loading data
data(sequenceA)
data(sequenceB)

#preparing datasets
AB.sequences &lt;- prepareSequences(
 sequence.A = sequenceA,
 sequence.A.name = "A",
 sequence.B = sequenceB,
 sequence.B.name = "B",
 merge.mode = "complete",
 if.empty.cases = "zero",
 transformation = "hellinger"
 )

#computing distance matrix
AB.distance.matrix &lt;- distanceMatrix(
 sequences = AB.sequences,
 grouping.column = "id",
 method = "manhattan",
 parallel.execution = FALSE
 )

#plot
plotMatrix(distance.matrix = AB.distance.matrix)

#viridis palette
plotMatrix(distance.matrix = AB.distance.matrix,
 color.palette = "viridis")

#custom palette
plotMatrix(distance.matrix = AB.distance.matrix,
color.palette = viridis::viridis(8, option = "B", direction = -1))



</code></pre>


</div>