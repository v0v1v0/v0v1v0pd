<div class="container">

<table style="width: 100%;"><tr>
<td>model.test.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Model Test</h2>

<h3>Description</h3>

<p>Simulate models of disparity change through time
</p>


<h3>Usage</h3>

<pre><code class="language-R">model.test.sim(
  sim = 1,
  model,
  model.rank = 1,
  alternative = "two-sided",
  time.split = NULL,
  time.span = 100,
  variance = 1,
  sample.size = 100,
  parameters = list(),
  fixed.optima = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>The number of separate simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Either (i) the named model of evolution to simulate for changes in disparity-through-time using a homogenous or hetergenous model (see list in <code>model.test</code>) or (ii) an object of class <code>dispRity</code> returned from <code>model.test</code> function. If a <code>dispRity</code> object is supplied, all remaining arguments apart from <code>sim</code> and <code>model.rank</code> and <code>alternative</code> are ignored as the model specified by the input model is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.rank</code></td>
<td>
<p>If a <code>dispRity</code> object is supplied, which model is used for simulation. The rank refers to the order of models as specified by AICc, so if <code>model.rank = 1</code> (default) the best-fitting model is used for simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>If the simulation is based on a <code>dispRity</code> object, what is the alternative hypothesis: can be <code>"two-sided"</code> (default), <code>"greater"</code> or <code>"lesser"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.split</code></td>
<td>
<p>The age of the change in mode. The age is measured as the time before the most recent sample, and multiple ages can be supplied in a vector. Note this only applies to heterogenous models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.span</code></td>
<td>
<p>The length of the sequence (<code>numeric</code>). If one number is supplied this is treated as the length of the sequence and the time span is treated as sequence from 0 to <code>time.span</code> in unit increments. If a vector of length &gt; 1 is supplied, this is treated as the the age of each sample in the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>The variance of each sample (<code>numeric</code>). If one number is supplied this is the variance for all samples in the sequence. If a vector of equal length to the <code>time.span</code> vector is supplied, this is used for the variance of each sample in the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.size</code></td>
<td>
<p>The sample size of each sample (<code>numeric</code>). If one number is supplied this is the sample size for all samples in the sequence. If a vector of equal length to the <code>time.span</code> vector is supplied, this is used for the sample size of each sample in the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A <code>list</code> of model parameters used for simulations. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.optima</code></td>
<td>
<p>A <code>logical</code> value, whether to use an estimated optimum value in OU models (<code>FALSE</code> - default), or whether to set the OU optimum to the ancestral value (<code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>DISCLAIMER: this function is working properly (i.e. it does what it is supposed to do), however, the interpretation of the results has not yet been thought through, discussed and peer-reviewed (what does a Brownian motion like disparity curve means biologically?).
</p>
<p>The <code>parameters</code> is a list of arguments to be passed to the models.
These arguments can be:
</p>

<ul>
<li>
<p><code>ancestral.state</code>, ancestral value of the disparity applicable to all models (default = <code>0.01</code>).
</p>
</li>
<li>
<p><code>sigma.squared</code>, rate of step variance to all models except Stasis (default = <code>1</code>).
</p>
</li>
<li>
<p><code>alpha</code>, strength of attraction to the optimum in OU models (default = <code>1</code>).
</p>
</li>
<li>
<p><code>optima.1</code>, the value of the optimum in a OU model, or the first bin optimum in a multi-OU model (default = <code>0.15</code>).
</p>
</li>
<li>
<p><code>optima.2</code>, the second bin optimum in a multi-OU model (default = <code>0.15</code>).
</p>
</li>
<li>
<p><code>optima.3</code>, the third bin optimum in a multi-OU model (default = <code>0.15</code>).
</p>
</li>
<li>
<p><code>theta.1</code>, the mean in a Stasis model, or the first bin mean in a multi-Stasis model (default = <code>1</code>).
</p>
</li>
<li>
<p><code>theta.2</code>, the second bin optimum in a multi-OU model (default = <code>1</code>).
</p>
</li>
<li>
<p><code>theta.3</code>, the third bin optimum in a multi-OU model (default = <code>1</code>).
</p>
</li>
<li>
<p><code>omega</code>, the variance in a Stasis model (default = <code>1</code>).
</p>
</li>
<li>
<p><code>trend</code>, the trend parameter in the Trend model (default = <code>0.5</code>).
</p>
</li>
<li>
<p><code>eb.rate</code>, the rate of exponential rate decrease in the EB model (default = <code>-0.1</code>).
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list of class <code>dispRity</code> and <code>model.sim</code>. Each list element contains the simulated central tendency, as well as the variance, sample size, and subsets used to simulate the data.
</p>


<h3>Author(s)</h3>

<p>Mark N Puttick and Thomas Guillerme
</p>


<h3>References</h3>

<p>Blomberg SP, Garland T Jr, &amp; Ives AR. 2003. Testing for phylogenetic signal in comparative data: behavioral traits are more labile. Evolution.  <b>57</b>, 717-745.
</p>
<p>Hansen TF. 1997. Stabilizing selection and the comparative analysis of adaptation. Evolution. <b>51</b>, 1341-1351.
</p>
<p>Harmon LJ, <em>et al</em>. 2010. Early bursts of body size and shape evolution are rare in comparative data. <b>64</b>, 2385-2396.
</p>
<p>Hunt G. 2006. Fitting and comparing models of phyletic evolution: random walks and beyond. Paleobiology. <b>32</b>, 578-601. DOI: 10.1666/05070.1.
</p>
<p>Hunt G, Hopkins MJ &amp; Lidgard S. 2015. Simple versus complex models of trait evolution and stasis as a response to environmental change. Proceedings of the National Academy of Sciences. <b>112</b>, 4885-4890. DOI: 10.1073/pnas.1403662111
</p>
<p>Felsenstein J. 1973. Maximum-likelihood estimation of evolutionary trees from continuous characters. American Journal of Human Genetics. <b>25</b>, 471-492.
</p>
<p>Felsenstein J. 1985. Phylogenies and the comparative method. The American Naturalist. <b>51</b>, 1-15.
</p>
<p>Murrell DJ. 2018. A global envelope test to detect non-random bursts of trait evolution. Methods in Ecology and Evolution. DOI: 10.1111/2041-210X.13006
</p>
<p>Citation for the envelope code:
</p>


<h3>See Also</h3>

<p><code>model.test</code>, <code>model.test.wrapper</code>, <code>summary.dispRity</code> and <code>plot.dispRity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Disparity through time data
data(BeckLee_disparity)

## List of models to test
models &lt;- list("Trend", "BM")

## Testing the models on the observed disparity
model_test_output &lt;- model.test(BeckLee_disparity, models, time.split = 66)
 
## simulations using the output from model.test
model_test_sim_output &lt;- model.test.sim(sim = 100, model= model_test_output)
 
## Plot the simulated best model
plot(model_test_sim_output)
## Add the observed data
plot(BeckLee_disparity, add = TRUE, col = c("pink", "#ff000050", "#ff000050"))

## Simulating a specific model with specific parameters parameters
model_simulation &lt;- model.test.sim(sim = 100, model = "BM", time.span = 120, variance = 0.1,
                                   sample.size = 100, parameters = list(ancestral.state = 0,
                                   sigma.squared = 0.1))

## Summarising the results
plot(model_simulation, main = "A simple Brownian motion")

## End(Not run)

</code></pre>


</div>