<div class="container">

<table style="width: 100%;"><tr>
<td>desplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the layout/data of a field experiment.</h2>

<h3>Description</h3>

<p>Use this function to plot the layout of a rectangular lattice
field experiment and also the observed data values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">desplot(
  data,
  form = formula(NULL ~ x + y),
  num = NULL,
  num.string = NULL,
  col = NULL,
  col.string = NULL,
  text = NULL,
  text.string = NULL,
  out1 = NULL,
  out1.string = NULL,
  out2 = NULL,
  out2.string = NULL,
  dq = NULL,
  dq.string = NULL,
  col.regions = RedGrayBlue,
  col.text = NULL,
  text.levels = NULL,
  out1.gpar = list(col = "black", lwd = 3),
  out2.gpar = list(col = "yellow", lwd = 1, lty = 1),
  at,
  midpoint = "median",
  ticks = FALSE,
  flip = FALSE,
  main = NULL,
  xlab,
  ylab,
  shorten = "abb",
  show.key = TRUE,
  key.cex,
  cex = 0.4,
  strip.cex = 0.75,
  subset = TRUE,
  gg = FALSE,
  ...
)

ggdesplot(
  data,
  form = formula(NULL ~ x + y),
  num = NULL,
  num.string = NULL,
  col = NULL,
  col.string = NULL,
  text = NULL,
  text.string = NULL,
  out1 = NULL,
  out1.string = NULL,
  out2 = NULL,
  out2.string = NULL,
  dq = NULL,
  dq.string = NULL,
  col.regions = RedGrayBlue,
  col.text = NULL,
  text.levels = NULL,
  out1.gpar = list(col = "black", lwd = 3),
  out2.gpar = list(col = "yellow", lwd = 1, lty = 1),
  at,
  midpoint = "median",
  ticks = FALSE,
  flip = FALSE,
  main = NULL,
  xlab,
  ylab,
  shorten = "abb",
  show.key = TRUE,
  key.cex,
  cex = 0.4,
  strip.cex = 0.75,
  subset = TRUE,
  gg = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>A formula like <code>yield~x*y|location</code>. Note x,y are numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use 
as a factor for number-coding the text in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.string</code></td>
<td>
<p>String name of the column of the data to use 
as a factor for number-coding the text in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use
for color-coding the text shown in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.string</code></td>
<td>
<p>String name of the column of the data to use
for color-coding the text shown in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use 
for the actual text shown in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.string</code></td>
<td>
<p>String name of the column of the data to use 
for the actual text shown in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out1</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use 
for first-level outlining around blocks of cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out1.string</code></td>
<td>
<p>String name of the column of the data to use 
for first-level outlining around blocks of cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out2</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use 
for second-level outlining around blocks of cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out2.string</code></td>
<td>
<p>String name of the column of the data to use 
for second-level outlining around blocks of cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dq</code></td>
<td>
<p>Bare name (no quotes) of the column of the data to use 
for indicating bad data quality with diagonal lines.
This can either be a numeric vector or a factor/text. 
Cells with 1/"Q"/"Questionable" have one diagonal line.
Cells with 2/"B"/"Bad","S","Suppressed" have crossed diagonal lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dq.string</code></td>
<td>
<p>String name of the column of the data to use 
for indicating bad data quality with diagonal lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.regions</code></td>
<td>
<p>Colors for the fill color of cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.text</code></td>
<td>
<p>Vector of colors for text strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.levels</code></td>
<td>
<p>Character strings to use instead of default 'levels'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out1.gpar</code></td>
<td>
<p>A list of graphics parameters for first-level outlining.
Can either be an ordinary <code>list()</code> or a call to <code>gpar()</code> from the
<code>grid</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out2.gpar</code></td>
<td>
<p>Graphics parameters for second-level of outlining.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>Breakpoints for the color ribbon.  Use this instead of 'zlim'.
Note: using 'at' causes 'midpoint' to be set to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midpoint</code></td>
<td>
<p>Method to find midpoint of the color ribbon.
One of 'midrange', 'median, or a numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticks</code></td>
<td>
<p>If TRUE, show tick marks along the bottom and left sides.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>If TRUE, vertically flip the image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shorten</code></td>
<td>
<p>Method for shortening text in the key, either 'abb', 'sub', 'no', or FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.key</code></td>
<td>
<p>If TRUE, show the key on the left side. (This is not the ribbon.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key.cex</code></td>
<td>
<p>Left legend cex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Expansion factor for text/number in each cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.cex</code></td>
<td>
<p>Strip cex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An expression that evaluates to logical index vector for subsetting the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg</code></td>
<td>
<p>If TRUE, desplot() switches to ggdesplot().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To create the plot using lattice graphics: 
1. <code>desplot(...)</code>.
</p>
<p>To create the plot using ggplot2 graphics, use one of the following:
1. <code>ggdesplot(...)</code>.
2. <code>desplot(..., gg=TRUE)</code>. 
3. <code>options(desplot.gg=TRUE); desplot(...)</code>. 
Method 3 is useful to modify all results from existing scripts.
</p>
<p>The lattice version is complete, mature, and robust.
The ggplot2 version is incomplete.  The legend can only show colors, 
and some function arguments are ignored.
In general, lattice graphics are about 4-5 times faster than ggplot2 graphics.
Not all lattice parameters are passed down to <code>xyplot</code>, but it
is possible to make almost any change to the plot by assigning the
desplot object to a variable and then edit the object by hand or use
<code>update</code> to modify the object.  Then print it manually.  See the
first example below.
</p>
<p>Use <code>col.regions</code> to specify fill colors.  This can either be a vector
of colors or a function that produces a vector of colors.  If the response
variable is a factor and <code>col.regions</code> is a <em>function</em>, it will
be ignored and the cells are filled with default light-colored backgrounds
and a key is placed on the left.  If the response variable is
<em>numeric</em>, the cells are colored according to <code>col.regions</code>, and
a ribbon key is placed on the right.
</p>
<p>Use <code>shorten='abb'</code> (this is default) to shorten the cell text to 2
characters using the <code>abbreviate</code> function
Use <code>shorten='sub'</code> to use a 3-character substring.
Use <code>shorten='no'</code> or <code>shorten=FALSE</code> for no shortening.
</p>
<p>Note that two sub-plots with identical levels of the split-plot factor can
be adjacent to each other by virtue of appearing in different whole-plots.
To correctly outline the split-plot factor, simply concatenate the
whole-plot factor and sub-plot factor together.
</p>
<p>To get a map of a field with a true aspect ratio (lattice version only), 
include 'aspect=ylen/xlen'
in the call, where 'ylen' is the vertical length of the field and 'xlen'
is the horizontal length of the field.
</p>
<p>To call this function inside another function, you can hack like this:
vr &lt;- "yield"; vx &lt;- "x"; vy &lt;- "y";
eval(parse(text=paste("desplot(", vr, "~", vx, "*", vy, ", data=yates.oats)")))
</p>


<h3>Value</h3>

<p>A lattice or ggplot2 object
</p>


<h3>Author(s)</h3>

<p>Kevin Wright
</p>


<h3>References</h3>

<p>K. Ryder (1981).
Field plans: why the biometrician finds them useful.
<em>Experimental Agriculture</em>, 17, 243â€“256.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require(agridat)){

# Show how to customize any feature.  Here: make the strips bigger.
data(besag.met)
d1 &lt;- desplot(besag.met, 
              yield ~ col*row|county, 
              main="besag.met",
              out1=rep, out2=block, out2.gpar=list(col="white"), strip.cex=2)
d1 &lt;- update(d1, par.settings = list(layout.heights=list(strip=2)))
print(d1)

# Show experiment layout
data(yates.oats)
desplot(yates.oats, 
        yield ~ col+row, 
        out1=block, out2=gen)

desplot(yates.oats, 
        block ~ col+row, 
        col=nitro, text=gen, cex=1, out1=block,
        out2=gen, out2.gpar=list(col = "gray50", lwd = 1, lty = 1))

}
</code></pre>


</div>