<div class="container">

<table style="width: 100%;"><tr>
<td>NegativeBinomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a negative binomial distribution</h2>

<h3>Description</h3>

<p>A generalization of the geometric distribution. It is the number
of failures in a sequence of i.i.d. Bernoulli trials before
a specified target number (<code class="reqn">r</code>) of successes occurs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NegativeBinomial(size, p = 0.5, mu = size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>The target number of successes (greater than <code class="reqn">0</code>)
until the experiment is stopped. Denoted <code class="reqn">r</code> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The success probability for a given trial. <code>p</code> can be any
value in <code style="white-space: pre;">⁠[0, 1]⁠</code>, and defaults to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Alternative parameterization via the non-negative mean
of the distribution (instead of the probability <code>p</code>), defaults to <code>size</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We recommend reading this documentation on
<a href="https://alexpghayes.github.io/distributions3/">https://alexpghayes.github.io/distributions3/</a>, where the math
will render with additional detail and much greater clarity.
</p>
<p>In the following, let <code class="reqn">X</code> be a negative binomial random variable with
success probability <code>p</code> = <code class="reqn">p</code>.
</p>
<p><strong>Support</strong>: <code class="reqn">\{0, 1, 2, 3, ...\}</code>
</p>
<p><strong>Mean</strong>: <code class="reqn">\frac{(1 - p) r}{p} = \mu</code>
</p>
<p><strong>Variance</strong>: <code class="reqn">\frac{(1 - p) r}{p^2}</code>
</p>
<p><strong>Probability mass function (p.m.f.)</strong>:
</p>
<p style="text-align: center;"><code class="reqn">
     f(k) = {k + r - 1 \choose k} \cdot p^r (1-p)^k
  </code>
</p>

<p><strong>Cumulative distribution function (c.d.f.)</strong>:
</p>
<p>Omitted for now.
</p>
<p><strong>Moment generating function (m.g.f.)</strong>:
</p>
<p style="text-align: center;"><code class="reqn">
     \left(\frac{p}{1 - (1 -p) e^t}\right)^r, t &lt; -\log (1-p)
  </code>
</p>

<p><strong>Alternative parameterization</strong>: Sometimes, especially when used in
regression models, the negative binomial distribution is parameterized
by its mean <code class="reqn">\mu</code> (as listed above) plus the size parameter <code class="reqn">r</code>.
This implies a success probability of <code class="reqn">p = r/(r + \mu)</code>. This can
also be seen as a generalization of the Poisson distribution where the
assumption of equidispersion (i.e., variance equal to mean) is relaxed.
The negative binomial distribution is overdispersed (i.e., variance greater than mean)
and its variance can also be written as <code class="reqn">\mu + 1/r \mu^2</code>. The Poisson
distribution is then obtained as <code class="reqn">r</code> goes to infinity. Note that in this
view it is natural to also allow for non-integer <code class="reqn">r</code> parameters.
The factorials in the equations above are then expressed in terms of the
gamma function.
</p>


<h3>Value</h3>

<p>A <code>NegativeBinomial</code> object.
</p>


<h3>See Also</h3>

<p>Other discrete distributions: 
<code>Bernoulli()</code>,
<code>Binomial()</code>,
<code>Categorical()</code>,
<code>Geometric()</code>,
<code>HurdleNegativeBinomial()</code>,
<code>HurdlePoisson()</code>,
<code>HyperGeometric()</code>,
<code>Multinomial()</code>,
<code>Poisson()</code>,
<code>PoissonBinomial()</code>,
<code>ZINegativeBinomial()</code>,
<code>ZIPoisson()</code>,
<code>ZTNegativeBinomial()</code>,
<code>ZTPoisson()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(27)

X &lt;- NegativeBinomial(size = 5, p = 0.1)
X

random(X, 10)

pdf(X, 50)
log_pdf(X, 50)

cdf(X, 50)
quantile(X, 0.7)

## alternative parameterization of X
Y &lt;- NegativeBinomial(mu = 45, size = 5)
Y
cdf(Y, 50)
quantile(Y, 0.7)
</code></pre>


</div>