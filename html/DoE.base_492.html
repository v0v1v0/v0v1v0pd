<div class="container">

<table style="width: 100%;"><tr>
<td>lm and aov method for class design objects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>lm and aov methods for class design objects</h2>

<h3>Description</h3>

<p>Methods for automatic linear models for data frames of class design 
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm(formula, ...)
## Default S3 method:
lm(formula, data, subset, weights, na.action, method = "qr", 
    model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, 
    contrasts = NULL, offset, ...)
## S3 method for class 'design'
lm(formula, ..., response=NULL, degree=NULL, FUN=mean, 
    use.center=NULL, use.star=NULL, use.dummies=FALSE)
aov(formula, ...)
## Default S3 method:
aov(formula, data = NULL, projections = FALSE, qr = TRUE,
    contrasts = NULL, ...)
## S3 method for class 'design'
aov(formula, ..., response=NULL, degree=NULL, FUN=mean, 
    use.center=FALSE)
## S3 method for class 'lm.design'
print(x, ...)
## S3 method for class 'lm.design'
summary(object, ...)
## S3 method for class 'lm.design'
coef(object, ...)
## S3 method for class 'summary.lm.design'
print(x, ...)
## S3 method for class 'aov.design'
print(x, ...)
## S3 method for class 'aov.design'
summary(object, ...)
## S3 method for class 'summary.aov.design'
print(x, ...)
lm.design
summary.lm.design
aov.design
summary.aov.design
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> for the default method, cf. documentation for <code>lm</code> 
in package <span class="pkg">stats</span>;cr
for the class <code>design</code> method, a data frame of S3 class 
<code>design</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments to functions <code>lm</code>,
<code>print.lm</code> or <code>print.summary.lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p> character string giving the name of the response variable 
(must be among the responses of <code>x</code>; 
for wide format repeated measurement or parameter designs, 
<code>response</code> can also be among the column names of the <code>responselist</code> 
element of the <code>design.info</code> attribute) <br>
OR<br>
integer number giving the position of the response in element 
<code>response.names</code> of attribute <code>design.info</code>
</p>
<p>For the default <code>NULL</code>, the first available response variable 
is used; for wide format designs, this is an aggregation of the variables 
given in first column from the <code>responselist</code> 
element of the <code>design.info</code> attribute of <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p> degree for the formula; if <code>NULL</code>, 
the default for the <code>formula</code> method is used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p> function for the <code>aggregate.design</code> method; 
this must be an unquoted function name;<br>
This option is relevant for repeated measurement designs 
and parameter designs in long format only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.center</code></td>
<td>
 <p><code>NULL</code> or logical indicating whether center points are to be used +
in the analysis; <br>
if <code>NULL</code>, the default is FALSE for <code>pb</code> and <code>FrF2</code> designs with 
center points and TRUE for <code>ccd</code> designs; the option is irrelevant 
for all other design types.<br><code>FALSE</code> allows usage of simple analysis functions from package 
<code>FrF2-package</code> (e.g. function <code>IAPlot</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.star</code></td>
<td>
 <p><code>NULL</code> or logical indicating whether the star portion of a CCD design 
is to be used in the analysis (ignored for all other types of designs). <br>
The default TRUE analyses the complete design. Specifying FALSE permits interim analyses of 
the cube portion of a central composite design.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.dummies</code></td>
<td>
<p> logical indicating whether the error dummies of a Plackett Burman design 
are to be used in the formula (ignored for all other types of designs). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projections</code></td>
<td>
<p> logical indicating whether the projections should be returned;
for orthogonal arrays, these are helpful, as they provide the estimated 
deviation from the overall average attributed to each particular factor; 
it is not recommended to use them with unbalanced designs </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> object of class <code>lm</code> or <code>summary.lm</code>,<br> 
for <code>lm.default</code> like in <code>lm</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> object of class <code>lm.design</code> created by function <code>lm.design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm.design</code></td>
<td>
<p>a class that is identical in content to class <code>lm</code>; 
its purpose is to call a specific print method that provides slightly more 
detail than the standard printout for linear models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.lm.design</code></td>
<td>
<p>a class that is identical in content to class <code>summary.lm</code>; 
its purpose is to call a specific print method that provides slightly more 
detail than the standard summary for linear models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qr</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p> like in <code>lm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>aov</code> and <code>lm</code> methods for class <code>design</code> 
conduct a default linear model analysis for data frames of 
class <code>design</code> that do contain at least one response.
</p>
<p>The intention for providing default analyses is to support convenient quick inspections. 
In many cases, there will be good reasons to customize the analysis, for example by including 
some but not all effects of a certain degree. Also, it may be statistically more wise 
to work with mixed models for some types of design. <b>The default analyses must not 
be taken as a statistical recommendation!</b>
</p>
<p>The choice of default analyses 
has been governed by simplicity: It uses fixed effects only and does either 
main effects models (<code>degree=1</code>, default for <code>pb</code> and <code>oa</code> designs), 
models with main effects and 2-factor interactions (<code>degree=2</code>, 
default for most designs) or second order models (that contain 
quadratic effects in addition to the 2-factor interactions, unchangeable default 
for designs with quantitative variables). The <code>degree</code> parameter can be used 
to modify the degree of interactions. If blocks are 
present, the block main effect is always entered as a fixed effect without interactions. 
</p>
<p>Designs with center points are per default analysed without the center points; the main 
reason for this is convenient usage of functions <code>DanielPlot</code>, 
<code>MEPlot</code> and <code>IAPlot</code> from package <span class="pkg">FrF2</span>. 
With the <code>use.center</code> option, this default can be changed; in this case, significance 
of the center point indicator implies that there are one or more quadratic effect(s) 
in the model.
</p>
<p>Designs with repeated measurements (<code>repeat.only=TRUE</code>) and parameter 
designs of long format are treated by <code>aggregate.design</code> 
with aggregation function <code>FUN</code> (default: means are calculated) 
before applying a linear model.
</p>
<p>For designs with repeated measurements (<code>repeat.only=TRUE</code>) and parameter 
designs of wide format, the default is to use the first aggregated response, 
if the design has been aggregated already. For a so far unaggregated design, 
the default is to treat the design by <code>aggregate.design</code>, 
using the function <code>FUN</code> (default: mean) and then use the first response. 
The defaults can be overridden by specifying <code>response</code>: Here, 
<code>response</code> can not only be one of the current responses but also a column name 
of the <code>responselist</code> element of the <code>design.info</code> attribute of the 
design (i.e. a response name from the long version of the design).
</p>
<p>The implementation of the formulae is not done in functions <code>lm.design</code> or 
<code>aov.design</code> themselves 
but based on the method for function formula (<code>formula.design</code>).
</p>
<p>The <code>print</code> methods prepend the formula and the number of experimental runs 
underlying the analysis to the default printout. 
The purpose of this is meaningful output in case a call from 
inside function <code>lm.design</code> or <code>aov.design</code> 
(methods for functions <code>lm</code> and <code>aov</code> ) 
does not reveal enough information, and another pointer that center points have been 
omitted or repeated measurements aggregated over. The <code>coef</code> method for objects 
of class <code>lm.design</code> suppresses <code>NA</code> coefficients, i.e. 
returns valid coefficients only. For <code>aov</code> objects, this is the default 
anyway.
</p>


<h3>Value</h3>

<p>The value for the <code>lm</code> functions is a linear model object, 
exactly like for function <code>lm</code>, 
except for the added class <code>lm.design</code> in case of the method for class <code>design</code>, 
and an added list element <code>WholePlotEffects</code> for split plot designs.
</p>
<p>The value for the <code>aov</code> functions is an aov object, 
exactly like for function <code>aov</code>, 
and an added list element <code>WholePlotEffects</code> for split plot designs.
</p>
<p>The value of the <code>summary</code> functions for class <code>lm.design</code> and 
<code>aov.design</code> respectively
is a linear model or aov summary, exactly like documented in <code>summary.lm</code> 
or <code>summary.aov</code>, 
except for the added classes <code>summary.lm.design</code> or <code>summary.aov.design</code>, 
and an added list element <code>WholePlotEffects</code> (for <code>summary.lm.design</code>) 
or attribute (for <code>summary.aov.design</code>) for split plot designs.
</p>
<p>The print functions return <code>NULL</code>; they are used for their side effects only.
</p>


<h3>Warning</h3>

<p> The generics for <code>lm</code> and <code>aov</code> replace the functions 
from package <span class="pkg">stats</span>. For normal use, this is not an issue, because their 
default methods are exactly the functions from package <span class="pkg">stats</span>.<br> 
However, when programming on the language (or when using a package that relies on 
such constructs), you may see unexpected results. 
For example, <code>match.call(lm)</code> returns a different result, depending on 
whether or not package <span class="pkg">DoE.base</span> is loaded. This can be avoided by 
explicitly requesting e.g. <code>match.call(stats::lm)</code>, which always works 
in the same way.<br>
Please report any additional issues that you may experience.
</p>


<h3>Note</h3>

<p> The package is currently subject to intensive development; most key functionality is now included. 
Some changes to input and output structures may still occur.</p>


<h3>Author(s)</h3>

<p> Ulrike Groemping </p>


<h3>See Also</h3>

<p> See also the information on class <code>design</code> 
and its formula method <code>formula.design</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  oa12 &lt;- oa.design(nlevels=c(2,2,6))
  ## add a few variables to oa12
  responses &lt;- cbind(y=rexp(12),z=runif(12))
  oa12 &lt;- add.response(oa12, responses)
  ## want treatment contrasts rather than the default
  ## polynomial contrasts for the factors 
  oa12 &lt;- change.contr(oa12, "contr.treatment")
  linmod.y &lt;- lm(oa12)
  linmod.z &lt;- lm(oa12, response="z")
  linmod.y
  linmod.z
  summary(linmod.y)
  summary(linmod.z)
  
## examples with aggregation
  plan &lt;- oa.design(nlevels=c(2,6,2), replications=2, repeat.only=TRUE)
  y &lt;- rnorm(24)
  z &lt;- rexp(24)
  plan &lt;- add.response(plan, cbind(y=y,z=z))
  lm(plan)
  lm(plan, response="z")
  lm(plan, FUN=sd)
  ## wide format
  plan &lt;- reptowide(plan)
  plan
  design.info(plan)$responselist
  ## default: aggregate variables for first column of responselist
  lm(plan)
  ## request z variables instead (z is the column name of response list)
  lm(plan, response="z") 
  ## force analysis of first z measurement only
  lm(plan, response="z.1")
  ## use almost all options 
  ## (option use.center can only be used with center point designs 
  ##          from package FrF2)
  summary(lm(plan, response="z", degree=2, FUN=sd))

</code></pre>


</div>