<div class="container">

<table style="width: 100%;"><tr>
<td>plotmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
plots a graph (network), based on a transition matrix
</h2>

<h3>Description</h3>

<p>visualises a transition matrix as a number of (labeled) boxes connected by
(labeled) arrows.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotmat(A, pos = NULL, curve = NULL, name = NULL, absent = 0,  
        relsize = 1, lwd = 2, lcol = "black", box.size = 0.1, 
        box.type = "circle", box.prop = 1, box.col = "white", 
        box.lcol = lcol, box.lwd = lwd, 
        shadow.size = 0.01, shadow.col = "grey", dr = 0.01, 
        dtext = 0.3, self.lwd = 1, self.cex = 1, 
        self.shiftx = box.size, self.shifty = NULL, 
        self.arrpos = NULL, arr.lwd = lwd, arr.lcol = lcol, 
        arr.tcol = lcol, arr.col = "black", arr.type = "curved", 
        arr.pos = 0.5, arr.length = 0.4, arr.width = arr.length/2,
        endhead = FALSE, mx = 0.0, my = 0.0, box.cex = 1, 
        txt.col = "black", txt.xadj = 0.5, txt.yadj = 0.5,
        txt.font = 1, prefix = "", cex = 1, cex.txt = cex, 
        add = FALSE, main = "", cex.main = cex, 
        segment.from = 0, segment.to = 1, latex = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>square coefficient matrix, specifying the links (rows=to,
cols=from).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos </code></td>
<td>
<p>vector, specifying the number of elements in each graph row, 
or a 2-column matrix with element position, or NULL. If a 2-column matrix, the 
values should be withing 0 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve </code></td>
<td>
<p>one value, or a matrix, same dimensions as <code>A</code>, specifying
the arrow curvature; 0 for straight; NA for default curvature.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name </code></td>
<td>
<p>string vector, specifying the names of elements, dimension =
number of rows (columns) of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absent </code></td>
<td>
<p>all elements in <code>A</code> different from this value are
connected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relsize </code></td>
<td>
<p>scaling factor for size of the graph.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd </code></td>
<td>
<p>default line width of arrow and box.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol </code></td>
<td>
<p>default color of arrow line and box line.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.size </code></td>
<td>
<p>size of label box, one value or a vector with dimension =
number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.type </code></td>
<td>
<p>shape of label box (rect, ellipse, diamond, round, hexa,
multi), one value or a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.prop </code></td>
<td>
<p>length/width ratio of label box, one value or a vector
with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.col </code></td>
<td>
<p>fill color of label box, one value or a vector with
dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.lcol </code></td>
<td>
<p>line color of label box, one value or a vector with
dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.lwd </code></td>
<td>
<p>line width of the box, one value or a vector with dimension
= number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow.size </code></td>
<td>
<p>relative size of shadow of label box, one value or a
vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shadow.col </code></td>
<td>
<p>color of shadow of label box, one value or a vector with
dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dr </code></td>
<td>
<p>size of segments, in radians, to draw ellipse (decrease for
smoother ellipses).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtext </code></td>
<td>
<p>controls the position of arrow text relative to arrowhead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.lwd </code></td>
<td>
<p>line width of self-arrow, (arrow from i to i), one value or
a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.cex </code></td>
<td>
<p>relative size of self-arrow, relative to box, one value or
a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.shiftx </code></td>
<td>
<p>relative shift of self-arrow, in x-direction, one value
or a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.shifty </code></td>
<td>
<p>relative shift of self-arrow, in y-direction, one value
or a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.arrpos </code></td>
<td>
<p>position of the self-arrow, angle in radians relative to
x-direction, one value or a vector with dimension=number of rows of
<code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.lwd </code></td>
<td>
<p>line width of arrow, connecting two different points, one
value, or a matrix with same dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.lcol </code></td>
<td>
<p>color of arrow line, one value, or a matrix with same
dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.tcol </code></td>
<td>
<p>color of arrow text, one value, or a matrix with same
dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.col </code></td>
<td>
<p>color of arrowhead, one value, or a matrix with same
dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.type </code></td>
<td>
<p>type of arrowhead, one of ("curved", "triangle", 
"circle", "ellipse", "T", "simple", "none"), one
value, or a matrix with same dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.pos </code></td>
<td>
<p>relative position of arrowhead on arrow segment/curve, one
value, or a matrix with same dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.length </code></td>
<td>
<p>arrow length, one value, or a matrix with same
dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.width </code></td>
<td>
<p>arrow width, one value, or a matrix with same dimensions
as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endhead </code></td>
<td>
<p>if TRUE: the arrow line stops at the arrowhead; default =
<code>FALSE</code> and arrow line continues beyond the arrow head.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mx </code></td>
<td>
<p>horizontal shift of the boxes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>my </code></td>
<td>
<p>vertical shift of the boxes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.cex </code></td>
<td>
<p>relative size of text in boxes, one value or a vector with
dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.col </code></td>
<td>
<p>color of text in boxes, one value or a vector with
dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.xadj, txt.yadj </code></td>
<td>
<p> the x and y adjustment of the labels in the boxes, 
one value or a vector with dimension=number of rows of <code>A</code>
values usually within [0,1], although on most devices values outside that interval will also work.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.font </code></td>
<td>
<p> the font to be used for the text in boxes, 
one value or a vector with dimension=number of rows of <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix </code></td>
<td>
<p>to be added in front of non-zero arrow labels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex </code></td>
<td>
<p>relative size of text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.txt </code></td>
<td>
<p>relative size of arrow text, one value, or a matrix with
same dimensions as <code>A</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add </code></td>
<td>
<p>start a new plot (<code>FALSE</code>), or add to current plot
(<code>TRUE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main </code></td>
<td>
<p>main title. Only effective if <code>add = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main </code></td>
<td>
<p>relative size of main title. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.from </code></td>
<td>
<p>if not <code>0</code> then the arrow line will not start 
at the position as given in <code>A</code>, but with an offset.
one value, or a matrix with same dimensions as <code>A</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.to </code></td>
<td>
<p>if not <code>1</code> then the arrow line will not end 
at the position as given in <code>A</code>, but with an offset.
one value, or a matrix with same dimensions as <code>A</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latex </code></td>
<td>
<p>if <code>FALSE</code> then expressions will be interpreted before print, 
if <code>TRUE</code> they will be printed literally to the plot. 
Set to <code>TRUE</code> if LaTeX code is to be printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>other arguments passed to function <code>shadowbox</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The square transition matrix <code>A</code> determines the number of elements
of <code>A</code> (rows of <code>A</code>) and which elements are connected
(all values in <code>A</code> different from <code>absent</code>).
</p>
<p><code>A</code> also provides the values of arrowlabels.
</p>
<p>The position of the elements are specified with <code>pos</code>, which is
either <code>NULL</code>,
or a vector specifying the number of elements on a row, or a 2-columned
matrix specifying the (x,y) position of each element.
</p>
<p>The ordering of elements is according to the row number of <code>A</code>
</p>

<ul>
<li>
<p> when <code>pos</code> is <code>NULL</code>, the elements will be arranged on a
circle
</p>
</li>
<li>
<p> when <code>pos</code> is a vector, it specifies the number of elements in
each row.
For instance, with <code>pos = c(3,2,1)</code> the elements will be arranged
in 3 rows (length of vector); on top row, 3 elements; on second row 2,
and on third row 1 element will be positioned. All elements within a
row are equally distributed horizontally, all rows are equally
distributed vertically.
</p>
</li>
<li>
<p> when <code>pos</code> is a matrix, it specifies the x (1st column) and y
(2nd column) position of each element.
</p>
</li>
</ul>
<p>The offset from x-axis and from y-axis can be changed with <code>mx</code> and
<code>my</code>.
</p>
<p>The name of each element is given by vector <code>name</code>; this name is
written in its respective box.
</p>
<p>The relative size of this text can be changed by <code>box.cex</code>.
</p>
<p>By default, a shadow is drawn, in the right-lower
corner of the box.
</p>
<p>The shadow color and relative size is specified with <code>shadow.col</code> and
<code>shadow.size</code> respectively. 
</p>
<p>both can be one value (equal shadows) or a vector, specifying one value
for each box shadow.
</p>
<p><code>shadow.size = 0</code> toggles off the drawing of the shadow.
</p>
<p>The type of the box is set with "box.type" which can take on the values:
</p>

<ul>
<li>
<p> "rect": a rectangle,
</p>
</li>
<li>
<p> "ellipse": an ellipse,
</p>
</li>
<li>
<p> "diamond": a diamond,
</p>
</li>
<li>
<p> "round": a rectangle with rounded left and right edges,
</p>
</li>
<li>
<p> "hexa": a hexagonal shape,
</p>
</li>
<li>
<p> "multi": a multigonal shape.
</p>
</li>
<li>
<p> "none" if no box is to be drawn.
</p>
</li>
</ul>
<p>The length of the box is set with <code>box.size</code>, the proportionality
(length/width) ratio with <code>box.prop</code>.
</p>
<p>The fill-color of the box is specified with <code>box.col</code>;
the line width of the box with <code>box.lwd</code> and the line color with
<code>box.lcol</code>;
</p>
<p>All box properties can be either one value (equal boxes) or a vector,
specifying one value for each box.
</p>
<p>For all values A[i,j] of <code>A</code> which are not equal to <code>absent</code>,
one arrow is drawn *from* column-element j *to* the row-element i of <code>A</code>.
</p>
<p>The curvature of this arrow is specified with matrix element curve[i,j],
</p>
<p>where 'curve' is either NULL, one value, or has the same dimension as <code>A</code>.
</p>
<p>A straight arrow has curvature 0, <code>NA</code> (the default) chooses a default
curvature,
</p>
<p>Positive or negative values of <code>curve</code> draws curved arrows.
</p>
<p>If the arrow is curved, then <code>dr</code> is the increment used to draw the
ellipse; set to a lower value for smoother lines.
</p>
<p>The type of the arrowhead is set with <code>arr.type</code> which can take the
values:
</p>

<ul>
<li>
<p> "simple"  : uses comparable R function arrows  
</p>
</li>
<li>
<p> "triangle": uses filled triangle
</p>
</li>
<li>
<p> "curved"  : draws arrowhead with curved edges
</p>
</li>
<li>
<p> "circle" : draws circular head 
</p>
</li>
<li>
<p> "ellipse" : draws ellepsoid head
</p>
</li>
<li>
<p> "T"       : draws T-shaped (blunt) head
</p>
</li>
<li>
<p> "none"    : no arrow head is drawn
</p>
</li>
</ul>
<p>The line color and width of the arrow line is set with <code>arr.lcol</code> and
<code>arr.lwd</code>
</p>
<p>The size of the arrow head is specified with <code>arr.length</code> and
<code>arr.width</code>,
</p>
<p>the position of the arrow head is specified with <code>arr.pos</code> (value
between [0,1]).
</p>
<p>see <code>Arrowhead</code> for details on arrow head
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>arr </code></td>
<td>
<p> a data.frame with arrow information: 
</p>

<ul>
<li>
<p> nonzero: the elements between which an arrow is drawn.
</p>
</li>
<li>
<p> Angle: the angle of the arrow.
</p>
</li>
<li>
<p> Value: the value written next to the arrow head.
</p>
</li>
<li>
<p> rad: the radius of the arrow (if 0: straight line).
</p>
</li>
<li>
<p> ArrowX: the x-position of arrowhead.
</p>
</li>
<li>
<p> ArrowY: the y-position of arrowhead.
</p>
</li>
<li>
<p> TextX: the x-position of arrowtext.
</p>
</li>
<li>
<p> TextY: the y-position of arrowtext.
</p>
</li>
</ul>
<p>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp </code></td>
<td>
<p>a matrix with the element position (centre of the boxes).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radii </code></td>
<td>
<p>the radiusses in x- and y-direction of the boxes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rect </code></td>
<td>
<p>the "xleft","ybot","xright",and "ytop" of the boxes - redundant.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code>shadowbox</code>,
</p>
<p><code>Arrowhead</code> from package shape
</p>
<p>try: demo(plotmat)
</p>


<h3>Examples</h3>

<pre><code class="language-R">M &lt;- matrix(nrow = 4, ncol = 4, byrow = TRUE, data = 0)
pp &lt;- plotmat(M, pos = c(1, 2, 1), name = c("A", "B", "C", "D"),
              lwd = 1, box.lwd = 2, cex.txt = 0.8, 
              box.size = 0.1, box.type = "square", box.prop = 0.5,
              main = "plotmat")
pp

# when explicitly given, pos should should be inbetween 0, 1
pos &lt;- cbind (c(0.2, 0.4, 0.6, 0.8), c(0.8, 0.6, 0.4, 0.2))

pp &lt;- plotmat(M, pos = pos, name = c("A", "B", "C", "D"),
              lwd = 1, box.lwd = 2, cex.txt = 0.8, 
              box.size = 0.1, box.type = "square", box.prop = 0.5,
              main = "plotmat")

              
# includes arrows between boxes
pm &lt;- par(mfrow = c(2, 2))
M  &lt;- matrix(nrow = 4, ncol = 4, byrow = TRUE, data = 0)
M[2, 1] &lt;- M[3, 1] &lt;- M[4, 2] &lt;- M[4, 3] &lt;- "f1"

col   &lt;- M
col[] &lt;- "red"
col[2, 1] &lt;- col[3, 1] &lt;- "blue"
pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0, name = 1:4,
              lwd = 1, box.lwd = 2, box.cex = 1:4, cex.txt = 0.8, 
              arr.lcol = col, arr.tcol = col, 
              arr.col = col, box.type = "circle",
              box.prop = 1.0, main = "plotmat")

pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0, name = 1:4,
              lwd = 1, box.lwd = 2, box.cex = 1:4, cex.txt = 0.8, 
              arr.lcol = col, arr.tcol = col, arr.col = col, 
              box.type = "circle", box.prop = 1.0, arr.len = 0.3,
              segment.from = 0.35, segment.to = 0.65)

M[1, 2] &lt;- M[1, 3] &lt;- M[2, 4] &lt;- M[3, 4] &lt;- "f2"

pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0.1, name = 1:4,
              lwd = 1, box.lwd = 2, box.cex = 1:4, cex.txt = 0.8, 
              arr.lcol = col, arr.tcol = col, 
              arr.col = col, box.type = "none",
              box.prop = 1.0, main = "plotmat", arr.len = 0.2,
              segment.from = 0.3, segment.to = 0.7)

pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0.1, name = 1:4, 
              box.lwd = 2, box.cex = 1:4, cex.txt = 0.8, 
              arr.lcol = col, arr.tcol = "green", 
              arr.col = col, arr.pos = 0.7,
              arr.type = "simple", lwd = 2, box.type = "none",
              box.prop = 1.0, main = "plotmat", arr.len = 0.2,
              segment.from = 0.3, segment.to = 0.7)
par(mfrow=pm)
  
# self arrows
diag(M) &lt;- "self"
pp &lt;- plotmat(M, pos = c(2, 2), curve = 0, name = LETTERS[1:4],
              lwd = 1, box.lwd = 2, cex.txt = 0.8, self.cex = 0.5,
              self.shiftx = c(-0.1, 0.1, -0.1, 0.1),
              box.type = "diamond", box.prop = 0.5, main = "plotmat")


# different arrows  
M &lt;- matrix(nrow = 4, ncol = 4, data = 0)
M[2, 1]&lt;- 1 ; M[4, 2] &lt;- 2 ; M[3, 4] &lt;- 3; M[1, 3] &lt;- 4
pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0.2, name = letters[1:4],
              lwd = 1, box.lwd = 2, cex.txt = 0.8, arr.type = "triangle",
              box.size = 0.1, box.type = "hexa", box.prop = 0.5,
              main = "plotmat")

arrlwd &lt;- M*2
arr.length &lt;- M*0.4
cextxt &lt;- M*0.8
plotmat(M, pos = c(1, 2, 1), curve = 0.2, name = letters[1:4], lwd = 1,
        box.lwd = 2, arr.type = "triangle", box.size = 0.1,
        box.type = "hexa", box.prop = 0.5, main = "plotmat",
        arr.lwd = arrlwd, arr.length = arr.length, cex.txt = cextxt,
        txt.font = 1:4, txt.xadj = seq(-3, 3, length.out = 4),
        txt.yadj = 1)

M &lt;- matrix(nrow = 4, ncol = 4, byrow = TRUE, data = 0)
M     &lt;- as.data.frame(M)
M[[2,1]]&lt;- "k[si]"
M[[3,1]]&lt;- "k[N]"
M[[4,2]]&lt;- "sqrt(frac(2,3))"

names &lt;-
  c(expression(lambda[12]), "?", 
    expression(lambda[13]),expression(lambda[23]))

plotmat(M, pos = c(1, 2, 1), name = names, lwd = 1, box.lwd = 2, 
        curve = 0, cex.txt = 0.8, box.size = 0.1, box.type = "square",
        box.prop = 0.5, main = "plotmat")
              
plotmat(M, name = letters[1:4], curve = 0, box.cex = 1:4, box.lwd = 4:1,
        box.size = 0.075, arr.pos = 0.7, 
        box.col = c("lightblue", "green", "yellow", "orange"))


# No arrows, just lines with different colors
M &lt;- matrix(nrow = 4, ncol = 4, data = 0)
M[2, 1]&lt;- 1 ; M[4, 2] &lt;- 2 ; M[3, 4] &lt;- 3; M[1, 3] &lt;- 4
pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0.2, name = letters[1:4],
              lwd = 1, box.lwd = 2, cex.txt = 0.8, arr.type = "none",
              arr.lcol = M, box.size = 0.1, box.type = "hexa", 
              box.prop = 0.5, main = "plotmat")

pp &lt;- plotmat(M, pos = c(1, 2, 1), curve = 0.4, name = "",
              arr.type = "none", arr.lcol = M, 
              box.type = "none", cex.txt = 0, 
              main = "plotmat")
</code></pre>


</div>