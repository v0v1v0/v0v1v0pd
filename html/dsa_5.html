<div class="container">

<table style="width: 100%;"><tr>
<td>dsa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Seasonally Adjust Daily Time Series</h2>

<h3>Description</h3>

<p>Seasonally adjust daily time series using the dsa approach
</p>


<h3>Usage</h3>

<pre><code class="language-R">dsa(
  series,
  span.start = NULL,
  model = NULL,
  Log = FALSE,
  automodel = "reduced",
  ic = "bic",
  include.constant = FALSE,
  fourier_number = 24,
  max_fourier = 30,
  s.window1 = 53,
  s.window2 = 53,
  s.window3 = 13,
  t.window1 = NULL,
  t.window2 = NULL,
  t.window3 = NULL,
  cval = 7,
  robust1 = TRUE,
  robust2 = TRUE,
  robust3 = TRUE,
  regressor = NULL,
  forecast_regressor = NULL,
  reg_create = NULL,
  reg_dummy = NULL,
  outlier = TRUE,
  outlier_types = c("AO", "LS", "TC"),
  delta = 0.7,
  model_span = NULL,
  feb29 = "sfac",
  trend_month = 3,
  outer3 = NULL,
  inner3 = NULL,
  h = 365,
  reiterate3 = NULL,
  scaler = 1e+07,
  mean_correction = TRUE,
  progress_bar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>Input time series in xts format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span.start</code></td>
<td>
<p>Define when seasonal adjustment should begin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>ARIMA order of non-seasonal part</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log</code></td>
<td>
<p>Boolean. Should multiplicate or additive model be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>automodel</code></td>
<td>
<p>Set of models to be considered for automatic model detection. Either "full" or "reduced" set of fourier regressors included</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>Information criterion that is used for automodelling. One of "bic", "aic" or "aicc"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.constant</code></td>
<td>
<p>Should drift be allowed for model that includes differencing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fourier_number</code></td>
<td>
<p>Number of trigometric regressors to model annual and monthly seasonality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_fourier</code></td>
<td>
<p>Maximum number of trigonometric regressors allowed if the number is selected automatically, i.e. fourier_number=NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.window1</code></td>
<td>
<p>STL parameter s.window for the day of the week effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.window2</code></td>
<td>
<p>STL parameter s.window for the day of the month effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.window3</code></td>
<td>
<p>STL parameter s.window for the day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.window1</code></td>
<td>
<p>STL parameter t.window for the day of the week effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.window2</code></td>
<td>
<p>STL parameter t.window for the day of the month effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.window3</code></td>
<td>
<p>STL parameter t.window for the day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cval</code></td>
<td>
<p>Critical value for outlier adjustment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust1</code></td>
<td>
<p>Boolean. Should robust STL be used for the day of the week effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust2</code></td>
<td>
<p>Boolean. Should robust STL be used for the day of the month effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust3</code></td>
<td>
<p>Boolean. Should robust STL be used for the day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regressor</code></td>
<td>
<p>Pre-specified regressors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecast_regressor</code></td>
<td>
<p>Pre-specified regressors to be used for forecasting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_create</code></td>
<td>
<p>Names of Holidays for which regressors will be created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_dummy</code></td>
<td>
<p>If specified dummy variables of specified length are created and used as regressors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier</code></td>
<td>
<p>Should an outlier adjustment be conducted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_types</code></td>
<td>
<p>The following are possible: "LS", "TC", "AO", "IO"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The decay rate for TC outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_span</code></td>
<td>
<p>Last x years used for regARIMA modelling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feb29</code></td>
<td>
<p>How should February 29th be derived: interpolation of adjusted series ("sa") or combined factor ("sfac")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend_month</code></td>
<td>
<p>Length of support period for trend estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer3</code></td>
<td>
<p>Number of iterations of outer loop in STL for day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inner3</code></td>
<td>
<p>Number of iterations of inner loop in STL for day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Forecast horizon in number of days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reiterate3</code></td>
<td>
<p>Number of total iterations of STL for the day of the year effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaler</code></td>
<td>
<p>for additive model, if max(abs(series)) &gt; 1e5, scale series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_correction</code></td>
<td>
<p>Boolean. Should seasonal factors be standardised so that their mean (over all full cycles) is 0 for additive and 1 for multiplicative models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>Boolean. Should a progress bar be displayed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can be used to seasonally and calendar adjust daily time series and decomposing the series into a seasonally adjusted series, a day-of-the-week, a moving holiday, a day-of-the-month and a day-of-the-year component.
</p>
<p>If mean_correction=TRUE (default), the seasonal and calendar factors are corrected, so that over all full years, the mean of the components is 0 in additive models. They will be close to 1 if a multiplicative decomposition (i.e. Log=TRUE) is used. Deviations from 1 may result, because the mean correction is applied to the components before inverting taking logs.
</p>
<p>For long series, the ARIMA modelling and the outlier adjustment may take a long time. It may therefore be a good idea, to specify the ARIMA model used, e.g. model=c(3,1,0). If the series does not contain influential outliers, the outlier adjustment could be skipped by setting outlier=FALSE.
</p>
<p>See vignette for further examples.
</p>


<h3>Value</h3>

<p><code>dsa</code> returns a <code>daily</code> object which contains the output of the seasonal adjustment of a daily time series.
</p>
<p>output Contains the calendar and seasonally adjusted series, original series, implicit calendar and seasonal component, and Loess based trend as an <code>xts</code> object
</p>
<p>fourier_terms The number of sine and cosine terms used to model the seasonal pattern in the RegARIMA model
</p>
<p>reg RegARIMA results
</p>
<p>info Basic information on transformation (Log/Level), differencing and forecast horizon
</p>
<p>stl A list of length 3, containing the STL results of the day-of-week, day-of-the-month and day-of-the-year adjustment, respectively
</p>
<p>outlier Result of the outlier adjustment
</p>
<p>sa_result The original series and the intermediate adjustment results after the day-of-week adjustment (s1_adjusted), calendar adjustment (s1k1_adjusted), day-of-the-month adjustment (s1k1s2_adjusted), and the final adjusted series after the day-of-the-year adjustment (seas_adj) as an <code>xts</code> object
</p>
<p>sa_result2 The original series only adjusted for single components as an <code>xts</code> object. Namely the original series itself (original), the original only adjusted for the day-of-the week (s1_adjusted), calendar (k1_adjusted), day-of-the-month (s2_adjusted), and day-of-the-year (s3_adjusted)
</p>
<p>sfac_result The seasonal and calendar components as an <code>xts</code> object. Namely, the day-of-the-week (s1_fac), calendar (cal_fac), day-of-the-month (s2_fac), and day-of-the-year component (s3_fac) 
</p>


<h3>Author(s)</h3>

<p>Daniel Ollech
</p>


<h3>References</h3>

<p>Ollech, Daniel (2018). Seasonal adjustment of daily time series. Bundesbank Discussion Paper 41/2018.
</p>
<p>Ollech, Daniel (2021). Seasonal Adjustment of Daily Time Series. Journal of Time Series Econometrics (forthcoming).
</p>


<h3>Examples</h3>

<pre><code class="language-R">x = daily_sim(n=4)$original # series with length 4 years
res &lt;- dsa(x, cval=7, model=c(3,1,0),fourier_number = 13)
</code></pre>


</div>