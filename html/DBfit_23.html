<div class="container">

<table style="width: 100%;"><tr>
<td>simulacorrection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Work Horse Function to Implement the Double Bootstrap Method For .99 Cases 
</h2>

<h3>Description</h3>

<p>When function <code>simula</code> returns an estimate of rho to be .99, this function kicks in and ouputs a corrected estimate of rho. Currently, this only works for order 1, i.e. for order &gt; 1, this correction will not get involved.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulacorrection(x, y, arp, nbs, nbscov, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>the design matrix, including intercept, i.e. the first column being ones.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>the response variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbs</code></td>
<td>

<p>the bootstrap size for the first bootstrap procedure. Default is 500.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbscov</code></td>
<td>

<p>the bootstrap size for the second bootstrap procedure. Default is 500.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the method to be used for fitting. If "OLS", uses the ordinary least square <code>lm</code>; If "RANK", uses the rank-based fit <code>rfit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If 0.99 problem is detected, then construct Fisher
CI for both initial estimate (in Durbin stage 1) and first bias-corrected estimate (perform only one bootstrap, instead of a loop); if the midpoint of latter is smaller than 0.95, then this midpoint is the final
estimate for rho; otherwise the midpoint of the former CI is the final estimate.
</p>
<p>By default, when function <code>simula</code> returns an estimate of rho to be .99, this function kicks in and ouputs a corrected estimate of rho. However, users can turn the auto correction off by setting correction="FALSE" in <code>dbfit</code>. Users are encouraged to investigate why the stationarity assumption is violated based on their experience of time series analysis and knowledge of the data.
</p>


<h3>Note</h3>

<p>Users should use <code>dbfit</code> to perform the analysis.
</p>


<h3>References</h3>

<p>Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>


<h3>See Also</h3>

<p><code>dbfit</code>.
</p>


</div>