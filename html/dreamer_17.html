<div class="container">

<table style="width: 100%;"><tr>
<td>dreamer_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Data from Dose Response Models</h2>

<h3>Description</h3>

<p>See the model definitions below for specifics for each model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dreamer_data_linear(
  n_cohorts,
  doses,
  b1,
  b2,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_linear_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_quad(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_quad_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_loglinear(
  n_cohorts,
  doses,
  b1,
  b2,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_loglinear_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_logquad(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_logquad_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_emax(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  b4,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_emax_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  b4,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_exp(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_exp_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_beta(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  b4,
  scale,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_beta_binary(
  n_cohorts,
  doses,
  b1,
  b2,
  b3,
  b4,
  scale,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_independent(
  n_cohorts,
  doses,
  b1,
  sigma,
  times,
  t_max,
  longitudinal = NULL,
  ...
)

dreamer_data_independent_binary(
  n_cohorts,
  doses,
  b1,
  link,
  times,
  t_max,
  longitudinal = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_cohorts</code></td>
<td>
<p>a vector listing the size of each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>
<p>a vector listing the dose for each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1, b2, b3, b4</code></td>
<td>
<p>parameters in the models.  See sections below for
each parameter's interpretation in a given model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>the times at which data should be simulated if a longitudinal
model is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_max</code></td>
<td>
<p>the t_max parameter used in the longitudinal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longitudinal</code></td>
<td>
<p>a string indicating the longitudinal model to be used.
Can be "linear", "itp", or "idp".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional longitudinal parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>character vector indicating the link function for binary models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a scaling parameter (fixed, specified by the user) for the
beta models.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe of random subjects from the specified model and
parameters.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dreamer_data_linear()</code>: generate data from linear dose response.
</p>
</li>
<li> <p><code>dreamer_data_linear_binary()</code>: generate data from linear binary dose response.
</p>
</li>
<li> <p><code>dreamer_data_quad()</code>: generate data from quadratic dose response.
</p>
</li>
<li> <p><code>dreamer_data_quad_binary()</code>: generate data from quadratic binary dose response.
</p>
</li>
<li> <p><code>dreamer_data_loglinear()</code>: generate data from log-linear dose response.
</p>
</li>
<li> <p><code>dreamer_data_loglinear_binary()</code>: generate data from binary log-linear dose response.
</p>
</li>
<li> <p><code>dreamer_data_logquad()</code>: generate data from log-quadratic dose response.
</p>
</li>
<li> <p><code>dreamer_data_logquad_binary()</code>: generate data from log-quadratic binary dose
response.
</p>
</li>
<li> <p><code>dreamer_data_emax()</code>: generate data from EMAX dose response.
</p>
</li>
<li> <p><code>dreamer_data_emax_binary()</code>: generate data from EMAX binary dose response.
</p>
</li>
<li> <p><code>dreamer_data_exp()</code>: generate data from exponential dose response.
</p>
</li>
<li> <p><code>dreamer_data_exp_binary()</code>: generate data from exponential binary dose response.
</p>
</li>
<li> <p><code>dreamer_data_beta()</code>: generate data from Beta dose response.
</p>
</li>
<li> <p><code>dreamer_data_beta_binary()</code>: generate data from binary Beta dose response.
</p>
</li>
<li> <p><code>dreamer_data_independent()</code>: generate data from an independent dose response.
</p>
</li>
<li> <p><code>dreamer_data_independent_binary()</code>: generate data from an independent dose response.
</p>
</li>
</ul>
<h3>Linear</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + b_2 * d</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>Quadratic</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + b_2 * d + b_3 * d^2</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>Log-linear</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + b_2 * log(d + 1)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>Log-quadratic</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + b_2 * log(d + 1) + b_3 * log(d + 1)^2</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>EMAX</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + (b_2 - b_1) * d ^ b_4 / (exp(b_3 * b_4) + d ^ b_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_4 \sim N(mu_b4, sigma_b4 ^ 2), (Truncated above 0)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>

<p>Here, <code class="reqn">b_1</code> is the placebo effect (dose = 0), <code class="reqn">b_2</code> is the
maximum treatment effect, <code class="reqn">b_3</code> is the <code class="reqn">log(ED50)</code>, and
<code class="reqn">b_4</code> is the hill or rate parameter.
</p>


<h3>Exponential</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_1 + b_2 * (1 - exp(- b_3 * d))</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2), (truncated to be positive)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>Linear Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + b_2 * d</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>



<h3>Quadratic Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + b_2 * d + b_3 * d^2</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>



<h3>Log-linear Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + b_2 * log(d + 1)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>



<h3>Log-quadratic Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + b_2 * log(d + 1) + b_3 * log(d + 1)^2</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>



<h3>EMAX Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + (b_2 - b_1) * d ^ b_4 /
    (exp(b_3 * b_4) + d ^ b_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_4 \sim N(mu_b4, sigma_b4 ^ 2), (Truncated above 0)</code>
</p>

<p>Here, on the <code class="reqn">link(f(d))</code> scale,
<code class="reqn">b_1</code> is the placebo effect (dose = 0), <code class="reqn">b_2</code> is the
maximum treatment effect, <code class="reqn">b_3</code> is the <code class="reqn">log(ED50)</code>, and
<code class="reqn">b_4</code> is the hill or rate parameter.
</p>


<h3>Exponential Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_1 + b_2 * (exp(b_3 * d) - 1)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_1 \sim N(mu_b1, sigma_b1 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_2 \sim N(mu_b2, sigma_b2 ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">b_3 \sim N(mu_b3, sigma_b3 ^ 2), (Truncated below 0)</code>
</p>



<h3>Independent</h3>

<p style="text-align: center;"><code class="reqn">y \sim N(f(d), \sigma^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">f(d) = b_{1d}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{1d} \sim N(mu_b1[d], sigma_b1[d] ^ 2)</code>
</p>

<p style="text-align: center;"><code class="reqn">1 / \sigma^2 \sim Gamma(shape, rate)</code>
</p>



<h3>Independent Binary</h3>

<p style="text-align: center;"><code class="reqn">y \sim Binomial(n, f(d))</code>
</p>

<p style="text-align: center;"><code class="reqn">link(f(d)) = b_{1d}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{1d} \sim N(mu_b1[d], sigma_b1[d]) ^ 2</code>
</p>



<h3>Longitudinal Linear</h3>

<p>Let <code class="reqn">f(d)</code> be a dose response model.  The expected value of the
response, y, is:
</p>
<p style="text-align: center;"><code class="reqn">E(y) = g(d, t)</code>
</p>

<p style="text-align: center;"><code class="reqn">g(d, t) = a + (t / t_max) * f(d)</code>
</p>

<p style="text-align: center;"><code class="reqn">a \sim N(mu_a, sigma_a)</code>
</p>



<h3>Longitudinal ITP</h3>

<p>Let <code class="reqn">f(d)</code> be a dose response model.  The expected value of the
response, y, is:
</p>
<p style="text-align: center;"><code class="reqn">E(y) = g(d, t)</code>
</p>

<p style="text-align: center;"><code class="reqn">g(d, t) = a + f(d) * ((1 - exp(- c1 * t))/(1 - exp(- c1 * t_max)))</code>
</p>

<p style="text-align: center;"><code class="reqn">a \sim N(mu_a, sigma_a)</code>
</p>

<p style="text-align: center;"><code class="reqn">c1 \sim Uniform(a_c1, b_c1)</code>
</p>



<h3>Longitudinal IDP</h3>

<p>Increasing-Decreasing-Plateau (IDP).
</p>
<p>Let <code class="reqn">f(d)</code> be a dose response model.  The expected value of the
response, y, is:
</p>
<p style="text-align: center;"><code class="reqn">E(y) = g(d, t)</code>
</p>

<p style="text-align: center;"><code class="reqn">g(d, t) = a + f(d) * (((1 - exp(- c1 * t))/(1 - exp(- c1 * d1))) *
    I(t &lt; d1) + (1 - gam * ((1 - exp(- c2 * (t - d1))) /
    (1 - exp(- c2 * (d2 - d1))))) *
    I(d1 &lt;= t &lt;= d2) + (1 - gam) * I(t &gt; d2))</code>
</p>

<p style="text-align: center;"><code class="reqn">a \sim N(mu_a, sigma_a)</code>
</p>

<p style="text-align: center;"><code class="reqn">c1 \sim Uniform(a_c1, b_c1)</code>
</p>

<p style="text-align: center;"><code class="reqn">c2 \sim Uniform(a_c2, b_c2)</code>
</p>

<p style="text-align: center;"><code class="reqn">d1 \sim Uniform(0, t_max)</code>
</p>

<p style="text-align: center;"><code class="reqn">d2 \sim Uniform(d1, t_max)</code>
</p>

<p style="text-align: center;"><code class="reqn">gam \sim Uniform(0, 1)</code>
</p>



<h3>Examples</h3>

<pre><code class="language-R">set.seed(888)
data &lt;- dreamer_data_linear(
  n_cohorts = c(20, 20, 20),
  dose = c(0, 3, 10),
  b1 = 1,
  b2 = 3,
  sigma = 5
)

head(data)

plot(data$dose, data$response)
abline(a = 1, b = 3)

# longitudinal data
set.seed(889)
data_long &lt;- dreamer_data_linear(
  n_cohorts = c(10, 10, 10, 10), # number of subjects in each cohort
  doses = c(.25, .5, .75, 1.5), # dose administered to each cohort
  b1 = 0, # intercept
  b2 = 2, # slope
  sigma = .5, # standard deviation,
  longitudinal = "itp",
  times = c(0, 12, 24, 52),
  t_max = 52, # maximum time
  a = .5,
  c1 = .1
)

## Not run: 
  ggplot(data_long, aes(time, response, group = dose, color = factor(dose))) +
    geom_point()

## End(Not run)
</code></pre>


</div>