<div class="container">

<table style="width: 100%;"><tr>
<td>bbm_data_generate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
bbm_data_generate
</h2>

<h3>Description</h3>

<p>This is to generate the simulation data based on Beta-bionomial mixture model
</p>


<h3>Usage</h3>

<pre><code class="language-R">bbm_data_generate(S=3, G=50, K=3, prob=rep(1,times=3),
                              alpha_band=c(2,6),
                              beta_band=c(2,6),
                              nb_mu=100,nb_size=0.2, plotf = FALSE, 
                              max_cor=0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p> Number of samples in the simulated data

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p> Number of sites in the simulated data

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p> Number of clusters that exist in the simulated data

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p> the cluster weight for each cluster

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_band</code></td>
<td>
<p> the region used to generate the parameter of beta distribution alpha

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_band</code></td>
<td>
<p> the region used to generate the parameter of beta distribution beta

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_mu</code></td>
<td>
<p> alternative parametrization via mean for Negative Binomial distribution

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_size</code></td>
<td>
<p> target for number of successful trials, or dispersion parameter (the shape parameter of the gamma mixing distribution) for Negative binomial distrition. Must be strictly positive, need not be integer.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotf</code></td>
<td>
<p> option for whether plot the generated data according to clusters or not

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_cor</code></td>
<td>
<p> The maximized correlation allowed for the simulated data, which used to guarantee the data is not highly correlated.

</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Dirichlet Process based beta-binomial mixture model clustering
</p>


<h3>Value</h3>

<p>The function returns simulation data generated based on beta binomial mixture model
</p>


<h3>Author(s)</h3>

<p> Lin Zhang, PhD  &lt;lin.zhang@cumt.edu.cn&gt;

</p>


<h3>References</h3>

<p>Reference coming soon!
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123455)
S &lt;- 4
G &lt;- 100
K &lt;- 3
nb_mu &lt;- 100
nb_size &lt;- 0.8
prob &lt;- c(1,1,1)
mat &lt;- bbm_data_generate(S=S,G=G,K=K,prob=prob,alpha_band=c(2,6),beta_band=c(2,6),
                         nb_mu=nb_mu,nb_size=nb_size, plotf = TRUE, max_cor=0.5) 
table(mat$gamma)
pie(mat$gamma)
id &lt;- order(mat$gamma);
c &lt;- mat$gamma[id]
mat_ratio &lt;- (mat$k+1)/(mat$n+1);
heatmap(mat_ratio[id,], Rowv = NA, Colv = NA, scale="none", RowSideColors=as.character(c), 
        xlab = "4 samples", ylab="100 RNA methylation sites")
</code></pre>


</div>