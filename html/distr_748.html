<div class="container">

<table style="width: 100%;"><tr>
<td>qqplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Methods for Function qqplot in Package ‘distr’</h2>

<h3>Description</h3>

<p>We generalize function <code>qqplot</code> from package <span class="pkg">stats</span> to
be applicable to distribution objects.  In this context,
<code>qqplot</code> produces a QQ plot of two distributions, i.e.; argument <code>x</code>
is the distribution to be checked for compatibility, and <code>y</code> is the
model (<code class="reqn">H_0</code>-)distribution.
Graphical parameters may be given as arguments to <code>qqplot</code>.
The <span class="pkg">stats</span> function
is just the method for signature <code>x=ANY,y=ANY</code>.
In all title and axis label arguments, if <code>withSubst</code> is <code>TRUE</code>,
the following patterns are substituted:
</p>

<dl>
<dt><code>"%C"</code></dt>
<dd>
<p>class of argument <code>x</code></p>
</dd>
<dt><code>"%A"</code></dt>
<dd>
<p>deparsed argument <code>x</code></p>
</dd>
<dt><code>"%D"</code></dt>
<dd>
<p>time/date-string when the plot was generated</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">qqplot(x, y, ...)
## S4 method for signature 'UnivariateDistribution,UnivariateDistribution'
qqplot(x, y,
    n = 30, withIdLine = TRUE, withConf = TRUE,
    withConf.pw  = withConf,  withConf.sim = withConf,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ...,
    width = 10, height = 5.5, withSweave = getdistrOption("withSweave"),
    mfColRow = TRUE, n.CI = n, col.IdL = "red", lty.IdL = 2, lwd.IdL = 2,
    alpha.CI = .95, exact.pCI = (n&lt;100), exact.sCI = (n&lt;100), nosym.pCI = FALSE,
    col.pCI = "orange", lty.pCI = 3, lwd.pCI = 2, pch.pCI = par("pch"),
    cex.pCI = par("cex"),
    col.sCI = "tomato2", lty.sCI = 4, lwd.sCI = 2, pch.sCI = par("pch"),
    cex.sCI = par("cex"),
    cex.pch = par("cex"), col.pch = par("col"),
    jit.fac = 0, check.NotInSupport = TRUE,
    col.NotInSupport = "red", with.legend = TRUE, legend.bg = "white",
    legend.pos = "topleft", legend.cex = 0.8, legend.pref = "", 
    legend.postf = "", legend.alpha = alpha.CI, debug = FALSE, withSubst = TRUE)
## S4 method for signature 'ANY,ANY'
qqplot(x, y,
    plot.it = TRUE, xlab = deparse(substitute(x)),
    ylab = deparse(substitute(y)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>"ANY"</code> (<span class="pkg">stats</span>-method) or
of code <code>"UnivariateDistribution"</code>; to be compared to <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>object of class <code>"ANY"</code> (<span class="pkg">stats</span>-method) or
of class <code>"UnivariateDistribution"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; number of quantiles at which to do the comparison.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withIdLine</code></td>
<td>
<p>logical; shall line <code>y = x</code> be plotted in?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf</code></td>
<td>
<p>logical; shall confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.pw</code></td>
<td>
<p>logical; shall pointwise confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.sim</code></td>
<td>
<p>logical; shall simultaneous confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical; shall be plotted at all (inherited from <code>qqplot</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters for function <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width (in inches) of the graphics device opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>height (in inches) of the graphics device opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withSweave</code></td>
<td>
<p>logical: if <code>TRUE</code> (for working with <code>Sweave</code>)
no extra device is opened and height/width are not set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfColRow</code></td>
<td>
<p>shall default partition in panels be used — defaults to <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.CI</code></td>
<td>
<p>numeric; number of points to be used for confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.IdL</code></td>
<td>
<p>color for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.IdL</code></td>
<td>
<p>line type for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.IdL</code></td>
<td>
<p>line width for the identity line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.CI</code></td>
<td>
<p>confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.pCI</code></td>
<td>
<p>logical; shall pointwise CIs be determined with exact Binomial distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.sCI</code></td>
<td>
<p>logical; shall simultaneous CIs be determined with exact kolmogorov distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym.pCI</code></td>
<td>
<p>logical; shall we use (shortest) asymmetric CIs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pCI</code></td>
<td>
<p>color for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.pCI</code></td>
<td>
<p>line type for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.pCI</code></td>
<td>
<p>line width for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sCI</code></td>
<td>
<p>color for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.sCI</code></td>
<td>
<p>line type for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.sCI</code></td>
<td>
<p>line width for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.sCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.sCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pch</code></td>
<td>
<p>magnification factor for the plotted symbols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pch</code></td>
<td>
<p>color for the plotted symbols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jit.fac</code></td>
<td>
<p>jittering factor used for discrete distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.NotInSupport</code></td>
<td>
<p>logical; shall we check if all <code>x</code>-quantiles lie in <code>support(y)</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.NotInSupport</code></td>
<td>
<p>logical; if preceding check <code>TRUE</code> color of <code>x</code>-quantiles if not in <code>support(y)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>logical; shall a legend be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.bg</code></td>
<td>
<p>background color for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p>position for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>
<p>magnification factor for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pref</code></td>
<td>
<p>character to be prepended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.postf</code></td>
<td>
<p>character to be appended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.alpha</code></td>
<td>
<p>nominal coverage probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical; if <code>TRUE</code> additional output to debug confidence bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withSubst</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) pattern substitution for
titles and lables is used; otherwise no substitution is used. </p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>qqplot</dt>
<dd>
<p><code>signature(x = "ANY", y = "ANY")</code>: function <code>qqplot</code> from
package <span class="pkg">stats</span>.</p>
</dd>
<dt>qqplot</dt>
<dd>
<p><code>signature(x = "UnivariateDistribution", y = "UnivariateDistribution")</code>:
produces a QQ plot for two univariate distributions.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list of elements containing the information needed to compute the 
respective QQ plot, in particular it extends the elements of the 
return value of function <code>qqplot</code> 
from package <span class="pkg">stats</span>, i.e., a
list with components <code>x</code> and <code>y</code> for x and y coordinates
of the plotted points; more specifically it contains
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The x coordinates of the points that were/would be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The corresponding quantiles of the second distribution,
<em>including <code>NA</code>s</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>A matrix with the lower and upper confidence bounds
(computed by <code>qqbounds</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>logical vector of length 2.</p>
</td>
</tr>
</table>
<p>(elements <code>crit</code> and <code>err</code> are taken from the return
value(s) of <code>qqbounds</code>).
The return value allows to recover all information used to produce the plot
for later use in enhanced graphics (e.g. with ggplot).   
</p>


<h3>Author(s)</h3>

<p>Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code>qqplot</code> from package <span class="pkg">stats</span> – the standard QQ plot
function and
<code>qqbounds</code>, used by <code>qqplot</code> to produce confidence
intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## IGNORE_RDIFF_BEGIN
qqplot(Norm(15,sqrt(30)), Chisq(df=15))
## some discrete Distributions:
P &lt;- Pois(5)
B &lt;- Binom(size=2000,prob=5/2000)
qqplot(B,P)
## IGNORE_RDIFF_END

## takes too much time for R CMD check --as-cran
qqplot(B,P, nosym.pCI=TRUE)

## some Lebesgue-Decomposed distributions:
mylist &lt;- UnivarLebDecDistribution(discretePart=Binom(3,.3), acPart=Norm(2,2),
               acWeight=11/20)
mylist2 &lt;- mylist+0.1

## IGNORE_RDIFF_BEGIN
qqplot(mylist,mylist2)
qqplot(mylist,mylist2,exact.pCI=FALSE,exact.sCI=FALSE)
## IGNORE_RDIFF_END


## takes too much time for R CMD check --as-cran
qqplot(mylist,mylist2,nosym.pCI=TRUE)
## some ac. distribution with a gap
mylist3 &lt;- UnivarMixingDistribution(Unif(0,0.3),Unif(0.6,1),mixCoeff=c(0.8,0.2))
gaps(mylist3)
mylist4 &lt;- UnivarMixingDistribution(Unif(0,0.3),Unif(0.6,1),mixCoeff=c(0.6,0.4))
qqplot(mylist3,mylist4)
qqplot(mylist3,mylist4,nosym.pCI=TRUE)

</code></pre>


</div>