<div class="container">

<table style="width: 100%;"><tr>
<td>tmle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Returns the targeted maximum likelihood estimates for the nuisance functions</h2>

<h3>Description</h3>

<p>Returns the targeted maximum likelihood estimates for the nuisance functions
</p>


<h3>Usage</h3>

<pre><code class="language-R">tmle(
  datmat,
  iter = 250,
  margin = 0.005,
  stop_margin = 0.005,
  twolist = FALSE,
  K = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datmat</code></td>
<td>
<p>The data frame containing columns <code>yj</code>, <code>yk</code>, <code>yjk</code>, <code>q10</code>, <code>q02</code> and <code>q12</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>An integer denoting the maximum number of iterations allowed for targeted maximum likelihood method. Default value is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>The minimum value the estimates can attain to bound them away from zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_margin</code></td>
<td>
<p>The minimum value the estimates can attain to bound them away from zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twolist</code></td>
<td>
<p>The logical value of whether targeted maximum likelihood algorithm fits only two modes when K = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of lists in the original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any extra arguments passed into the function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of estimates containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>  An indicator of whether the algorithm ran and converged. Returns FALSE, if it ran correctly and FALSE otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datmat</code></td>
<td>
<p>  A data frame returning <code>datmat</code> with the updated estimates for the nuisance functions <code>q10</code>, <code>q02</code> and <code>q12</code>. This is returned only if <code>error</code> is FALSE.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>van der Laan, M. J. and Rubin, D. (2006). Targeted maximum likelihood learning. <em>The International Journal of Biostatistics</em>, <em>2</em>(1)
</p>
<p>Das, M., Kennedy, E. H., &amp; Jewell, N.P. (2021). Doubly robust capture-recapture methods for estimating population size. <em>arXiv preprint</em> arXiv:2104.14091.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data = matrix(sample(c(0,1), 2000, replace = TRUE), ncol = 2)
xmat = matrix(runif(nrow(data)*3, 0, 1), nrow = nrow(data))
datmat = cbind(data, data[,1]*data[,2], xmat)
colnames(datmat) = c("yj", "yk", "yjk", "q10", "q02", "q12")
datmat = as.data.frame(datmat)
result = tmle(datmat, margin = 0.005, stop_margin = 0.00001, twolist = TRUE)
</code></pre>


</div>