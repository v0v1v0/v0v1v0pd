<div class="container">

<table style="width: 100%;"><tr>
<td>bpstrip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Box-percentile strips</h2>

<h3>Description</h3>

<p>Box-percentile strips give a compact illustration of a distribution. 
The width of the strip is proportional to the probability of a more
extreme point.  This function adds a box-percentile strip to an existing
plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bpstrip(x, prob, at, width, horiz=TRUE, scale=1, limits=c(-Inf, Inf), 
        col="gray", border=NULL, lwd, lty, ticks=NULL, tlen=1, twd, tty,
        lattice=FALSE)
panel.bpstrip(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> Either the vector of points at which the probability is
evaluated (if <code>prob</code> supplied), or a sample from the distribution
(if <code>prob</code> not supplied). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p> Probability, or cumulative density, of the distribution
at <code>x</code>.  If <code>prob</code> is not supplied, this is estimated from
the sample <code>x</code> using <code>ecdf(x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p> Position of the centre of the strip on the y-axis (if
<code>horiz=TRUE</code>) or the x-axis (if <code>horiz=FALSE</code>).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p> Thickness of the strip at its thickest point, which will
be at the median.  Defaults to 1/20 of the axis range. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p> Draw the strip horizontally (<code>TRUE</code>) or vertically (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p> Alternative way of specifying the thickness of the
strip, as a proportion of <code>width</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>Vector of minimum and maximum values, respectively, at which to terminate the strip.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colour to shade the strip, either as a built-in R
colour name (one of <code>colors()</code>) or an RGB hex
value, e.g. black is <code>"#000000"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>Colour of the border, see <code>polygon</code>. Use
<code>border=NA</code> to show no border.  The default, 'NULL', means to
use 'par("fg")' or its <span class="pkg">lattice</span> equivalent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width of the border (defaults to
<code>par("lwd")</code> or its <span class="pkg">lattice</span> equivalent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type of the border (defaults to
<code>par("lty")</code> or its <span class="pkg">lattice</span> equivalent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticks</code></td>
<td>
<p> Vector of <code>x</code>-positions on the strip to draw tick
marks, or <code>NULL</code> for no ticks. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlen</code></td>
<td>
<p>Length of the ticks, relative to the thickness of the strip.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twd</code></td>
<td>
<p> Line width of these marks (defaults to
<code>par("lwd")</code> or its <span class="pkg">lattice</span> equivalent). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tty</code></td>
<td>
<p> Line type of these marks (defaults to
<code>par("lty")</code> or its <span class="pkg">lattice</span> equivalent). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lattice</code></td>
<td>
<p>Set this to <code>TRUE</code> to make <code>bpstrip</code>
a <span class="pkg">lattice</span> panel function instead of a base graphics function. <br><code>panel.bpstrip(x,...)</code> is equivalent to
<code>bpstrip(x, lattice=TRUE, ...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>panel.bpstrip</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The box-percentile strip looks the same as the <em>box-percentile plot</em>
(Esty and Banfield, 2003) which is a generalisation of the boxplot for
summarising data.  However, <code>bpstrip</code> is intended for illustrating
distributions arising from parameter
estimation or prediction.  Either the distribution is known
analytically, or an arbitrarily large sample from the distribution is
assumed to be available via a method such as MCMC or bootstrapping.
</p>
<p>The function <code>bpplot</code> in the <span class="pkg">Hmisc</span>
package can be used to draw vertical box-percentile plots of observed
data.  
</p>


<h3>Author(s)</h3>

<p> Christopher Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt; </p>


<h3>References</h3>

<p> Jackson, C. H.  (2008) Displaying uncertainty with
shading. <em>The American Statistician</em>, 62(4):340-347. 
</p>
<p>Esty, W. W. and Banfield, J. D. (2003) The box-percentile
plot. <em>Journal of Statistical Software</em> <b>8</b>(17).  
</p>


<h3>See Also</h3>

 <p><code>vwstrip</code>, <code>cistrip</code>, <code>denstrip</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- seq(-4, 4, length=1000)
prob &lt;- pnorm(x)
plot(x, xlim=c(-5, 5), ylim=c(-5, 5), xlab="x", ylab="x", type="n")
bpstrip(x, prob, at=1, ticks=qnorm(c(0.25, 0.5, 0.75)))

## Terminate the strip at specific outer quantiles
bpstrip(x, prob, at=2, limits=qnorm(c(0.025, 0.975)))
bpstrip(x, prob, at=3, limits=qnorm(c(0.005, 0.995)))

## Compare with density strip
denstrip(x, dnorm(x), at=0)

## Estimate the density from a large sample 
x &lt;- rnorm(10000)
bpstrip(x, at=4)

</code></pre>


</div>