<div class="container">

<table style="width: 100%;"><tr>
<td>generate_cells</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate the cells</h2>

<h3>Description</h3>

<p><code>generate_cells()</code> runs simulations in order to determine the gold standard
of the simulations.
<code>simulation_default()</code> is used to configure parameters pertaining this process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_cells(model)

simulation_default(
  burn_time = NULL,
  total_time = NULL,
  ssa_algorithm = ssa_etl(tau = 30/3600),
  census_interval = 4,
  experiment_params = bind_rows(simulation_type_wild_type(num_simulations = 32),
    simulation_type_knockdown(num_simulations = 0)),
  store_reaction_firings = FALSE,
  store_reaction_propensities = FALSE,
  compute_cellwise_grn = FALSE,
  compute_dimred = TRUE,
  compute_rna_velocity = FALSE,
  kinetics_noise_function = kinetics_noise_simple(mean = 1, sd = 0.005)
)

simulation_type_wild_type(
  num_simulations,
  seed = sample.int(10 * num_simulations, num_simulations)
)

simulation_type_knockdown(
  num_simulations,
  timepoint = runif(num_simulations),
  genes = "*",
  num_genes = sample(1:5, num_simulations, replace = TRUE, prob = 0.25^(1:5)),
  multiplier = runif(num_simulations, 0, 1),
  seed = sample.int(10 * num_simulations, num_simulations)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A dyngen intermediary model for which the gold standard been generated with <code>generate_gold_standard()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn_time</code></td>
<td>
<p>The burn in time of the system, used to determine an initial state vector. If <code>NULL</code>, the burn time will be inferred from the backbone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_time</code></td>
<td>
<p>The total simulation time of the system. If <code>NULL</code>, the simulation time will be inferred from the backbone.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssa_algorithm</code></td>
<td>
<p>Which SSA algorithm to use for simulating the cells with <code>GillespieSSA2::ssa()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>census_interval</code></td>
<td>
<p>A granularity parameter for the outputted simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>experiment_params</code></td>
<td>
<p>A tibble generated by rbinding multiple calls of <code>simulation_type_wild_type()</code> and <code>simulation_type_knockdown()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_reaction_firings</code></td>
<td>
<p>Whether or not to store the number of reaction firings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_reaction_propensities</code></td>
<td>
<p>Whether or not to store the propensity values of the reactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_cellwise_grn</code></td>
<td>
<p>Whether or not to compute the cellwise GRN activation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_dimred</code></td>
<td>
<p>Whether to perform a dimensionality reduction after simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_rna_velocity</code></td>
<td>
<p>Whether or not to compute the propensity ratios after simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinetics_noise_function</code></td>
<td>
<p>A function that will generate noise to the kinetics of each simulation.
It takes the <code>feature_info</code> and <code>feature_network</code> as input parameters,
modifies them, and returns them as a list. See <code>kinetics_noise_none()</code> and <code>kinetics_noise_simple()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_simulations</code></td>
<td>
<p>The number of simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A set of seeds for each of the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timepoint</code></td>
<td>
<p>The relative time point of the knockdown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>Which genes to sample from. <code>"*"</code> for all genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_genes</code></td>
<td>
<p>The number of genes to knockdown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplier</code></td>
<td>
<p>The strength of the knockdown. Use 0 for a full knockout, 0&lt;x&lt;1 for a knockdown, and &gt;1 for an overexpression.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dyngen model.
</p>


<h3>See Also</h3>

<p>dyngen on how to run a complete dyngen simulation
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
model &lt;- 
  initialise_model(
    backbone = backbone_bifurcating(),
    simulation = simulation_default(
      ssa_algorithm = ssa_etl(tau = .1),
      experiment_params = bind_rows(
        simulation_type_wild_type(num_simulations = 4),
        simulation_type_knockdown(num_simulations = 4)
      )
    )
  )

data("example_model")
model &lt;- example_model %&gt;% generate_cells()
  
plot_simulations(model)
plot_gold_mappings(model)
plot_simulation_expression(model)

</code></pre>


</div>