<div class="container">

<table style="width: 100%;"><tr>
<td>relabel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A Relabel Algorithm 
</h2>

<h3>Description</h3>

<p>Function <code>relabel</code> implements Algorithm 2 in Matthew Stephens (2000) JRSSB for the posterior allocation probability matrix, minimizing the Kullback-Leibler distance.  Step 2 in this algorithm is solved using the Hungarian (Munkres) algorithm to the assignment problem.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relabel(probs.mcmc, nIter, nItem, nClust, 
    RELABEL.THRESHOLD, PRINT = 0, PACKAGE="DIRECT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs.mcmc</code></td>
<td>

<p>A <code>nItem</code>*<code>nIter</code>-by-<code>nClust</code> matrix of samples of the posterior allocation probability matrix stored in file *_mcmc_probs.out generated by <code>resampleClusterProb</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIter</code></td>
<td>

<p>Number of stored MCMC samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nItem</code></td>
<td>

<p>Number of items.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nClust</code></td>
<td>

<p>Number of inferred clusters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RELABEL.THRESHOLD</code></td>
<td>

<p>A positive scalar.  Used to determine whether the optimization in the relabeling algorithm has converged.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRINT</code></td>
<td>

<p>If TRUE, print intermediate values onto the screen.  Used for debugging with small data sets.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PACKAGE</code></td>
<td>

<p>Not for use.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Permuted labels for each store MCMC sample are written to file *_mcmc_perms.out, in which each row contains an inferred permutation (relabel) of labels of mixture components.
</p>


<h3>Note</h3>

<p>This function calls a routine written in C, where implementation of Munkres algorithm is adapted from the C code by Dariush Lotfi (June 2008; web download).
</p>


<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>
<p>Stephens, M. (2000) Dealing with label switching in mixture models. Journal of the Royal Statistical Society, Series B, 62: 795-809.
</p>


<h3>See Also</h3>

<p><code>DIRECT</code> for the complete method.
</p>
<p><code>DPMCMC</code> for the MCMC sampler under the Dirichlet-process prior.
</p>
<p><code>resampleClusterProb</code> for resampling of posterior allocation probability matrix in posterior inference.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See example for DIRECT.
</code></pre>


</div>