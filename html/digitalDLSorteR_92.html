<div class="container">

<table style="width: 100%;"><tr>
<td>showProbPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Show distribution plots of the cell proportions generated by
<code>generateBulkCellMatrix</code>
</h2>

<h3>Description</h3>

<p>Show distribution plots of the cell proportions generated by
<code>generateBulkCellMatrix</code>. These frequencies will determine the
proportion of different cell types used during the simulation of pseudo-bulk
RNA-Seq samples. There are 6 subsets of proportions generated by different
approaches that can be visualized in three ways: box plots, violin plots and
lines plots. You can also plot the probabilities based on the number of
different cell types present in the samples by setting <code>type.plot =
'nCellTypes'</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">showProbPlot(object, type.data, set, type.plot = "boxplot")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>DigitalDLSorter</code> object with
<code>prob.cell.types</code> slot with <code>plot</code> slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.data</code></td>
<td>
<p>Subset of data to show: <code>train</code> or <code>test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>Integer determining which of the 6 different subsets to display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.plot</code></td>
<td>
<p>Character determining which type of visualization to
display. It can be <code>'boxplot'</code>, <code>'violinplot'</code>, <code>'linesplot'</code> or
<code>'ncelltypes'</code>. See Description for more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These plots are only for diagnostic purposes. This is the reason because they
are generated without any parameter introduced by the user.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>See Also</h3>

<p><code>generateBulkCellMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulating data
set.seed(123) # reproducibility
sce &lt;- SingleCellExperiment::SingleCellExperiment(
  assays = list(
    counts = matrix(
      rpois(100, lambda = 5), nrow = 40, ncol = 30, 
      dimnames = list(paste0("Gene", seq(40)), paste0("RHC", seq(30)))
    )
  ),
  colData = data.frame(
    Cell_ID = paste0("RHC", seq(30)),
    Cell_Type = sample(x = paste0("CellType", seq(4)), size = 30, 
                       replace = TRUE)
  ),
  rowData = data.frame(
    Gene_ID = paste0("Gene", seq(40))
  )
)
DDLS &lt;- createDDLSobject(
  sc.data = sce,
  sc.cell.ID.column = "Cell_ID",
  sc.gene.ID.column = "Gene_ID",
  sc.filt.genes.cluster = FALSE, 
  sc.log.FC = FALSE
)
probMatrix &lt;- data.frame(
  Cell_Type = paste0("CellType", seq(4)),
  from = c(1, 1, 1, 30),
  to = c(15, 15, 50, 70)
)
DDLS &lt;- generateBulkCellMatrix(
  object = DDLS,
  cell.ID.column = "Cell_ID",
  cell.type.column = "Cell_Type",
  prob.design = probMatrix,
  num.bulk.samples = 60
)
lapply(
  X = 1:6, FUN = function(x) {
      showProbPlot(
        DDLS,
        type.data = "train",
        set = x,
        type.plot = "boxplot"
      )
    }
  )
  
</code></pre>


</div>