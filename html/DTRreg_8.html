<div class="container">

<table style="width: 100%;"><tr>
<td>predict.DTRreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimal Outcome Prediction for DTRs</h2>

<h3>Description</h3>

<p>Predicted outcome assuming optimal treatment (according to analysis via 
G-estimation or dWOLS) was followed.  Assumes blip and treatment-free 
models correctly specified.
</p>
<p>This function may be used in a similar fashion to more traditional modeling 
commands (such as lm).  Users are referred to the primary 'DTRreg()' 
and 'DTRSurv()' help command
(and associated literature) for information concerning model specification.
In particular, we note that the predict function assumes that the 
treatment-free model has been correctly specified, as the treatment-free 
parameters are used in the prediction process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'DTRreg'
predict(object, newdata, treat.range = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A model object generated by the function 'DTRreg()' or 'DWSurv()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A dataset (usually the data analyzed by DTRreg for which 
predicted outcomes are desired.  If a new dataset is provided, variable 
names should correspond to those presented to 'DTRreg()' or 'DWSurv()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.range</code></td>
<td>
<p>If treatment is continuous (rather than binary), a 
vectors of the form c(min,max) which specify the minimum and maximum value 
the treatment may take at stage 1.  
If unspecified, this will be inferred from the 
treat.range provided with use of the original DTRreg command.  As such, if 
no treatment range was specified there either, treat.range will be the 
minimum and maximum observed first stage treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Space for additional arguments (not currently used)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code class="reqn">n</code> x 1 matrix of predicted outcome values.
</p>


<h3>Author(s)</h3>

<p>Michael Wallace
</p>


<h3>References</h3>

<p>Chakraborty, B., Moodie, E. E. M. (2013) <em>Statistical Methods for 
Dynamic Treatment Regimes</em>. New York: Springer.
</p>
<p>Robins, J. M. (2004) <em>Optimal structural nested models for optimal 
sequential decisions</em>. In Proceedings of the Second Seattle Symposium on 
Biostatistics, D. Y. Lin and P. J. Heagerty (eds), 189-326. 
New York: Springer.
</p>
<p>Wallace, M. P., Moodie, E. M. (2015) Doubly-Robust Dynamic Treatment Regimen 
Estimation Via Weighted Least Squares. <em>Biometrics</em> <b>71</b>(3), 
636-644 (doi:10.1111/biom.12306.)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example single run of a 2-stage g-estimation analysis

set.seed(1)

# expit function
expit &lt;- function(x) { 1.0 / (1.0 + exp(-x)) }

# sample size
n &lt;- 10000

# variables (X = patient information, A = treatment)
X1 &lt;- rnorm(n)
A1 &lt;- rbinom(n, 1, expit(X1))
X2 &lt;- rnorm(n)
A2 &lt;- rbinom(n, 1, expit(X2))

# blip functions
gamma1 &lt;- A1 * (1 + X1)
gamma2 &lt;- A2 * (1 + X2)

# observed outcome: treatment-free outcome plus blip functions
Y &lt;- exp(X1) + exp(X2) + gamma1 + gamma2 + rnorm(n)

# models to be passed to DTRreg
# blip model
blip.mod &lt;- list(~ X1, ~ X2)
# treatment model (correctly specified)
treat.mod &lt;- list(A1 ~ X1, A2 ~ 1)
# treatment-free model (incorrectly specified)
tf.mod &lt;- list(~ X1, ~ X2)

# perform G-estimation
mod1 &lt;- DTRreg(twoStageCont$Y, blip.mod, treat.mod, tf.mod, 
               data = twoStageCont, method = "gest")
  
# predicted Y for optimal treatment
dat &lt;- data.frame(X1, X2, A1, A2)
predict(mod1, newdata = dat)
</code></pre>


</div>