<div class="container">

<table style="width: 100%;"><tr>
<td>HuberM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Safe (generalized) Huber M-Estimator of Location</h2>

<h3>Description</h3>

<p>(Generalized) Huber M-estimator of location with MAD scale, being
sensible also when the scale is zero where <code>huber()</code>
returns an error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">HuberM(x, k = 1.345, mu = median(x), s = mad(x, center = mu), 
       na.rm = FALSE, conf.level = NA, ci.type = c("wald", "boot"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>positive factor; the algorithm winsorizes at <code>k</code>
standard deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>initial location estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>scale estimator held constant through the iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical, indicating whether <code>NA</code> values should be stripped before the computation proceeds. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the interval. If set to <code>NA</code> (which is the default) no confidence interval will be calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.type</code></td>
<td>
<p>The type of confidence interval required. The value should be any subset 
of the values <code>"wald"</code>, <code>"boot"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> the dots are passed to the function <code>boot.ci</code>, when confidence intervalls are calculated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standard error is computed using the <code class="reqn">\tau</code> correction factor but no finite sample correction.<br> The original function is not exported, but can be accessed as <code>DescTools::.huberM</code>.

</p>


<h3>Value</h3>

<p>If <code>conf.level</code> is set to <code>NA</code> then the result will be  
</p>
<table><tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p> single numeric value</p>
</td>
</tr></table>
<p> and 
if a <code>conf.level</code> is provided, a named numeric vector with 3 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>huberm</code></td>
<td>
<p>the estimate for location</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwr.ci</code></td>
<td>
<p>lower bound of the confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upr.ci</code></td>
<td>
<p>upper bound of the confidence interval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Maechler, building on the MASS code mentioned.<br>
Andri Signorell &lt;andri@signorell.net&gt; (confidence intervals and interface)</p>


<h3>References</h3>

<p>Huber, P. J. (1981)
<em>Robust Statistics.</em>
Wiley.
</p>


<h3>See Also</h3>

<p><code>hubers</code> (and <code>huber</code>) in package <span class="pkg">MASS</span>;
<code>mad</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">HuberM(c(1:9, 1000))
mad   (c(1:9, 1000))

set.seed(7)
x &lt;- c(round(rnorm(1000), 1), round(rnorm(50, m=10, sd = 10)))
HuberM(x, conf.level=0.95)


## Not run: 

# scale zero
HuberM(rep(9, 100))
mad   (rep(9, 100))

# bootstrap confidence intervals
HuberM(x, conf.level=0.95, ci.type="boot")

## End(Not run)
 
</code></pre>


</div>