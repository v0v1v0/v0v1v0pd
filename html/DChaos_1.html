<div class="container">

<table style="width: 100%;"><tr>
<td>embedding</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Provides the delayed-coordinate embedding vectors backwards</h2>

<h3>Description</h3>

<p>This function generates both the uniform and non-uniform embedding vectors backwards using the method of delays from univariate time-series data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">embedding(x, m = 2, lag = 1, timelapse = c("FIXED", "VARIABLE"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>vector</code>, a time-series object <code>ts</code> or <code>xts</code>, a <code>data.frame</code>, a <code>data.table</code> or a <code>matrix</code> depending on the method selected in <code>timelapse</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a non-negative integer denoting the embedding dimension (Default 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>a non-negative integer denoting the reconstruction delay (Default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timelapse</code></td>
<td>
<p>a character denoting if the time-series data are sampled at uniform time-frequency e.g., 1-month, 1-day, 1-hour, 30-min, 5-min, 1-min and so on <code>FIXED</code> or non-uniform time-frequency which are not equally spaced in time <code>VARIABLE</code> (Default <code>FIXED</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The uniform or non-uniform delayed-coordinate embedding vectors backwards by columns from an univariate time-series data considering the parameter set selected by the user. If <code>FIXED</code> has been selected <code>data</code> must be a <code>vector</code> or a time-series object <code>ts</code> or <code>xts</code>. Otherwise <code>VARIABLE</code> has to be specified. In this case <code>data</code> must be a <code>data.frame</code>, a <code>data.table</code> or a <code>matrix</code> with two columns, the date and the univariate time series as a sequence of numerical values, in that order. The date can have the following three classes: <code>POSIXt</code>, <code>Date</code> or <code>Factor</code>. In the latter case the date should come in the following format <code>YMD H:M:OS3</code> considering milliseconds e.g., 20190407 00:00:03.347. If you don't consider milliseconds you must put .000 after the seconds.
</p>


<h3>Note</h3>

<p>Note that a key point to create a suitable reconstruction of the state-space is to fix a criteria in order to estimate the embedding parameters. Researchers usually estimate them using heuristic approaches based on prescriptions proposed by e.g., H.D. Abarbanel (1996) or H. Kantz and T. Schreiber (2004). The main drawbacks of these heuristic approaches are the following: they are not intrinsically statistical; their results are not robust; they lead to estimators whose properties are unknown or largely unexplored; they do not take into account the results of any model fit. The alternative proposed by the statistical approach solves those disadvantages. The statistical approach to state-space reconstruction can be viewed as a best subset selection problem within the nonparametric regression context as argued K.-S. Chan and H. Tong (2001). The DChaos package allows the R users to choose between both methods. By default it uses the statistical approach based on model selection procedures instead of heuristic techniques, see <code>netfit</code> function.
</p>


<h3>Author(s)</h3>

<p>Julio E. Sandubete, Lorenzo Escot
</p>


<h3>References</h3>

<p>Ruelle, D., Takens, F. 1971 On the nature of turbulence. Communications in Mathematical Physics 20(3):167-192.
</p>
<p>Takens, F. 1981 Detecting strange attractors in turbulence. Springer Berlin Heidelberg.
</p>
<p>Abarbanel, H.D. 1996 Analysis of observed chaotic data. Springer.
</p>
<p>Cha, K.-S., Tong, H. 2001 Chaos: a statistical perspective. Springer-Verlag.
</p>
<p>Kantz, H., Schreiber, T. 2004 Nonlinear time series analysis, volume 7. Cambridge university press.
</p>
<p>Huke, J.P., Broomhead, D.S. 2007 Embedding theorems for non-uniformly sampled dynamical systems. Nonlinearity 20(9):205-244.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## set.seed(34)
## Simulates time-series data from the Logistic map with chaos
## ts        &lt;- DChaos::logistic.sim(n=1000, a=4)
## show(head(ts, 5))

## Provides the uniform delayed-coordinate embedding vectors (Backward)
## data      &lt;- DChaos::embedding(ts, m=5, lag=2, timelapse="FIXED")
## show(head(data, 5))

## Simulates tick-by-tick data (bid price) for Starbucks company
## ts        &lt;- highfrequency::sbux
## show(head(ts, 5))

## Provides the non-uniform delayed-coordinate embedding vectors (Backward)
## data      &lt;- DChaos::embedding(ts, m=3, lag=4, timelapse="VARIABLE")
## show(head(data, 5))
</code></pre>


</div>