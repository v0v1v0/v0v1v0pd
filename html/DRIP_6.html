<div class="container">

<table style="width: 100%;"><tr>
<td>JPLLK_surface</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jump-Preserving Local Linear Kernel Smoothing</h2>

<h3>Description</h3>

<p>Estimate surface using piecewise local linear kernel smoothing.
The bandwidth is chosen by leave-one-out cross validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">JPLLK_surface(image, bandwidth, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>A square matrix, no missing value allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>A numeric vector of positive integers, which
specifies the number of pixels used in the local smoothing. The 
final fitted surface uses the optimal bandwidth chosen from
those provided by users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If plot = TRUE, the image of the fitted surface is
plotted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At each pixel, the gradient is estimated by a local linear
kernel smoothing procedure. Next, the local neighborhood is
divided into two halves along the direction perpendicular to
(<code class="reqn">\widehat{f}'_{x}</code>, <code class="reqn">\widehat{f}'_{y}</code>). Then the one-
sided local linear kernel (LLK) estimates are obtained in the
two half neighborhoods respectively. Among these two one-sided
estimates, the one with smaller weighted mean square error is
chosen to be the final estimate of the regression surface at the
pixel.
</p>


<h3>Value</h3>

<p>A list of fitted values, residuals, chosen bandwidth and
estimated sigma.
</p>


<h3>References</h3>

<p>Qiu, P. (2009) "Jump-Preserving Surface Reconstruction from Noisy Data", <em>Annals of the Institute of Statistical Mathematics</em>, <b>61</b>(3), 715 â€“ 751, <a href="https://doi.org/10.1007/s10463-007-0166-9">doi:10.1007/s10463-007-0166-9</a>.
</p>


<h3>See Also</h3>

<p><code>threeStage</code>, <code>surfaceCluster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sar) # SAR image is bundled with the package and it is a 
          # standard test image in statistics literature.
fit &lt;- JPLLK_surface(image=sar, bandwidth=c(3, 4))
</code></pre>


</div>