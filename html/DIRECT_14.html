<div class="container">

<table style="width: 100%;"><tr>
<td>resampleClusterProb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Resampling to Estimate Posterior Allocation Probability Matrix 
</h2>

<h3>Description</h3>

<p>The resampling method as part of the posterior inference under <code>DIRECT</code>.  It uses stored MCMC samples to generate realizations of the allocation probability matrix, and writes the realizations to a user-specified external file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">resampleClusterProb(file.out, ts, nitem, ntime, nrep, 
    pars.mcmc, cs.mcmc, alpha.mcmc, nstart, nres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file.out</code></td>
<td>

<p>Name of file containing samples of posterior allocation probability matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>A <code>nitem</code>-by-<code>ntime</code>-by-<code>nrep</code> array of data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitem</code></td>
<td>

<p>Number of items.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntime</code></td>
<td>

<p>Number of time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Number of replicates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars.mcmc</code></td>
<td>

<p>A matrix or data frame of MCMC samples of mean vectors and random effects stored in file *_mcmc_pars.out, one of the output files from <code>DPMCMC</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cs.mcmc</code></td>
<td>

<p>A matrix or data frame of MCMC samples of assignments of mixture components stored in file *_mcmc_cs.out, one of the output files from <code>DPMCMC</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.mcmc</code></td>
<td>

<p>A vector of MCMC samples of <code class="reqn">\alpha</code>, the concentration parameter in the Dirichlet-process prior, stored in the last column of file *_mcmc_cs.out, one of the output files from <code>DPMCMC</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>

<p>Starting from which recorded MCMC sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nres</code></td>
<td>

<p>How many times to draw resamples?  Multiple samples are averaged.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Samples of the allocation probability matrix are written to file *_mcmc_probs.out.  This file contains a large matrix of <code class="reqn">HN \times K</code>, which is <code class="reqn">H</code> posterior allocation probability matrices stacked up, each individual matrix of <code class="reqn">N \times K</code>, where <code class="reqn">H</code> is the number of recorded MCMC samples, <code class="reqn">N</code> the number of items and <code class="reqn">K</code> the inferred number of mixture components.</p>


<h3>Note</h3>

<p><code>resampleClusterProb</code> calls the following functions adapted or directly taken from existing R functions:
</p>

<ul>
<li> <p><code>dMVNorm</code> is adapted from <code>dmvnorm</code> by Friedrich Leisch and Fabian Scheipl in package <code>mvtnorm</code>.
</p>
</li>
<li> <p><code>rMVNorm</code> is adapted from <code>rmvnorm</code> by Friedrich Leisch and Fabian Scheipl in package <code>mvtnorm</code>.
</p>
</li>
<li> <p><code>rDirichlet</code> is taken from <code>rdirichlet</code> by Gregory R. Warnes, Ben Bolker and Ian Wilson in package <code>gregmisc</code>.
</p>
</li>
<li> <p><code>dDirichlet</code> is based on <code>ddirichlet</code> by Gregory R. Warnes, Ben Bolker and Ian Wilson in package <code>gregmisc</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Audrey Q. Fu
</p>


<h3>References</h3>

<p>Fu, A. Q., Russell, S., Bray, S. and Tavare, S. (2013) Bayesian clustering of replicated time-course gene expression data with weak signals. The Annals of Applied Statistics. 7(3) 1334-1361.
</p>


<h3>See Also</h3>

<p><code>DIRECT</code> for the complete method.
</p>
<p><code>DPMCMC</code> for the MCMC sampler under the Dirichlet-process prior.
</p>
<p><code>relabel</code> for relabeling in posterior inference.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See example for DIRECT.
</code></pre>


</div>