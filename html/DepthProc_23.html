<div class="container">

<table style="width: 100%;"><tr>
<td>depth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Depth calculation</h2>

<h3>Description</h3>

<p>Calculate depth functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">depth(u, X, method = "Projection", threads = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Numerical vector or matrix whose depth is to be calculated. Dimension has to be the same as that of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The data as a matrix, data frame or list. If it is a matrix or data frame, then each row is viewed as one multivariate observation. If it is a list, all components must be numerical vectors of equal length (coordinates of observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string which determines the depth function. <code>method</code> can be "Projection" (the default), "Mahalanobis", "Euclidean" or "Tukey". For details see <code>depth</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>number of threads used in parallel computations. Default value -1 means that all possible cores will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameters specific to method — see <code>depthEuclid</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Mahalanobis depth </p>
<p style="text-align: center;"><code class="reqn"> {D}_{MAH}(y, {X} ^ {n}) = \frac{ 1 }{ 1 + {{(y - \bar{x})} ^ {T}}{{S} ^ {-1}}(y - \bar{x}) }, </code>
</p>
<p> where <code class="reqn"> S </code> denotes the sample covariance matrix <code class="reqn"> {X} ^ {n} </code>.
</p>
<p>A symmetric projection depth <code class="reqn"> D\left( x, X\right) </code> of a point <code class="reqn"> x \in {{{R}} ^ {d}} </code>, <code class="reqn"> d \ge 1 </code> is defined as
</p>
<p style="text-align: center;"><code class="reqn"> D\left( x, X\right)_{PRO} = {{\left[ 1 + su{{p}_{\left\| u \right\| = 1}}\frac{ \left| {{u} ^ {T}}x - Med\left( {{u} ^ {T}}X\right)\right| }{ MAD\left( {{u} ^ {T}}X\right) }\right]} ^ {-1}}, </code>
</p>

<p>where Med denotes the univariate median, <code class="reqn"> MAD\left( Z \right) </code> = <code class="reqn"> Med\left(\left| Z - Med\left( Z \right)\right|\right) </code>. Its sample version denoted by <code class="reqn"> D\left( x, {X} ^ {n} \right) </code> or <code class="reqn"> D\left( x, {X} ^ {n} \right) </code> is obtained by replacing <code class="reqn"> F </code> by its empirical counterpart <code class="reqn"> {{F}_{n}} </code> calculated from the sample <code class="reqn"> {X} ^ {n} </code> .
</p>
<p>Next interesting depth is the weighted <code class="reqn"> {L} ^ {p} </code> depth. The weighted <code class="reqn"> {L} ^ {p} </code> depth <code class="reqn"> D({x}, F) </code> of a point <code class="reqn"> {x} \in {R} ^ {d} </code>, <code class="reqn"> d \ge 1 </code> generated by <code class="reqn"> d </code> dimensional random vector <code class="reqn"> {X} </code> with distribution <code class="reqn"> F </code>, is defined as <code class="reqn"> D({x}, F) = \frac{1 }{ 1 + Ew({{\left\| x - X \right\| }_{p}}) }, </code> where <code class="reqn"> w </code> is a suitable weight function on <code class="reqn"> [0, \infty) </code>, and <code class="reqn"> {{\left\| \cdot \right\| }_{p}} </code> stands for the <code class="reqn"> {L} ^ {p} </code> norm (when p = 2 we have usual Euclidean norm). We assume that <code class="reqn"> w </code> is non-decreasing and continuous on <code class="reqn"> [0, \infty) </code> with <code class="reqn"> w(\infty-) = \infty </code>, and for <code class="reqn"> a, b \in {{{R}} ^ {d}} </code> satisfying <code class="reqn"> w(\left\| a + b \right\|) \le w(\left\| a \right\|) + w(\left\| b \right\|) </code>. Examples of the weight functions are: <code class="reqn"> w(x) = a + bx </code>, <code class="reqn"> a, b &gt; 0 </code> or <code class="reqn"> w(x) = {x} ^ {\alpha} </code>. The empirical version of the weighted <code class="reqn"> {L} ^ {p} </code> depth is obtained by replacing distribution <code class="reqn"> F </code> of <code class="reqn"> {X} </code> in <code class="reqn"> Ew({{\left\| {x} - {X} \right\| }_{p}}) = \int {w({{\left\| x - t \right\| }_{p}})}dF(t) </code> by its empirical counterpart calculated from the sample <code class="reqn"> {{{X}} ^ {n}} </code>...
</p>
<p>The Projection and Tukey's depths are calculated using an approximate algorithm. Calculations of Mahalanobis, Euclidean and <code class="reqn"> L ^ p </code> depths are exact. Returns the depth of multivariate point u with respect to data set X.
</p>


<h3>Author(s)</h3>

<p>Daniel Kosiorowski, Mateusz Bocian, Anna Wegrzynkiewicz and Zygmunt Zawadzki from Cracow University of Economics.
</p>


<h3>References</h3>

<p>Liu, R.Y., Parelius, J.M. and Singh, K. (1999), Multivariate analysis by data depth: Descriptive statistics, graphics and inference (with discussion), Ann. Statist., 27, 783–858.
</p>
<p>Mosler K (2013). Depth statistics. In C Becker, R Fried, K S (eds.), Robustness and Complex Data Structures, Festschrift in Honour of Ursula Gather, pp. 17–34. Springer.
</p>
<p>Rousseeuw, P.J. and Struyf, A. (1998), Computing location depth and regression depth in higher dimensions, Stat. Comput., 8, 193–203.
</p>
<p>Zuo, Y. and Serfling, R. (2000), General Notions of Statistical Depth Functions, Ann. Statist., 28, no. 2, 461–482.
</p>


<h3>See Also</h3>

<p><code>depthContour</code> and <code>depthPersp</code> for depth graphics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(robustbase)

# Calculation of Projection depth
data(starsCYG, package = "robustbase")
depth(t(colMeans(starsCYG)), starsCYG)

# Also for matrices
depth(starsCYG, starsCYG)

# Projection depth applied to a large bivariate data set
x &lt;- matrix(rnorm(9999), nc = 3)
depth(x, x)

</code></pre>


</div>