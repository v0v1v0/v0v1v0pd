<div class="container">

<table style="width: 100%;"><tr>
<td>XLDateToPOSIXct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Excel Dates to POSIXct

</h2>

<h3>Description</h3>

<p>As I repeatedly forgot how to convert Excel dates to POSIX here's the specific function.

</p>


<h3>Usage</h3>

<pre><code class="language-R">XLDateToPOSIXct(x, tz = "GMT", xl1904 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the integer vector to be converted.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tz</code></td>
<td>
<p>a time zone specification to be used for the conversion, if one is required. See <code>as.POSIXct</code>.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xl1904</code></td>
<td>
<p>logical, defining if the unspeakable 1904-system should be used. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>XLGetRange</code> will return dates as integer values, because XL stores them as integers. An Excel date can be converted with the (unusual) origin of
<code>as.Date(myDate, origin="1899-12-30")</code>, which is implemented here.

</p>
<p>Microsoft Excel supports two different date systems, the 1900 date system and the 1904 date system. In the 1900 date system, the first day that is supported is January 1, 1900. A date is converted into a serial number that represents the number of elapsed days since January 1, 1900. In the 1904 date system, the first day that is supported is January 1, 1904. By default, Microsoft Excel for the Macintosh uses the 1904 date system, Excel for Windows the 1900 system.
See also: https://support.microsoft.com/en-us/kb/214330.
</p>


<h3>Value</h3>

<p>return an object of the class POSIXct. Date-times known to be invalid will be returned as NA.





</p>


<h3>Author(s)</h3>

<p>Andri Signorell &lt;andri@signorell.net&gt;

</p>


<h3>See Also</h3>

<p><code>as.POSIXct</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">XLDateToPOSIXct(41025)
XLDateToPOSIXct(c(41025.23, 41035.52))
</code></pre>


</div>