<div class="container">

<table style="width: 100%;"><tr>
<td>fac.vcmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>forms the variance matrix for the variance component of a (generalized) factor</h2>

<h3>Description</h3>

<p>Form the variance matrix for a (generalized) factor whose effects 
for its different levels are independently and identically distributed, with 
their variance given by the variance component; elements of the matrix will 
equal either zero or sigma2 and displays compound symmetry.</p>


<h3>Usage</h3>

<pre><code class="language-R">fac.vcmat(factor, sigma2)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>The (generalized) <code>factor</code> for which the variance 
matrix is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>The variance component, being the of the random effects for the 
factor.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method is:
a) form the n x n summation or relationship matrix whose elements are equal 
to zero except for those elements whose corresponding elements in the 
following two n x n matrices are equal: 1) each row contains the numeric 
values corresponding to the observed levels of the factor, and 2) each 
column contains the numeric values corresponding to the observed levels 
of the factor, 
b) multiply the summation matrix by sigma2.
</p>


<h3>Value</h3>

<p>An n x n <code>matrix</code>, where n is the length of the 
<code>factor</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>fac.ar1mat</code>,  <code>fac.meanop</code>, 
<code>fac.sumop</code> in package <span class="pkg">dae</span>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## set up a two-level factor and a three-level factor, both of length 12
A &lt;- factor(rep(1:2, each=6))
B &lt;- factor(rep(1:3, each=2, times=2))

## create a 12 x 12 ar1 matrix corrresponding to B
vc.B &lt;- fac.vcmat(B, 2)
</code></pre>


</div>