<div class="container">

<table style="width: 100%;"><tr>
<td>P6c</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

A six parameter model
</h2>

<h3>Description</h3>


<p>An exponential decay followed by a second exponential decay.</p>


<h3>Usage</h3>

<pre><code class="language-R">P6c(a, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>


<p>An array of parameters;

</p>

<table>
<tr>
<td style="text-align: left;">
a: </td>
<td style="text-align: left;"> parameter  </td>
<td style="text-align: center;"> Units</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">
a[1]: </td>
<td style="text-align: left;"> absolute (rod) threshold  </td>
<td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
<td style="text-align: left;">
a[2]: </td>
<td style="text-align: left;"> cone coefficient </td>
<td style="text-align: center;"> (log10 lum)</td>
</tr>
<tr>
<td style="text-align: left;">
a[3]: </td>
<td style="text-align: left;"> 1/cone time constant  </td>
<td style="text-align: center;"> (1/minutes)</td>
</tr>
<tr>
<td style="text-align: left;">
a[4]: </td>
<td style="text-align: left;"> alpha point  </td>
<td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
<td style="text-align: left;">
a[5]: </td>
<td style="text-align: left;"> absolute threshold offset </td>
<td style="text-align: center;"> (log10 lum)</td>
</tr>
<tr>
<td style="text-align: left;">
a[6]: </td>
<td style="text-align: left;"> 1/rod time constant  </td>
<td style="text-align: center;"> (1/minutes)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>note that the cone threshold is a[1] + a[5] log10(lum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> The times in minutes when the model predicts thresholds. 

</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>This function has three roles, to calculate the thresholds for given parameters <code>a</code> and times <code>X</code>.  If missing <code>X</code>, then the function calls the values <code>x</code> and <code>y</code> from the <code>.Globalenv</code> and calculates the sum of residuals squared error (SSE) for <code>a</code>. If <code>a</code> is an array of length <code>1L</code> or <code>boolean</code> then a description of the model is returned.
</p>
<p>The use of the function <code>H</code> rather than an impulse function gives a three-fold increase is speed for the <code>optim</code> function.
</p>


<h3>Value</h3>

<p>The output depends upon the input. 
If the input is an array of length <code>1L</code> or a <code>boolean</code> then a list is returned 


</p>
<table>
<tr style="vertical-align: top;">
<td><code>Pn </code></td>
<td>
<p>number of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mod </code></td>
<td>
<p>name of the model</p>
</td>
</tr>
</table>
<p>If a parameter array is passed then the sum of residuals squared is calculated. This is used by <code>optim</code> to optimise the parameter estimates. 
</p>
<p>Passing a parameter array and a series of putative times causes the function to return predicted thresholds. 

</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>See Also</h3>


<p><code>P3</code>,<code>P5c</code>,<code>P6c</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
x &lt;- 0:20
a &lt;- c(-2, 2, 1/2, 10, 3, 1/8)

# P6c(TRUE)
# Describes the model

# P6c(a)
# The sum of squared residuals

# P6c(a,x)
# The fitted thresholds for given parameters 'a' and times 'x'

</code></pre>


</div>