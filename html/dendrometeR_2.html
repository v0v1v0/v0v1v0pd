<div class="container">

<table style="width: 100%;"><tr>
<td>cycle_stats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define stem cycles and calculate statistics for all cyclic phases</h2>

<h3>Description</h3>

<p>The function defines stem cycles from output of <code>phase_def</code> and calculates statistics for complete cycles as well as for the phases of contraction, expansion and stem-radius increment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cycle_stats(dm.gpf, dm.phase, sensor = 1, smooth.param = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dm.gpf</code></td>
<td>
<p>a <code>data.frame</code> with either gap-free or gap-filled dendrometer series as produced by <code>fill_gaps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dm.phase</code></td>
<td>
<p>a <code>data.frame</code> with numbers indicating the different stem-cyclic phases. Output of <code>phase_def</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensor</code></td>
<td>
<p>a <code>numeric</code> specifying the sensor to be used in the function. Defaults to 1 (first column in both <code>data.frames</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.param</code></td>
<td>
<p>a <code>numeric</code> specifying the degree of smoothing. Defaults to 1 (no smoothing).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses the output of <code>phase_def</code> to define stem cycles and to calculate statistics for all cyclic phases. These statistics include the timing and duration of each phase, as well as information on stem-size changes. The function works for single dendrometer series, which are defined by the argument <code>sensor</code>.
</p>
<p>The function includes a smoothing option (argument <code>smooth.param</code>) particularly for noisy datasets in which outliers may under- or overestimate the minimum and maximum stem size within phases and stem cycles. By default, no smoothing is performed.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> with:
</p>
<ul><li>
<p>a <code>data.frame</code> named <code>cycleStats</code> containing the following summary statistics:</p>
</li></ul>
<table>
<tr style="vertical-align: top;">
<td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycle</code></td>
<td>
<p>cycle number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>cyclic phase (1: contraction, 2: expansion, 3: stem-radius increment, 4: full cycle).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>timestamp indicating the beginning of each phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>timestamp indicating the end of each phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_h</code></td>
<td>
<p>phase duration in hours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration_m</code></td>
<td>
<p>phase duration in minutes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>magnitude</code></td>
<td>
<p>magnitude of stem-size changes in each phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p>minimum stem size within each phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>maximum stem size within each phase.</p>
</td>
</tr>
</table>
<ul><li>
<p>a <code>data.frame</code> named <code>cycle.df</code> containing, for all individual records, the following columns:</p>
</li></ul>
<table>
<tr style="vertical-align: top;">
<td><code>dmID</code></td>
<td>
<p>dendrometer ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycle</code></td>
<td>
<p>cycle number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>cyclic phase (1: contraction, 2: expansion, 3: stem-radius increment, 4: full cycle).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Olivier Bouriaud, Ernst van der Maaten and Marieke van der Maaten-Theunissen.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dmCD)
dm.phase &lt;- phase_def(dmCD)
dm.stats &lt;- cycle_stats(dmCD, dm.phase)

</code></pre>


</div>