<div class="container">

<table style="width: 100%;"><tr>
<td>FIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Fast) Fixed-Interval Smoother (Kalman Smoother)</h2>

<h3>Description</h3>

<p>(Fast) Fixed-Interval Smoother (Kalman Smoother)
</p>


<h3>Usage</h3>

<pre><code class="language-R">FIS(A, F, F_pred, P, P_pred, F_0 = NULL, P_0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>transition matrix (<code class="reqn">rp \times rp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>state estimates (<code class="reqn">T \times rp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F_pred</code></td>
<td>
<p>state predicted estimates (<code class="reqn">T \times rp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>variance estimates (<code class="reqn">rp \times rp \times T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_pred</code></td>
<td>
<p>predicted variance estimates (<code class="reqn">rp \times rp \times T</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F_0</code></td>
<td>
<p>initial state vector (<code class="reqn">rp \times 1</code>) or empty (<code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_0</code></td>
<td>
<p>initial state covariance (<code class="reqn">rp \times rp</code>) or empty (<code>NULL</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Kalman Smoother is given by:
</p>
<p style="text-align: center;"><code class="reqn">\textbf{J}_t = \textbf{P}_t \textbf{A} + inv(\textbf{P}^{pred}_{t+1})</code>
</p>

<p style="text-align: center;"><code class="reqn">\textbf{F}^{smooth}_t = \textbf{F}_t + \textbf{J}_t (\textbf{F}^{smooth}_{t+1} - \textbf{F}^{pred}_{t+1})</code>
</p>

<p style="text-align: center;"><code class="reqn">\textbf{P}^{smooth}_t = \textbf{P}_t + \textbf{J}_t (\textbf{P}^{smooth}_{t+1} - \textbf{P}^{pred}_{t+1}) \textbf{J}_t'</code>
</p>

<p>The initial smoothed values for period t = T are set equal to the filtered values. If <code>F_0</code> and <code>P_0</code> are supplied, the smoothed initial conditions (t = 0 values) are also calculated and returned.
For further details see any textbook on time series such as Shumway &amp; Stoffer (2017), which provide an analogous R implementation in <code>astsa::Ksmooth0</code>.
</p>


<h3>Value</h3>

<p>Smoothed state and covariance estimates, including initial (t = 0) values.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>F_smooth</code></td>
<td>
<p><code class="reqn">T \times rp</code> smoothed state vectors, equal to the filtered state in period <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_smooth</code></td>
<td>
<p><code class="reqn">rp \times rp \times T</code> smoothed state covariance, equal to the filtered covariance in period <code class="reqn">T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F_smooth_0</code></td>
<td>
<p><code class="reqn">1 \times rp</code> initial smoothed state vectors, based on <code>F_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_smooth_0</code></td>
<td>
<p><code class="reqn">rp \times rp</code> initial smoothed state covariance, based on <code>P_0</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Shumway, R. H., &amp; Stoffer, D. S. (2017). Time Series Analysis and Its Applications: With R Examples. Springer.
</p>
<p>Harvey, A. C. (1990). Forecasting, structural time series models and the Kalman filter.
</p>


<h3>See Also</h3>

<p><code>SKF</code> <code>SKFS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See ?SKFS

</code></pre>


</div>