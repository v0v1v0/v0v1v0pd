<div class="container">

<table style="width: 100%;"><tr>
<td>DensityScatter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Scatter plot with densities
</h2>

<h3>Description</h3>

<p>Density estimation is performed by (PDE) [Ultsch, 2005] or "SDH" [Eilers/Goeman, 2004] and visualized in a  density scatter plot [Brinkmann et al., 2023] in which the points are colored by their density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DensityScatter(X,Y,DensityEstimation="SDH",

Type="DDCAL", Plotter = "native",Marginals = FALSE,

SampleSize,na.rm=FALSE, xlab, ylab, 

main="DensityScatter", AddString2lab="",
                        
xlim, ylim,NoBinsOrPareto=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Numeric vector [1:n], first feature (for x axis values)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Numeric vector [1:n], second feature (for y axis values)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DensityEstimation</code></td>
<td>

<p>(Optional), <code>"SDH"</code> is very fast but maybe not correct, <code>"PDE"</code> is slow but proably more correct, third alternativ is the typical R density estimation with <code>"kde2d"</code> which is sensitive to parameters
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>

<p>(Optional), <code>"DDCAL"</code> uses a new density to point color matching by DDCAL algorithm [Lux/Rinderle-Ma, 2023] , <code>"native"</code> uses a simple density to point color matching
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plotter</code></td>
<td>

<p>in case of <code>Type="DDCAL"</code>, (Optional) String, name of the plotting backend to use. Possible values are: "<code>native</code>","<code>plotly</code>", or "<code>ggplot2</code>"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Marginals</code></td>
<td>

<p>(Optional) Boolean, if TRUE the marginal distributions of X and Y will be plotted together with the 2D density of X and Y. Default is FALSE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SampleSize</code></td>
<td>

<p>(Optional), Numeric, positiv scalar, maximum size of the sample used for calculation. High values increase runtime significantly. The default is that no sample is drawn
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>(Optional), Function may not work with non finite values. If these cases should be automatically removed, set parameter TRUE
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>(Optional), String, title of the x axis. Default: "X",   see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>(Optional), String, title of the y axis. Default: "Y",   see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>(Optional), string, the same as "main" in <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AddString2lab</code></td>
<td>

<p>(Optional), adds the same string of information to x and y axis label, e.g. usefull for adding SI units
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>(Optional), in case of <code>Type="natuive"</code>, see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>in case of <code>Type="natuive"</code>, see <code>plot()</code> function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NoBinsOrPareto</code></td>
<td>

<p>(Optional), in case of <code>Type="natuive"</code>, Density specifc parameters, for <code>PDEscatter(ParetoRadius)</code> or SDH (nbins)) or kde2d(bins)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>(Optional), further arguments either to ScatterDenstiy::DensityScatter.DDCAL or to plot()
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>DensityScatter</code> function generates the density of the xy data as a z coordinate. Afterwards xy points will be plotted as a scatter plot, where the z values defines the coloring of the xy points. It assumens that the cases of x and y are mapped to each other meaning that a <code>cbind(x,y)</code> operation is allowed.
This function plots the Density on top of a scatterplot. Variances of x and y should not differ by extreme numbers, otherwise calculate the percentiles on both first.
</p>


<h3>Value</h3>

<p>List of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric vector [1:m],m&lt;=n, first feature used in the plot or the kernels used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric vector [1:m],m&lt;=n, second feature used in the plot or the kernels used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Densities</code></td>
<td>
<p>Number of points within the ParetoRadius of each point, i.e. density information</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>MT contributed with several adjustments
</p>


<h3>Author(s)</h3>

<p>Felix Pape
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, (Ultsch, A. &amp; Huellermeier, E. Eds., 10.1007/978-3-658-20540-9), Doctoral dissertation, Heidelberg, Springer, ISBN: 978-3658205393, 2018.
</p>
<p>[Thrun/Ultsch, 2018] Thrun, M. C., &amp; Ultsch, A. : Effects of the payout system of income taxes to municipalities in Germany, in Papiez, M. &amp; Smiech,, S. (eds.), Proc. 12th Professor Aleksander Zelias International Conference on Modelling and Forecasting of Socio-Economic Phenomena, pp. 533-542, Cracow: Foundation of the Cracow University of Economics, Cracow, Poland, 2018. 
</p>
<p>[Ultsch, 2005]  Ultsch, A.: Pareto density estimation: A density estimation for knowledge discovery, In Baier, D. &amp; Werrnecke, K. D. (Eds.), Innovations in classification, data science, and information systems, (Vol. 27, pp. 91-100), Berlin, Germany, Springer, 2005.
</p>
<p>[Eilers/Goeman, 2004]  Eilers, P. H., &amp; Goeman, J. J.: Enhancing scatterplots with smoothed densities, Bioinformatics, Vol. 20(5), pp. 623-628. 2004
</p>
<p>[Lux/Rinderle-Ma, 2023]  Lux, M. &amp; Rinderle-Ma, S.: DDCAL: Evenly Distributing Data into Low Variance Clusters Based on Iterative Feature Scaling, Journal of Classification vol. 40, pp. 106-144, 2023.
</p>
<p>[Brinkmann et al., 2023]  Brinkmann, L., Stier, Q., &amp; Thrun, M. C.: Computing Sensitive Color Transitions for the Identification of Two-Dimensional Structures, Proc. Data Science, Statistics &amp; Visualisation (DSSV) and the European Conference on Data Analysis (ECDA), p.109, Antwerp, Belgium, July 5-7, 2023. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">#taken from [Thrun/Ultsch, 2018]
data("ITS")
data("MTY")
Inds=which(ITS&lt;900&amp;MTY&lt;8000)
plot(ITS[Inds],MTY[Inds],main='Bimodality is not visible in normal scatter plot')

DensityScatter(ITS[Inds],MTY[Inds],DensityEstimation="SDH",xlab = 'ITS in EUR',

ylab ='MTY in EUR' ,main='Smoothed Densities histogram indicates Bimodality' )

DensityScatter(ITS[Inds],MTY[Inds],DensityEstimation="PDE",xlab = 'ITS in EUR',

ylab ='MTY in EUR' ,main='PDE indicates Bimodality' )


</code></pre>


</div>