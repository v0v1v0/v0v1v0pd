<div class="container">

<table style="width: 100%;"><tr>
<td>tpm.direct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert countsMatrix and geneLength to TPM units</h2>

<h3>Description</h3>

<p>Takes a countsMatrix and geneLength as input and converts to TPM units using the equation from
<a href="https://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/">Harold Pimental</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tpm.direct(countsMatrix, geneLength, collapse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>countsMatrix</code></td>
<td>
<p>A numeric matrix of N genes x M samples. All columns must be numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneLength</code></td>
<td>
<p>Numeric matrix of gene lengths. Often the ExonLength item of a DGEobj.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>Default = FALSE. TRUE or FALSE determines whether to use rowMeans on the geneLength matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The result should be the same as using convertCounts with normalize = 'tpm' and log = FALSE.
</p>
<p>geneLength can be a vector (length == nrow(countsMatrix)) or a matrix (same dim as countsMatrix).
The geneLength is used as is, or optionally collapsed to a vector by rowMeans.
</p>


<h3>Value</h3>

<p>A matrix of TPM values
</p>


<h3>Examples</h3>

<pre><code class="language-R">   dgeObj &lt;- readRDS(system.file("exampleObj.RDS", package = "DGEobj"))

   counts &lt;- DGEobj::getItem(dgeObj, "counts")
   exonLength &lt;- dgeObj$geneData$ExonLength
   tpm &lt;- tpm.direct(counts, geneLength = exonLength)

</code></pre>


</div>