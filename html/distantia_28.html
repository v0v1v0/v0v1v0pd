<div class="container">

<table style="width: 100%;"><tr>
<td>workflowPsi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the dissimilarity measure <em>psi</em> on two or more sequences.</h2>

<h3>Description</h3>

<p>If the sequences are not aligned (<code>paired.samples = FALSE</code>), the function executes these steps.
</p>

<ul>
<li>
<p> Computes the autosum of the sequences with <code>autoSum</code>.
</p>
</li>
<li>
<p> Computes the distance matrix with <code>distanceMatrix</code>.
</p>
</li>
<li>
<p> Uses the distance matrix to compute the least cost matrix with <code>leastCostMatrix</code>.
</p>
</li>
<li>
<p> Extracts the cost of the least cost path with <code>leastCost</code>.
</p>
</li>
<li>
<p> Computes the dissimilarity measure <em>psi</em> with the function <code>psi</code>.
</p>
</li>
<li>
<p> Delivers an output of type "list" (default), "data.frame" or "matrix", depending on the user input, through <code>formatPsi</code>.
</p>
</li>
</ul>
<p>If the sequences are aligned (<code>paired.samples = TRUE</code>), these steps are executed:
</p>

<ul>
<li>
<p> Computes the autosum of the sequences with <code>autoSum</code>.
</p>
</li>
<li>
<p> Sums the distances between paired samples with <code>distancePairedSamples</code>.
</p>
</li>
<li>
<p> Computes the dissimilarity measure <em>psi</em> with the function <code>psi</code>.
</p>
</li>
<li>
<p> Delivers an output of type "list" (default), "data.frame" or "matrix", depending on the user input, through <code>formatPsi</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">workflowPsi(
  sequences = NULL,
  grouping.column = NULL,
  time.column = NULL,
  exclude.columns = NULL,
  method = "manhattan",
  diagonal = FALSE,
  format = "dataframe",
  paired.samples = FALSE,
  same.time = FALSE,
  ignore.blocks = FALSE,
  parallel.execution = TRUE
  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sequences</code></td>
<td>
<p>dataframe with multiple sequences identified by a grouping column generated by <code>prepareSequences</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping.column</code></td>
<td>
<p>character string, name of the column in <code>sequences</code> to be used to identify separates sequences within the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.column</code></td>
<td>
<p>character string, name of the column with time/depth/rank data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.columns</code></td>
<td>
<p>character string or character vector with column names in <code>sequences</code> to be excluded from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string naming a distance metric. Valid entries are: "manhattan", "euclidean", "chi", and "hellinger". Invalid entries will throw an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal</code></td>
<td>
<p>boolean, if <code>TRUE</code>, diagonals are included in the computation of the least cost path. Defaults to <code>FALSE</code>, as the original algorithm did not include diagonals in the computation of the least cost path. If <code>paired.samples</code> is <code>TRUE</code>, then <code>diagonal</code> is irrelevant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>string, type of output. One of: "data.frame", "matrix". If <code>NULL</code> or empty, a list is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired.samples</code></td>
<td>
<p>boolean, if <code>TRUE</code>, the sequences are assumed to be aligned, and distances are computed for paired-samples only (no distance matrix required). Default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.time</code></td>
<td>
<p>boolean. If <code>TRUE</code>, samples in the sequences to compare will be tested to check if they have the same time/age/depth according to <code>time.column</code>. This argument is only useful when the user needs to compare two sequences taken at different sites but same time frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.blocks</code></td>
<td>
<p>boolean. If <code>TRUE</code>, the function <code>leastCostPathNoBlocks</code> analyzes the least-cost path of the best solution, and removes blocks (straight-orthogonal sections of the least-cost path), which happen in highly dissimilar sections of the sequences, and inflate output psi values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.execution</code></td>
<td>
<p>boolean, if <code>TRUE</code> (default), execution is parallelized, and serialized if <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list, matrix, or dataframe, with sequence names and psi values.
</p>


<h3>Author(s)</h3>

<p>Blas Benito &lt;blasbenito@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data("sequencesMIS")
#prepare sequences
MIS.sequences &lt;- prepareSequences(
  sequences = sequencesMIS,
  grouping.column = "MIS",
  if.empty.cases = "zero",
  transformation = "hellinger"
  )

#execute workflow to compute psi
MIS.psi &lt;- workflowPsi(
 sequences = MIS.sequences[MIS.sequences$MIS %in% c("MIS-1", "MIS-2"), ],
 grouping.column = "MIS",
 time.column = NULL,
 exclude.columns = NULL,
 method = "manhattan",
 diagonal = FALSE,
 parallel.execution = FALSE
 )

MIS.psi



</code></pre>


</div>