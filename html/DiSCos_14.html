<div class="container">

<table style="width: 100%;"><tr>
<td>DiSCo_per_iter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DiSCo_per_iter</h2>

<h3>Description</h3>

<p>This function performs one iteration of the permutation test
</p>


<h3>Usage</h3>

<pre><code class="language-R">DiSCo_per_iter(
  c_df,
  c_df.q,
  t_df,
  T0,
  peridx,
  evgrid,
  idx,
  grid_df,
  M = 1000,
  ww = 0,
  qmethod = NULL,
  qtype = 7,
  q_min = 0,
  q_max = 1,
  simplex = FALSE,
  mixture = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>c_df</code></td>
<td>
<p>List of control units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_df.q</code></td>
<td>
<p>List of quantiles of control units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_df</code></td>
<td>
<p>List of target unit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>Index of permuted target unit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_df</code></td>
<td>
<p>Grids to evaluate CDFs on, only needed when <code>mixture=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Integer indicating the number of control quantiles to use in the DiSCo method. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmethod</code></td>
<td>
<p>Character, indicating the method to use for computing the quantiles of the target distribution. The default is NULL, which uses the <code>quantile</code> function from the stats package.
Other options are "<code>qkden</code>" (based on smoothed kernel density function) and "<code>extreme</code>" (based on parametric extreme value distributions).
Both are substantially slower than the default method but may be useful for fat-tailed distributions with few data points at the upper quantiles. Alternatively, one could use the q_max option to restrict the range of quantiles used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtype</code></td>
<td>
<p>Integer, indicating the type of quantile to compute when using  <code>quantile</code> in the <code>qmethod</code> argument.
The default 7. See the documentation for the <code>quantile</code> function for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_min</code></td>
<td>
<p>Numeric, minimum quantile to use. Set this together with <code>q_max</code> to restrict the range of quantiles used to construct the synthetic control.
Default is 0 (all quantiles). Currently NOT implemented for the <code>mixture</code> approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_max</code></td>
<td>
<p>Numeric, maximum quantile to use. Set this together with <code>q_min</code> to restrict the range of quantiles used to construct the synthetic control.
Default is 1 (all quantiles). Currently NOT implemented for the <code>mixture</code> approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplex</code></td>
<td>
<p>Logical, indicating whether to use to constrain the optimal weights to the unit simplex. Default is FALSE, which only constrains the weights to sum up to 1 but allows them to be negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixture</code></td>
<td>
<p>Logical, indicating whether to use the mixture of distributions approach instead.
See Section 4.3. in Gunsilius (2023). This approach minimizes the distance between the CDFs
instead of the quantile functions, and is preferred for categorical variables. When working with such variables, one should
also provide a list of support points in the <code>grid.cat</code> parameter. When that is provided, this parameter is automatically set to TRUE. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of squared Wasserstein distances between the target unit and the control units
</p>


</div>