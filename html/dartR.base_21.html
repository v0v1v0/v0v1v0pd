<div class="container">

<table style="width: 100%;"><tr>
<td>gl.fdsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the rate of false positives in a fixed difference analysis</h2>

<h3>Description</h3>

<p>This function takes two populations and generates allele frequency profiles
for them. It then samples an allele frequency for each, at random, and
estimates a sampling distribution for those two allele frequencies. Drawing
two samples from those sampling distributions, it calculates whether or not
they represent a fixed difference. This is applied to all loci, and the
number of fixed differences so generated are counted, as an expectation. The
script distinguished between true fixed differences (with a tolerance of
delta), and false positives. The simulation is repeated a given number of
times (default=1000) to provide an expectation of the number of false
positives, given the observed allele frequency profiles and the sample sizes.
The probability of the observed count of fixed differences is greater than
the expected number of false positives is calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.fdsim(
  x,
  poppair,
  obs = NULL,
  sympatric = FALSE,
  reps = 1000,
  delta = 0.02,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of the genlight containing the SNP genotypes [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poppair</code></td>
<td>
<p>Labels of two populations for comparison in the form
c(popA,popB) [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Observed number of fixed differences between the two populations
[default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sympatric</code></td>
<td>
<p>If TRUE, the two populations are sympatric, if FALSE then
allopatric [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Number of replications to undertake in the simulation
[default 1000].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The threshold value for the minor allele frequency to regard the
difference between two populations to be fixed [default 0.02].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent, fatal errors only; 1, flag function
begin and end; 2, progress log; 3, progress and results summary; 5, full
report [default 2 or as specified using gl.set.verbosity].</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following square matrices
[[1]] observed fixed differences;
[[2]] mean expected number of false positives for each comparison;
[[3]] standard deviation of the no. of false positives for each
comparison;
[[4]] probability the observed fixed differences arose by chance for
each comparison.
</p>


<h3>Author(s)</h3>

<p>Custodian: Arthur Georges (Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>)
</p>


<h3>See Also</h3>

<p>Other distance: 
<code>gl.dist.ind()</code>,
<code>gl.dist.pop()</code>,
<code>utils.dist.ind.snp()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fd &lt;- gl.fdsim(testset.gl[,1:100],poppair=c('EmsubRopeMata','EmmacBurnBara'),
sympatric=TRUE,verbose=3)

</code></pre>


</div>