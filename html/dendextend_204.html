<div class="container">

<table style="width: 100%;"><tr>
<td>set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set (/update) features to a dendrogram</h2>

<h3>Description</h3>

<p>a master function for updating various attributes and
features of dendrogram objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">set(dend, ...)

## S3 method for class 'dendrogram'
set(
  dend,
  what = c("labels", "labels_colors", "labels_cex", "labels_to_character", "leaves_pch",
    "leaves_cex", "leaves_col", "leaves_bg", "nodes_pch", "nodes_cex", "nodes_col",
    "nodes_bg", "hang_leaves", "rank_branches", "branches_k_color", "branches_k_lty",
    "branches_col", "branches_lwd", "branches_lty", "by_labels_branches_col",
    "by_labels_branches_lwd", "by_labels_branches_lty", "by_lists_branches_col",
    "by_lists_branches_lwd", "by_lists_branches_lty", "highlight_branches_col",
    "highlight_branches_lwd", "clear_branches", 
     "clear_leaves"),
  value,
  order_value = FALSE,
  ...
)

## S3 method for class 'dendlist'
set(dend, ..., which)

## S3 method for class 'data.table'
set(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dend</code></td>
<td>
<p>a tree (dendrogram, or dendlist)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to the specific function for more options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a character indicating what is the property of
the tree that should be set/updated. (see the usage and the example section
for the different options)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>an object with the value to set in the dendrogram tree.
(the type of the value depends on the "what")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_value</code></td>
<td>
<p>logical. Default is FALSE. If TRUE, it means the order of
the value is in the order of the data which produced the hclust
or dendrogram - and will reorder the value to conform with the order
of the labels in the dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>an integer vector indicating, in the case "dend" is
a dendlist, on which of the trees should the modification be performed.
If missing - the change will be performed on all of dends in the dendlist.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function for many of the main tasks we
might wish to perform on a dendrogram before plotting.
</p>
<p>The options of by_labels_branches_col, by_labels_branches_lwd, by_labels_branches_lty
have extra parameters: type, attr, TF_value, and by_lists_branches_col, by_lists_branches_lwd,
by_lists_branches_lty have extra parameters: attr, TF_value. You can read more about them here:
branches_attr_by_labels and branches_attr_by_lists
</p>
<p>The "what" parameter" can accept the following options:
</p>

<ul>
<li>
<p>labels - set the labels (labels&lt;-.dendrogram)
</p>
</li>
<li>
<p>labels_colors - set the labels' colors (color_labels)
</p>
</li>
<li>
<p>labels_cex - set the labels' size (assign_values_to_leaves_nodePar)
</p>
</li>
<li>
<p>labels_to_character - set the labels' to be characters
</p>
</li>
<li>
<p>leaves_pch - set the leaves' point type (assign_values_to_leaves_nodePar). A leave is the terminal node of the tree.
</p>
</li>
<li>
<p>leaves_cex - set the leaves' point size (assign_values_to_leaves_nodePar). For using this you MUST also set leaves_pch, a good value to use is 19.
</p>
</li>
<li>
<p>leaves_col - set the leaves' point color (assign_values_to_leaves_nodePar). For using this you MUST also set leaves_pch, a good value to use is 19.
</p>
</li>
<li>
<p>leaves_bg - set the leaves' point fill color (assign_values_to_leaves_nodePar). For using this you MUST also set leaves_pch with values from 21-25.
</p>
</li>
<li>
<p>nodes_pch - set the nodes' point type (assign_values_to_nodes_nodePar)
</p>
</li>
<li>
<p>nodes_cex - set the nodes' point size (assign_values_to_nodes_nodePar)
</p>
</li>
<li>
<p>nodes_col - set the nodes' point color (assign_values_to_nodes_nodePar)
</p>
</li>
<li>
<p>nodes_bg - set the nodes' point fill color (assign_values_to_nodes_nodePar). For using this you MUST also set leaves_pch with values from 21-25.
</p>
</li>
<li>
<p>hang_leaves - hang the leaves (hang.dendrogram)
</p>
</li>
<li>
<p>branches_k_color - color the branches (color_branches), a <code>k</code> parameter needs to be supplied.
</p>
</li>
<li>
<p>branches_k_lty - updates the lwd of the branches (similar to branches_k_color), a <code>k</code> parameter needs to be supplied.
</p>
</li>
<li>
<p>branches_col - set the color of branches (assign_values_to_branches_edgePar) 
</p>
</li>
<li>
<p>branches_lwd - set the line width of branches (assign_values_to_branches_edgePar) 
</p>
</li>
<li>
<p>branches_lty - set the line type of branches (assign_values_to_branches_edgePar) 
</p>
</li>
<li>
<p>by_labels_branches_col - set the color of branches with specific labels (branches_attr_by_labels) 
</p>
</li>
<li>
<p>by_labels_branches_lwd - set the line width of branches with specific labels (branches_attr_by_labels) 
</p>
</li>
<li>
<p>by_labels_branches_lty - set the line type of branches with specific labels (branches_attr_by_labels) 
</p>
</li>
<li>
<p>by_lists_branches_col - set the color of branches from the root of the tree down to (possibly inner) nodes with specified members (branches_attr_by_lists) 
</p>
</li>
<li>
<p>by_lists_branches_lwd - set the line width of branches from the root of the tree down to (possibly inner) nodes with specified members (branches_attr_by_lists) 
</p>
</li>
<li>
<p>by_lists_branches_lty - set the line type of branches from the root of the tree down to (possibly inner) nodes with specified members (branches_attr_by_lists) 
</p>
</li>
<li>
<p>highlight_branches_col - highlight branches color based on branches' heights (highlight_branches_col) 
</p>
</li>
<li>
<p>highlight_branches_lwd - highlight branches line-width based on branches' heights (highlight_branches_lwd) 
</p>
</li>
<li>
<p>clear_branches - clear branches' attributes (remove_branches_edgePar)
</p>
</li>
<li>
<p>clear_leaves - clear leaves' attributes (remove_branches_edgePar)
</p>
</li>
</ul>
<h3>Value</h3>

<p>An updated dendrogram (or dendlist), with some change to
the parameters of it
</p>


<h3>See Also</h3>

<p>labels&lt;-.dendrogram, labels_colors&lt;-,
hang.dendrogram, color_branches,
assign_values_to_leaves_nodePar,
assign_values_to_branches_edgePar,
remove_branches_edgePar, remove_leaves_nodePar,
noded_with_condition, branches_attr_by_labels, branches_attr_by_lists,
dendrogram
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

set.seed(23235)
ss &lt;- sample(1:150, 10)

# Getting the dend object
dend &lt;- iris[ss, -5] %&gt;%
  dist() %&gt;%
  hclust() %&gt;%
  as.dendrogram()
dend %&gt;% plot()

dend %&gt;% labels()
dend %&gt;%
  set("labels", 1:10) %&gt;%
  labels()
dend %&gt;%
  set("labels", 1:10) %&gt;%
  plot()
dend %&gt;%
  set("labels_color") %&gt;%
  plot()
dend %&gt;%
  set("labels_col", c(1, 2)) %&gt;%
  plot() # Works also with partial matching :)
dend %&gt;%
  set("labels_cex", c(1, 1.2)) %&gt;%
  plot()
dend %&gt;%
  set("leaves_pch", NA) %&gt;%
  plot()
dend %&gt;%
  set("leaves_pch", c(1:5)) %&gt;%
  plot()
dend %&gt;%
  set("leaves_pch", c(19, 19, NA)) %&gt;%
  set("leaves_cex", c(1, 2)) %&gt;%
  plot()
dend %&gt;%
  set("leaves_pch", c(19, 19, NA)) %&gt;%
  set("leaves_cex", c(1, 2)) %&gt;%
  set("leaves_col", c(1, 1, 2, 2)) %&gt;%
  plot()
dend %&gt;%
  set("hang") %&gt;%
  plot()

# using bg for leaves and nodes

set.seed(23235)
ss &lt;- sample(1:150, 25)

# Getting the dend object
dend25 &lt;- iris[ss, -5] %&gt;%
  dist() %&gt;%
  hclust() %&gt;%
  as.dendrogram()

dend25 %&gt;%
  set("labels", 1:25) %&gt;%
  set("nodes_pch", 21) %&gt;% # set all nodes to be pch 21
  set("nodes_col", "darkred") %&gt;%
  set("nodes_bg", "gold") %&gt;%
  set("leaves_pch", 1:25) %&gt;% # Change the leaves pch to move from 1 to 25
  set("leaves_col", "darkred") %&gt;%
  set("leaves_bg", "gold") %&gt;%
  plot(main = "pch 21 to 25 supports the\nnodes_bg and leaves_bg parameters")
  
  
dend %&gt;%
  set("branches_k_col") %&gt;%
  plot()
dend %&gt;%
  set("branches_k_col", c(1, 2)) %&gt;%
  plot()
dend %&gt;%
  set("branches_k_col", c(1, 2, 3), k = 3) %&gt;%
  plot()
dend %&gt;%
  set("branches_k_col", k = 3) %&gt;%
  plot()

dend %&gt;%
  set("branches_k_lty", k = 3) %&gt;%
  plot()
dend %&gt;%
  set("branches_k_col", k = 3) %&gt;%
  set("branches_k_lty", k = 3) %&gt;%
  plot()

dend %&gt;%
  set("branches_col", c(1, 2, 1, 2, NA)) %&gt;%
  plot()
dend %&gt;%
  set("branches_lwd", c(2, 1, 2)) %&gt;%
  plot()
dend %&gt;%
  set("branches_lty", c(1, 2, 1)) %&gt;%
  plot()

#    clears all of the things added to the leaves
dend %&gt;%
  set("labels_color", c(19, 19, NA)) %&gt;%
  set("leaves_pch", c(19, 19, NA)) %&gt;% # plot
  set("clear_leaves") %&gt;% # remove all of what was done until this point
  plot()
# Different order
dend %&gt;%
  set("leaves_pch", c(19, 19, NA)) %&gt;%
  set("labels_color", c(19, 19, NA)) %&gt;%
  set("clear_leaves") %&gt;%
  plot()


# doing this without chaining (%&gt;%) will NOT be fun:
dend %&gt;%
  set("labels", 1:10) %&gt;%
  set("labels_color") %&gt;%
  set("branches_col", c(1, 2, 1, 2, NA)) %&gt;%
  set("branches_lwd", c(2, 1, 2)) %&gt;%
  set("branches_lty", c(1, 2, 1)) %&gt;%
  set("hang") %&gt;%
  plot()

par(mfrow = c(1, 3))
dend %&gt;%
  set("highlight_branches_col") %&gt;%
  plot()
dend %&gt;%
  set("highlight_branches_lwd") %&gt;%
  plot()
dend %&gt;%
  set("highlight_branches_col") %&gt;%
  set("highlight_branches_lwd") %&gt;%
  plot()
par(mfrow = c(1, 1))

#----------------------------
# Examples for: by_labels_branches_col, by_labels_branches_lwd, by_labels_branches_lty

old_labels &lt;- labels(dend)
dend %&gt;%
  set("labels", seq_len(nleaves(dend))) %&gt;%
  set("by_labels_branches_col", c(1:4, 7)) %&gt;%
  set("by_labels_branches_lwd", c(1:4, 7)) %&gt;%
  set("by_labels_branches_lty", c(1:4, 7)) %&gt;%
  set("labels", old_labels) %&gt;%
  plot()

dend %&gt;%
  set("labels", seq_len(nleaves(dend))) %&gt;%
  set("by_labels_branches_col", c(1:4, 7), type = "any", TF_values = c(4, 2)) %&gt;%
  set("by_labels_branches_lwd", c(1:4, 7), type = "all", TF_values = c(4, 1)) %&gt;%
  set("by_labels_branches_lty", c(1:4, 7), TF_values = c(4, 1)) %&gt;%
  plot()

#---- using order_value
# This is probably not what you want, since cutree
# returns clusters in the order of the original data:
dend %&gt;%
  set("labels_colors", cutree(dend, k = 3)) %&gt;%
  plot()
# The way to fix it, is to use order_value = TRUE
# so that value is assumed to be in the order of the data:
dend %&gt;%
  set("labels_colors", cutree(dend, k = 3), order_value = TRUE) %&gt;%
  plot()


#----------------------------
# Example for: by_lists_branches_col, by_lists_branches_lwd, by_lists_branches_lty

L &lt;- list(c("109", "123", "126", "145"), "29", c("59", "67", "97"))
dend %&gt;%
  set("by_lists_branches_col", L, TF_value = "blue") %&gt;%
  set("by_lists_branches_lwd", L, TF_value = 4) %&gt;%
  set("by_lists_branches_lty", L, TF_value = 3) %&gt;%
  plot()


#----------------------------
# A few dendlist examples:
dendlist(dend, dend) %&gt;%
  set("hang") %&gt;%
  plot()
dendlist(dend, dend) %&gt;%
  set("branches_k_col", k = 3) %&gt;%
  plot()
dendlist(dend, dend) %&gt;%
  set("labels_col", c(1, 2)) %&gt;%
  plot()

dendlist(dend, dend) %&gt;%
  set("hang") %&gt;%
  set("labels_col", c(1, 2), which = 1) %&gt;%
  set("branches_k_col", k = 3, which = 2) %&gt;%
  set("labels_cex", 1.2) %&gt;%
  plot()


#----------------------------
# example of modifying the dendrogram in a heatmap:

library(gplots)
data(mtcars)
x &lt;- as.matrix(mtcars)
rc &lt;- rainbow(nrow(x), start = 0, end = .3)
cc &lt;- rainbow(ncol(x), start = 0, end = .3)

##
##' demonstrate the effect of row and column dendrogram options
##
Rowv_dend &lt;- x %&gt;%
  dist() %&gt;%
  hclust() %&gt;%
  as.dendrogram() %&gt;%
  set("branches_k", k = 3) %&gt;%
  set("branches_lwd", 2) %&gt;%
  ladderize() # rotate_DendSer
Colv_dend &lt;- t(x) %&gt;%
  dist() %&gt;%
  hclust() %&gt;%
  as.dendrogram() %&gt;%
  set("branches_k", k = 3) %&gt;%
  set("branches_lwd", 2) %&gt;%
  ladderize() # rotate_DendSer
heatmap.2(x, Rowv = Rowv_dend, Colv = Colv_dend)

## End(Not run)
</code></pre>


</div>