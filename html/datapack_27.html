<div class="container">

<table style="width: 100%;"><tr>
<td>describeWorkflow</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add data derivation information to a DataPackage</h2>

<h3>Description</h3>

<p>Add information about the relationships among DataObject members 
in a DataPackage, retrospectively describing the way in which derived data were 
created from source data using a processing program such as an R script.  These provenance
relationships allow the derived data to be understood sufficiently for users
to be able to reproduce the computations that created the derived data, and to
trace lineage of the derived data objects. The method <code>describeWorkflow</code> 
will add provenance relationships between a script that was executed, the files 
that it used as sources, and the derived files that it generated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">describeWorkflow(x, ...)

## S4 method for signature 'DataPackage'
describeWorkflow(
  x,
  sources = list(),
  program = NA_character_,
  derivations = list(),
  insertDerivations = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The <code>DataPackage</code> to add provenance relationships to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sources</code></td>
<td>
<p>A list of DataObjects for files that were read by the program. Alternatively, a list 
of DataObject identifiers can be specified as a list of character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>program</code></td>
<td>
<p>The DataObject created for the program such as an R script. Alternatively the DataObject identifier can
be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivations</code></td>
<td>
<p>A list of DataObjects for files that were generated by the program. Alternatively, a list 
of DataObject identifiers can be specified as a list of character strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insertDerivations</code></td>
<td>
<p>A <code>logical</code> value. If TRUE then the provenance relationship 
<code>prov:wasDerivedFrom</code> will be used to connect every source and derivation. The default value 
is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method operates on a DataPackage that has had DataObjects for 
the script, data sources (inputs), and data derivations (outputs) previously 
added to it, or can reference identifiers for objects that exist in other DataPackage
instances. This allows a user to create a standalone package that contains all of
its source, script, and derived data, or a set of data packages that are chained
together via a set of derivation relationships between the members of those packages.
</p>
<p>Provenance relationships are described following the the ProvONE data model, which
can be viewed at <a href="https://purl.dataone.org/provone-v1-dev">https://purl.dataone.org/provone-v1-dev</a>.  In particular, 
the following relationships are inserted (among others):
</p>

<ul>
<li>
<p><code>prov:used</code> indicates which source data was used by a program execution
</p>
</li>
<li>
<p><code>prov:generatedBy</code> indicates which derived data was created by a program execution
</p>
</li>
<li>
<p><code>prov:wasDerivedFrom</code> indicates the source data from which derived data were created using the program
</p>
</li>
</ul>
<h3>See Also</h3>

<p>The R 'recordr' package for run-time recording of provenance relationships.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(datapack)
dp &lt;- new("DataPackage")
# Add the script to the DataPackage
progFile &lt;- system.file("./extdata/pkg-example/logit-regression-example.R", package="datapack")
progObj &lt;- new("DataObject", format="application/R", filename=progFile)
dp &lt;- addMember(dp, progObj)

# Add a script input to the DataPackage
inFile &lt;- system.file("./extdata/pkg-example/binary.csv", package="datapack") 
inObj &lt;- new("DataObject", format="text/csv", filename=inFile)
dp &lt;- addMember(dp, inObj)

# Add a script output to the DataPackage
outFile &lt;- system.file("./extdata/pkg-example/gre-predicted.png", package="datapack")
outObj &lt;- new("DataObject", format="image/png", file=outFile)
dp &lt;- addMember(dp, outObj)

# Add the provenenace relationshps, linking the input and output to the script execution
# Note: 'sources' and 'derivations' can also be lists of "DataObjects" or "DataObject' identifiers
dp &lt;- describeWorkflow(dp, sources = inObj, program = progObj, derivations = outObj) 
# View the results
utils::head(getRelationships(dp))
</code></pre>


</div>