<div class="container">

<table style="width: 100%;"><tr>
<td>discrim-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>parsnip methods for discriminant analysis</h2>

<h3>Description</h3>

<p><span class="pkg">discrim</span> offers various functions to fit classification models via the
discriminant analysis.
</p>


<h3>Details</h3>

<p>The model function works with the tidymodels infrastructure so that the model
can be resampled, tuned, tided, etc.
</p>


<h3>Example</h3>

<p>As an example, we’ll use a <em>flexible discriminant analysis</em> model of
Hastie, Tibshirani, and Buja (1994). This fits a model that uses
features generated by the multivariate adaptive regression spline (MARS)
model of Friedman (1991). It is able to create class boundaries that are
polygons and has built-in feature selection.
</p>
<p>The <code>parabolic</code> data from the modeldata package will be used to
illustrate:
</p>
<div class="sourceCode r"><pre>library(tidymodels)
library(discrim)
tidymodels_prefer()
theme_set(theme_bw())

data(parabolic, package = "modeldata")
</pre></div>
<p>To create the model, the <code>discrim_flexible()</code>
function is used along with an engine of <code>"earth"</code> (which contains the
methods to use the MARS model). We’ll set the number of MARS terms to
use but this can be tuned via the methods in the tune package.
</p>
<p>The <code>fit()</code> function estimates the model. <code>fit_xy()</code> can be used if one
does not wish to use the formula method.
</p>
<div class="sourceCode r"><pre>fda_mod &lt;-
  discrim_flexible(num_terms = 3) %&gt;%
  # increase `num_terms` to find smoother boundaries
  set_engine("earth") %&gt;%
  fit(class ~ ., data = parabolic)
fda_mod
</pre></div>
<div class="sourceCode"><pre>## parsnip model object
## 
## Call:
## mda::fda(formula = class ~ ., data = data, method = earth::earth, 
##     nprune = ~3)
## 
## Dimension: 1 
## 
## Percent Between-Group Variance Explained:
##  v1 
## 100 
## 
## Training Misclassification Error: 0.136 ( N = 500 )
</pre></div>
<p>Now let’s plot the class boundary by predicting on a grid of points then
creating a contour plot for the 50% probability cutoff.
</p>
<div class="sourceCode r"><pre>parabolic_grid &lt;-
  expand.grid(X1 = seq(-5, 5, length = 100),
              X2 = seq(-5, 5, length = 100))

parabolic_grid &lt;- 
  parabolic_grid %&gt;% 
  bind_cols(
    predict(fda_mod, parabolic_grid, type = "prob")
  )

ggplot(parabolic, aes(x = X1, y = X2)) +
  geom_point(aes(col = class), alpha = .5) +
  geom_contour(data = parabolic_grid, aes(z = .pred_Class1), col = "black", breaks = .5) +
  coord_equal()
</pre></div>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Emil Hvitfeldt <a href="mailto:emil.hvitfeldt@posit.co">emil.hvitfeldt@posit.co</a> (<a href="https://orcid.org/0000-0002-0679-1945">ORCID</a>)
</p>
<p>Authors:
</p>

<ul><li>
<p> Max Kuhn <a href="mailto:max@posit.co">max@posit.co</a> (<a href="https://orcid.org/0000-0003-2402-136X">ORCID</a>)
</p>
</li></ul>
<p>Other contributors:
</p>

<ul><li>
<p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>
<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/tidymodels/discrim">https://github.com/tidymodels/discrim</a>
</p>
</li>
<li> <p><a href="https://discrim.tidymodels.org/">https://discrim.tidymodels.org/</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/tidymodels/discrim/issues">https://github.com/tidymodels/discrim/issues</a>
</p>
</li>
</ul>
</div>