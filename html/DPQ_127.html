<div class="container">

<table style="width: 100%;"><tr>
<td>pnchisqWienergerm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wienergerm Approximations to (Non-Central) Chi-squared Probabilities</h2>

<h3>Description</h3>


<p>Functions implementing the two Wiener germ approximations to
<code>pchisq()</code>, the (non-central) chi-squared distribution, and to
<code>qchisq()</code> its inverse, the quantile function.
</p>
<p>These have been proposed by Penev and Raykov (2000) who also listed a
Fortran implementation.
</p>
<p>In order to use them in numeric boundary cases, Martin Maechler has
improved the original formulas.
</p>
<p><b>Auxiliary functions:</b>
</p>

<dl>
<dt>
<code>sW()</code>:</dt>
<dd>
<p>The <code class="reqn">s()</code> as in the Wienergerm approximation,
but using Taylor expansion when needed, i.e., <code>(x*ncp / df^2) &lt;&lt; 1</code>.</p>
</dd>
<dt>
<code>qs()</code>:</dt>
<dd>
<p> ... </p>
</dd>
<dt>
<code>z0()</code>:</dt>
<dd>
<p> ... </p>
</dd>
<dt>
<code>z.f()</code>:</dt>
<dd>
<p> ... </p>
</dd>
<dt>
<code>z.s()</code>:</dt>
<dd>
<p> ... </p>
</dd>
</dl>
<p>..................
..................
</p>
 


<h3>Usage</h3>

<pre><code class="language-R">

pchisqW. (q, df, ncp = 0, lower.tail = TRUE, log.p = FALSE,
          Fortran = TRUE, variant = c("s", "f"))
pchisqV  (q, df, ncp = 0, lower.tail = TRUE, log.p = FALSE,
          Fortran = TRUE, variant = c("s", "f"))
pchisqW  (q, df, ncp = 0, lower.tail = TRUE, log.p = FALSE, variant = c("s", "f"))
pchisqW.R(x, df, ncp = 0, lower.tail = TRUE, log.p = FALSE, variant = c("s", "f"),
          verbose = getOption("verbose"))

sW(x, df, ncp)
qs(x, df, ncp, f.s = sW(x, df, ncp), eps1 = 1/2, sMax = 1e+100)
z0(x, df, ncp)
z.f(x, df, ncp)
z.s(x, df, ncp, verbose = getOption("verbose"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q,x</code></td>
<td>
<p>vector of quantiles (main argument, see  <code>pchisq</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom (non-negative, but can be non-integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>non-centrality parameter (non-negative).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail,log.p</code></td>
<td>
<p><code>logical</code>, see <code>pchisq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variant</code></td>
<td>
<p>a <code>character</code> string, currently either
<code>"f"</code> for the <b>f</b>irst or
<code>"s"</code> for the <b>s</b>econd Wienergerm approximation in
Penev and Raykov (2000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fortran</code></td>
<td>
<p>logical specifying if the Fortran or the C version should
be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical (or integer) indicating if or how much diagnostic
output should be printed to the console during the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.s</code></td>
<td>
<p>a number must be a “version” of <code class="reqn">s(x, df, ncp)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps1</code></td>
<td>
<p>for <code>qs()</code>: use direct approximation instead of
<code>h(1 - 1/s)</code> for <code>s &lt; eps1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sMax</code></td>
<td>
<p>for <code>qs()</code>: cutoff to switch the <code class="reqn">h(.)</code> formula for
<code>s &gt; sMax</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>....TODO... or write vignette



</p>


<h3>Value</h3>

<p>all these functions return <code>numeric</code> vectors according to
their arguments.
</p>


<h3>Note</h3>

<p>The exact auxiliary function names etc, are still considered
<em>provisional</em>; currently they are exported for easier documentation
and use, but may well all disappear from the exported functions or even
completely.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, mostly end of Jan 2004</p>


<h3>References</h3>

<p>Penev, Spiridon and Raykov, Tenko (2000)
A Wiener Germ approximation of the noncentral chi square 
distribution and of its quantiles.
<em>Computational Statistics</em> <b>15</b>, 219–228.
<a href="https://doi.org/10.1007/s001800000029">doi:10.1007/s001800000029</a>
</p>
<p>Dinges, H. (1989)
Special cases of second order Wiener germ approximations.
<em>Probability Theory and Related Fields</em>, <b>83</b>, 5–57.
</p>


<h3>See Also</h3>

<p><code>pchisq</code>, and other approximations for it:
<code>pnchisq()</code> etc.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## see  example(pnchisqAppr)   which looks at all of the pchisq() approximating functions



</code></pre>


</div>