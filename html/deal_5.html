<div class="container">

<table style="width: 100%;"><tr>
<td>autosearch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Greedy search</h2>

<h3>Description</h3>

<p>From initial network, does local perturbations to increase network score.
</p>


<h3>Usage</h3>

<pre><code class="language-R">autosearch(initnw,data,prior=jointprior(network(data)),maxiter=50,
           trylist= vector("list",size(initnw)),trace=TRUE,
           timetrace=TRUE,showban=FALSE,removecycles=FALSE) 

heuristic(initnw,data,prior=jointprior(network(data)),
          maxiter=100,restart=10,degree=size(initnw),
          trylist= vector("list",size(initnw)),trace=TRUE,
          timetrace=TRUE,removecycles=FALSE)
gettable(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>initnw</code></td>
<td>
<p>an object of class <code>network</code>, from which the
search is started. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame used for learning the network, see
<code>network</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list containing parameter priors, generated by
<code>jointprior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>an integer, which gives the maximum number of steps in the
search algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restart</code></td>
<td>
<p>an integer, which gives the number of times to perturb
<code>initnw</code> and rerun the 
search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>an integer, which gives the degree of perturbation, see
<code>perturb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trylist</code></td>
<td>
<p>a list used internally for reusing learning of nodes,
see <code>maketrylist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>a logical. If <code>TRUE</code>, plots the accepted networks
during search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timetrace</code></td>
<td>
<p>a logical. If <code>TRUE</code>, prints some timing
information on the screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showban</code></td>
<td>
<p>a logical passed to  the plot method for network
objects. If
<code>FALSE</code>, the banned arrows are not shown in the plots (if
<code>trace</code> is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removecycles</code></td>
<td>
<p>a logical. If <code>TRUE</code>, all networks explored in the
search is returned, except for networks containing a cycle. If <code>FALSE</code>, all networks are returned, including
cyclic networks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an output object from a search.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In <code>autosearch</code>, a list of networks is in each step
created with either one
arrow added, one arrow deleted or one arrow turned (if a cycle is not
generated). The network scores of all the proposal networks are
calculated and the network with the highest score is chosen for the
next step in the search. If no proposed network has a higher network
score than the previous network, the search is terminated. The
network with the highest network score is returned, along with a list
containing all tried networks (depending on the value of <code>removecycles</code>).
</p>
<p><code>heuristic</code> restarts by perturbing <code>initnw</code>
<code>degree</code> times and calling 
<code>autosearch</code> again. The number
of restarts is given by the option <code>restart</code>.
</p>


<h3>Value</h3>

<p><code>autosearch</code> and <code>heuristic</code> returns a list with three
elements, that may be accessed using <code>getnetwork</code>,
<code>gettable</code> and <code>gettrylist</code>. The elements are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nw</code></td>
<td>
<p>an object of class <code>network</code>, which gives the
network with the highest score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>a table with all tried
networks. If removecycles is <code>FALSE</code>, the networks may contain
cycles. The table contains two columns: <code>model</code> with a 
string representation of the model and <code>score</code> with the
corresponding log network score. The table can be translated to a
<code>networkfamily</code> using <code>makenw</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trylist</code></td>
<td>
<p>an updated list used internally for reusing learning
of nodes, see <code>maketrylist</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Susanne Gammelgaard Bottcher, <br>
Claus Dethlefsen <a href="mailto:rpackage.deal@gmail.com">rpackage.deal@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>perturb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(rats)
fit       &lt;- network(rats)
fit.prior &lt;- jointprior(fit,12)
fit       &lt;- getnetwork(learn(fit,rats,fit.prior))
fit       &lt;- getnetwork(insert(fit,2,1,rats,fit.prior))
fit       &lt;- getnetwork(insert(fit,1,3,rats,fit.prior))
hisc      &lt;- autosearch(fit,rats,fit.prior,trace=FALSE)
hisc      &lt;- autosearch(fit,rats,fit.prior,trace=FALSE,removecycles=TRUE) # slower
plot(getnetwork(hisc))

hisc2     &lt;- heuristic(fit,rats,fit.prior,restart=10,trace=FALSE)
plot(getnetwork(hisc2))
print(modelstring(getnetwork(hisc2)))
plot(makenw(gettable(hisc2),fit))
</code></pre>


</div>