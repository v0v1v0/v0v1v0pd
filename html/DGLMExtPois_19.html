<div class="container">

<table style="width: 100%;"><tr>
<td>expected</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected Probabilities and Frequencies for the hyper-Poisson and COM-Poisson
Model</h2>

<h3>Description</h3>

<p>The <code>hP_expected</code> and <code>CMP_expected</code> functions calculate the
probability distribution of the count response variable Y for each observation
and obtain the corresponding expected frequencies. It is an informal way of
assessing the fit of the hP or CMP model by comparing the predicted
distribution of counts with the observed distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hP_expected(object)

CMP_expected(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted object of class inheriting from <code>"glm_hP"</code> or
<code>"glm_CMP"</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The average expected probabilities are computed as </p>
<p style="text-align: center;"><code class="reqn">\bar(Pr)(y=k) =
\frac{1}{n} \sum_{i=1}^n \widehat{Pr}(y_i = k | x_i)</code>
</p>

<p>The expected frequencies are obtained by multiplying by n.
</p>
<p>Two measures are offered for summarizing the comparison between expected and
observed frequencies: the sum of the absolute value of differences and the sum
of the square of differences (similar to the Pearson statistic of goodness of
fit).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>frequencies</code></td>
<td>
<p>the expected counts for the hP or CMP fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed_freq</code></td>
<td>
<p>the observed distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probabilities</code></td>
<td>
<p>the expected distribution for the hP or CMP
fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dif</code></td>
<td>
<p>sum of the absolute value of differences between
<code>frequencies</code> and <code>observed_freq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi2</code></td>
<td>
<p>sum of the
square of differences between <code>frequencies</code> and <code>observed_freq</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>J. M. Hilbe (2011). Negative Binomial Regression. (2nd ed.). Cambridge
University Press.
</p>
<p>M. Scott Long and Jeremy Freese (2014). Regression Models for Categorical
Dependent Variables using STATA. (3rd ed.). Stata Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit a hyper-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
hP.fit &lt;- glm.hP(formula.mu = numbids ~ leglrest + rearest + finrest +
                 whtknght + bidprem + insthold + size + size.sq + regulatn,
                 formula.gamma = numbids ~ 1, data = Bids)

## Compute the expected probabilities and the frequencies

hP_expected(hP.fit)
## Estimate a COM-Poisson model

Bids$size.sq &lt;- Bids$size ^ 2
CMP.fit &lt;- glm.CMP(formula.mu = numbids ~ leglrest + rearest + finrest +
                   whtknght + bidprem + insthold + size + size.sq + regulatn,
                   formula.nu = numbids ~ 1, data = Bids)

## Compute the expected probabilities and the frequencies

CMP_expected(CMP.fit)
</code></pre>


</div>