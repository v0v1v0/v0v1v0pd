<div class="container">

<table style="width: 100%;"><tr>
<td>utils.structure.run</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utility function to run Structure</h2>

<h3>Description</h3>

<p>These functions were copied from package strataG, which is no longer on CRAN
(maintained by Eric Archer)
</p>


<h3>Usage</h3>

<pre><code class="language-R">utils.structure.run(
  g,
  k.range,
  num.k.rep,
  label,
  delete.files = TRUE,
  exec,
  burnin,
  numreps,
  noadmix,
  freqscorr,
  randomize,
  seed,
  pop.prior,
  locpriorinit,
  maxlocprior,
  gensback,
  migrprior,
  pfrompopflagonly,
  popflag,
  inferalpha,
  alpha,
  unifprioralpha,
  alphamax,
  alphapriora,
  alphapriorb
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a gtypes object [see <code>strataG</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.range</code></td>
<td>
<p>vector of values to for <code>maxpop</code> in multiple runs. If set
to <code>NULL</code>, a single STRUCTURE run is conducted with <code>maxpops</code>
groups. If specified, do not also specify <code>maxpops</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.k.rep</code></td>
<td>
<p>number of replicates for each value in <code>k.range</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>label to use for input and output files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delete.files</code></td>
<td>
<p>logical. Delete all files when STRUCTURE is finished?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exec</code></td>
<td>
<p>name of executable for STRUCTURE. Defaults to "structure".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burnin reps [default 10000].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numreps</code></td>
<td>
<p>Number of MCMC replicates [default 1000].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noadmix</code></td>
<td>
<p>Logical. No admixture? [default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freqscorr</code></td>
<td>
<p>Logical. Correlated frequencies? [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomize</code></td>
<td>
<p>Randomize [default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Set random seed [default 0].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.prior</code></td>
<td>
<p>A character specifying which population prior model to use:
"locprior" or "usepopinfo" [default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locpriorinit</code></td>
<td>
<p>Parameterizes locprior parameter r - how informative the
populations are. Only used when pop.prior = "locprior" [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlocprior</code></td>
<td>
<p>Specifies range of locprior parameter r. Only used when 
pop.prior = "locprior" [default 20].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gensback</code></td>
<td>
<p>Integer defining the number of generations back to test for 
immigrant ancestry. Only used when pop.prior = "usepopinfo" [default 2].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>migrprior</code></td>
<td>
<p>Numeric between 0 and 1 listing migration prior. Only used 
when pop.prior = "usepopinfo" [default 0.05].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfrompopflagonly</code></td>
<td>
<p>Logical. update allele frequencies from individuals 
specified by popflag. Only used when pop.prior = "usepopinfo" [default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popflag</code></td>
<td>
<p>A vector of integers (0, 1) or logicals identifiying whether 
or not to use strata information. Only used when pop.prior = "usepopinfo"
[default NULL].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inferalpha</code></td>
<td>
<p>Logical. Infer the value of the model parameter # from the 
data; otherwise is fixed at the value alpha which is chosen by the user. 
This option is ignored under the NOADMIX model. Small alpha implies that 
most individuals are essentially from one population or another, while 
alpha &gt; 1 implies that most individuals are admixed [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Dirichlet parameter for degree of admixture. This is the 
initial value if inferalpha = TRUE [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unifprioralpha</code></td>
<td>
<p>Logical. Assume a uniform prior for alpha which runs 
between 0 and alphamax. This model seems to work fine; the alternative model
(when unfprioralpha = 0) is to take alpha as having a Gamma prior, with 
mean alphapriora × alphapriorb, and variance alphapriora × alphapriorb^2 
[default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphamax</code></td>
<td>
<p>Maximum for uniform prior on alpha when 
unifprioralpha = TRUE [default 20].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphapriora</code></td>
<td>
<p>Parameters of Gamma prior on alpha when 
unifprioralpha = FALSE [default 0.05].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphapriorb</code></td>
<td>
<p>Parameters of Gamma prior on alpha when 
unifprioralpha = FALSE [default 0.001].</p>
</td>
</tr>
</table>
<h3>Value</h3>

 <dl>
<dt><code>structureRun</code></dt>
<dd>
<p>a list where each element is a
list with results from <code>structureRead</code> and a vector of the filenames
used</p>
</dd> <dt><code>structureWrite</code></dt>
<dd>
<p>a vector of the filenames used by
STRUCTURE</p>
</dd> <dt><code>structureRead</code></dt>
<dd>
<p>a list containing: </p>

<dl>
<dt><code>summary</code></dt>
<dd>
<p>new locus name, which is a combination of loci in
group</p>
</dd> <dt><code>q.mat</code></dt>
<dd>
<p>data.frame of assignment probabilities for each
id</p>
</dd> <dt><code>prior.anc</code></dt>
<dd>
<p>list of prior ancestry estimates for each
individual where population priors were used</p>
</dd> <dt><code>files</code></dt>
<dd>
<p>vector of
input and output files used by STRUCTURE</p>
</dd> <dt><code>label</code></dt>
<dd>
<p>label for the
run</p>
</dd> </dl>
</dd> </dl>
<h3>Author(s)</h3>

<p>Bernd Gruber (bugs? Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>); original implementation of
Eric Archer <a href="https://github.com/EricArcher/strataG">https://github.com/EricArcher/strataG</a>
</p>


</div>