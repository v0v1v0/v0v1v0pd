<div class="container">

<table style="width: 100%;"><tr>
<td>cp.chisq.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Comparative Chi-Squared Test for Difference Across Contingency Tables
</h2>

<h3>Description</h3>

<p>Across given contingency tables, the test admits any type of differences in either the joint or marginal distributions underlying the tables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cp.chisq.test(
  tables, method=c("chisq", "nchisq", "default", "normalized"),
  log.p = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>

<p>a list of at least two nonnegative matrices or data frames representing contingency tables of the same dimensions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string to specify the method to compute the chi-squared statistic and its p-value. The default is <code>"chisq"</code>. See Details.
</p>
<p>Note: <code>"default"</code> and <code>"normalized"</code> are deprecated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>

<p>logical; if <code>TRUE</code>, the p-value is given as <code>log(p)</code>. Taking the log improves the accuracy when p-value is close to zero. The default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The comparative chi-squared test determines whether the patterns underlying multiple contingency tables are heterogeneous. Its null test statistic is proved to asymptotically follow the chi-squared distribution (Song et al. 2014; Zhang et al. 2015). This test is different from the heterogeneity test (Zar 2009).
</p>
<p>Two methods are provided to compute the chi-squared statistic and its p-value. When <code>method = "chisq"</code> (or <code>"default"</code>), the p-value is computed using the chi-squared distribution; when <code>method =</code> <code>"nchisq"</code> (or <code>"normalized"</code>) a normalized statistic is obtained by shifting and scaling the original chi-squared test statistic and a p-value is computed using the standard normal distribution
(George et al. 2005). The normalized test is more conservative on the degrees of freedom.
</p>
<p>Either test statistic is minimized to zero if and only if the input tables are linearly scaled versions of each other. 
</p>
<p>The test is recommended to determine whether multiple contingency tables have the same distributions, regardless of independence of row and column variables in each table.
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>chi-squared test statistic if <code>method = "chisq"</code> (equivalent to <code>"default"</code>), or normalized test statistic if <code>method = "nchisq"</code> (equivalent to <code>"normalized"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>degrees of freedom of the chi-squared statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the comparative chi-squared test. By default, it is computed by the chi-squared distribution (<code>method = "chisq"</code> or <code>"default"</code>). If <code>method = "nchisq"</code> (or <code>"normalized"</code>), it is the p-value of the normalized chi-squared statistic using the standard normal distribution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joe Song
</p>


<h3>References</h3>

<p>George EP, Hunter JS, Hunter WG, Bins R, Kirlin IV K, Carroll D (2005).
<em>Statistics for Experimenters: Design, Innovation, and Discovery</em>.
Wiley, New York.<br><br> Song M, Zhang Y, Katzaroff AJ, Edgar BA, Buttitta L (2014).
“Hunting complex differential gene interaction patterns across molecular contexts.”
<em>Nucleic Acids Research</em>, <b>42</b>(7), e57.
doi: <a href="https://doi.org/10.1093/nar/gku086">10.1093/nar/gku086</a>, <a href="https://doi.org/10.1093/nar/gku086">https://doi.org/10.1093/nar/gku086</a>.<br><br> Zar JH (2009).
<em>Biostatistical Analysis</em>, 5th edition.
Prentice Hall, New Jersey.<br><br> Zhang Y, Liu ZL, Song M (2015).
“ChiNet uncovers rewired transcription subnetworks in tolerant yeast for advanced biofuels conversion.”
<em>Nucleic Acids Research</em>, <b>43</b>(9), 4393–4407.
doi: <a href="https://doi.org/10.1093/nar/gkv358">10.1093/nar/gkv358</a>, <a href="https://doi.org/10.1093/nar/gkv358">https://doi.org/10.1093/nar/gkv358</a>. 
</p>


<h3>See Also</h3>

<p>The Sharma-Song test <code>sharma.song.test</code>.
</p>
<p>The heterogeneity test <code>heterogeneity.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Two second-order differential tables:
  tables &lt;- list(
    matrix(c(4,0,0,
             0,4,0,
             0,0,4), nrow=3),
    matrix(c(0,4,4,
             4,0,4,
             4,4,0), nrow=3)
  )
  cp.chisq.test(tables)
  
  # Three tables differ in the first-order but not second-order:
  tables &lt;- list(
    matrix(c(2, 4,  6,  8, 
             3, 6,  9, 12, 
             4, 8, 12, 16), nrow=4),
    matrix(c( 2, 1,  3,  7,
              2, 1,  3,  7,
             10, 5, 15, 35), nrow=4),
    matrix(c(40, 16, 72, 16, 
             45, 18, 81, 18,
             25, 10, 45, 10), nrow=4)
  )
  cp.chisq.test(tables)
</code></pre>


</div>