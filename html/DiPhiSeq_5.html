<div class="container">

<table style="width: 100%;"><tr>
<td>robtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calls the robnb function to estimate the coefficients,
and then construct the statistical tests for DD and DE.
It works for a single gene. y1 and y2 are count vectors for a single gene.
diphiseq calls this function to do the calculation for each gene.
Normal users often don't need to use this function directly.</h2>

<h3>Description</h3>

<p>Calls the robnb function to estimate the coefficients,
and then construct the statistical tests for DD and DE.
It works for a single gene. y1 and y2 are count vectors for a single gene.
diphiseq calls this function to do the calculation for each gene.
Normal users often don't need to use this function directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">robtest(y1, log.depth1, y2, log.depth2, c.tukey.beta = 4, c.tukey.phi = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>counts from group 1. a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.depth1</code></td>
<td>
<p>log(sequencing depths) for samples in group 1. a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2</code></td>
<td>
<p>counts from group 2. a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.depth2</code></td>
<td>
<p>log(sequencing depths) for samples in group 2. a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.tukey.beta</code></td>
<td>
<p>The c value for beta in Huber function. The default value, 4, is typically
regarded as appropriate and should work for most datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.tukey.phi</code></td>
<td>
<p>The c value for phi in Huber function. The default value, 4, is typically
regarded as appropriate and should work for most datasets.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector that contains the elements:
<code>phi1</code>: the estimated dispersion of sample group 1.
<code>phi2</code>: the estimated dispersion of sample group 2.
<code>beta1</code>: the estimated (log) expression of sample group 1.
<code>beta2</code>: the estimated (log) expression of sample group 2.
<code>statistic.phi</code>: the z statistic for DD.
<code>statistic.beta</code>: the z statistic for DE.
<code>p.value.phi</code>: the p value for DD.
<code>p.value.beta</code>: the p value for DE.
</p>


<h3>Examples</h3>

<pre><code class="language-R">d1 &lt;- runif(10, min=1, max=2)
d2 &lt;- runif(15, min=1, max=2)
y1 &lt;- rnbinom(10, size=1, mu=d1*50)
y2 &lt;- rnbinom(15, size=1, mu=d2*50)
res &lt;- robtest(y1, log(d1), y2, log(d2))
</code></pre>


</div>