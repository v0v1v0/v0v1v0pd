<div class="container">

<table style="width: 100%;"><tr>
<td>ivr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-Stage Least Squares (2SLS) Instrumental Variable Regression</h2>

<h3>Description</h3>

<p>Performs a two-stage least squares regression on a single equation including endogenous regressors Y and exogenous regressors X on the right hand-side. Note that by specifying the set of endogenous regressors Y by <code>endog</code> the set of remaining regressors X are assumed to be exogenous and therefore automatically considered as part of the instrument in the first stage of the 2SLS. These variables are not to be specified in the <code>iv</code> argument. Here only instrumental variables outside the equation under consideration are specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ivr(formula, data = list(), endog, iv, contrasts = NULL, details = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of the data frame used. To be specified if variables are not stored in environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endog</code></td>
<td>
<p>character vector of endogenous (to be instrumented) regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iv</code></td>
<td>
<p>character vector of predetermined/exogenous instrumental variables NOT already included in the model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of <code>model.matrix.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>logical value indicating whether details should be printed out by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments that <code>lm.fit()</code> understands.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object including:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>adj.r.squ</code> </td>
<td style="text-align: left;"> adjusted coefficient of determination (adj. R-squared).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>coefficients</code> </td>
<td style="text-align: left;"> IV-estimators of model parameters.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>data/model</code> </td>
<td style="text-align: left;"> matrix of the variables' data used.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>data.name</code> </td>
<td style="text-align: left;"> name of the data frame used.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>df</code> </td>
<td style="text-align: left;"> degrees of freedom in the model (number of observations minus rank).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>exogenous</code> </td>
<td style="text-align: left;"> exogenous regressors.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>f.hausman</code> </td>
<td style="text-align: left;"> exogeneity test: F-value for simultaneous significance of all instrument parameters. If H0: "Instruments are exogenous" is rejected, usage of IV-regression can be justified against OLS.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>f.instr</code> </td>
<td style="text-align: left;"> weak instrument test: F-value for significance of instrument parameter in first stage of 2SLS regression. If H0: "Instrument is weak" is rejected, instruments are usually considered sufficiently strong.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>fitted.values</code> </td>
<td style="text-align: left;"> fitted values of the IV-regression.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>fsd</code> </td>
<td style="text-align: left;"> first stage diagnostics (weakness of instruments).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>has.const</code> </td>
<td style="text-align: left;"> logical value indicating whether model has a constant (internal purposes).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>instrumented</code> </td>
<td style="text-align: left;"> name of instrumented regressors.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>instruments</code> </td>
<td style="text-align: left;"> name of instruments.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>model.matrix</code> </td>
<td style="text-align: left;"> the model (design) matrix.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ncoef</code> </td>
<td style="text-align: left;"> integer, giving the rank of the model (number of coefficients estimated).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>nobs</code> </td>
<td style="text-align: left;"> number of observations.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.hausman</code> </td>
<td style="text-align: left;"> according p-value of exogeneity test.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.instr</code> </td>
<td style="text-align: left;"> according p-value of weak instruments test.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.values</code> </td>
<td style="text-align: left;"> vector of p-values of single parameter significance tests.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>r.squ</code> </td>
<td style="text-align: left;"> coefficient of determination (R-squared).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>residuals</code> </td>
<td style="text-align: left;"> residuals in the IV-regression.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>response</code> </td>
<td style="text-align: left;"> the endogenous (response) variable.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>shea</code> </td>
<td style="text-align: left;"> Shea's partial R-squared quantifying the ability to explain the endogenous regressors.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>sig.squ</code> </td>
<td style="text-align: left;"> estimated error variance (sigma-squared).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ssr</code> </td>
<td style="text-align: left;"> sum of squared residuals.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>std.err</code> </td>
<td style="text-align: left;"> vector of standard errors of the parameter estimators.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>t.values</code> </td>
<td style="text-align: left;"> vector of t-values of single parameter significance tests.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ucov</code> </td>
<td style="text-align: left;"> the (unscaled) variance-covariance matrix of the model's estimators.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>vcov</code> </td>
<td style="text-align: left;"> the (scaled) variance-covariance matrix of the model's estimators.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>modform</code> </td>
<td style="text-align: left;"> the model's regression R-formula.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Auer, L.v. (2023): Ökonometrie - Eine Einführung, 8th ed., Springer-Gabler (<a href="https://www.uni-trier.de/index.php?id=15929">https://www.oekonometrie-lernen.de</a>).
</p>
<p>Wooldridge, J.M. (2013): Introductory Econometrics: A Modern Approach, 5th Edition, Cengage Learning, Datasets available for download at <a href="https://www.cengage.com/cgi-wadsworth/course_products_wp.pl?fid=M20b&amp;product_isbn_issn=9781111531041">Cengage Learning</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Numerical Illustration 20.1 in Auer (2023)
ivr(contr ~ score, endog = "score", iv = "contrprev", data = data.insurance, details = TRUE)

## Replicating an example of Ani Katchova (econometric academy)
## (https://www.youtube.com/watch?v=lm3UvcDa2Hc)
## on U.S. Women's Labor-Force Participation (data from Wooldridge 2013)
library(wooldridge)
data(mroz)

# Select only working women
mroz = mroz[mroz$"inlf" == 1,]
mroz = mroz[, c("lwage", "educ", "exper", "expersq", "fatheduc", "motheduc")]
attach(mroz)

# Regular ols of lwage on educ, where educ is suspected to be endogenous
# hence estimators are biased
ols(lwage ~ educ, data = mroz)

# Manual calculation of ols coeff
Sxy(educ, lwage)/Sxy(educ)

# Manual calculation of iv regression coeff
# with fatheduc as instrument for educ
Sxy(fatheduc, lwage)/Sxy(fatheduc, educ)

# Calculation with 2SLS
educ_hat = ols(educ ~ fatheduc)$fitted
ols(lwage ~ educ_hat)

# Verify that educ_hat is completely determined by values of fatheduc
head(cbind(educ,fatheduc,educ_hat), 10)

# Calculation with ivr()
ivr(lwage ~ educ, endog = "educ", iv = "fatheduc", data = mroz, details = TRUE)

# Multiple regression model with 1 endogenous regressor (educ)
# and two exogenous regressors (exper, expersq)

# Biased ols estimation
ols(lwage ~ educ + exper + expersq, data = mroz)

# Unbiased 2SLS estimation with fatheduc and motheduc as instruments
# for the endogenous regressor educ
ivr(lwage ~ educ + exper + expersq,
    endog = "educ", iv = c("fatheduc", "motheduc"),
    data = mroz)

# Manual 2SLS
# First stage: Regress endog. regressor on all exogen. regressors
# and instruments -&gt; get exogenous part of educ
stage1.mod = ols(educ ~ exper + expersq + fatheduc + motheduc)
educ_hat = stage1.mod$fitted

# Second stage: Replace endog regressor with predicted value educ_hat
# See the uncorrected standard errors!
stage2.mod = ols(lwage ~ educ_hat + exper + expersq, data = mroz)

## Simple test for endogeneity of educ:
## Include endogenous part of educ into model and see if it is signif.
## (is signif. at 10% level)
uhat = ols(educ ~ exper + expersq + fatheduc + motheduc)$resid
ols(lwage ~ educ + exper + expersq + uhat)
detach(mroz)

</code></pre>


</div>