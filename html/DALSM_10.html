<div class="container">

<table style="width: 100%;"><tr>
<td>DesignFormula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function extracting design matrices from formulas in the DALSM function and computing penalty related matrices</h2>

<h3>Description</h3>

<p>Internal function extracting design matrices from formulas in the DALSM function and computing penalty related matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DesignFormula(formula, data, K = 10, pen.order = 2, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula describing the fixed effects and the additive terms in a regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of B-splines to describe an additive term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.order</code></td>
<td>
<p>desired penalty order for the spline parameters in the additive terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of units (Default: number of rows in the design matrix constructed from the formula and the data frame).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with
</p>

<ul>
<li>
<p><code>Z</code> : <code style="white-space: pre;">⁠ ⁠</code>(n x nfixed) design matrix with fixed effects (including a first column of 1).
</p>
</li>
<li>
<p><code>X</code> : <code style="white-space: pre;">⁠ ⁠</code>(n x J) design matrix with the covariates involved in the additive terms.
</p>
</li>
<li>
<p><code>nfixed</code> : <code style="white-space: pre;">⁠ ⁠</code>number of fixed effect regression parameters.
</p>
</li>
<li>
<p><code>J</code> : <code style="white-space: pre;">⁠ ⁠</code>number of additive terms.
</p>
</li>
<li>
<p><code>K</code> : <code style="white-space: pre;">⁠ ⁠</code>number of B-splines in a basis used to estimate an additive term.
</p>
</li>
<li>
<p><code>Bx</code> : <code style="white-space: pre;">⁠ ⁠</code>list with J objects (one per additive term) including (B,Dd,Pd,K,cm).
</p>
</li>
<li>
<p><code>Pd.x, Dd.x</code> : <code style="white-space: pre;">⁠ ⁠</code>penalty and difference penalty matrices applied on the spline parameters of an additive term.
</p>
</li>
<li>
<p><code>knots.x</code> : <code style="white-space: pre;">⁠ ⁠</code>list of length J with the knots associated to each of the J additive terms.
</p>
</li>
<li>
<p><code>Bcal</code> : <code style="white-space: pre;">⁠ ⁠</code>column-stacked matrix with the J centered B-spline bases.
</p>
</li>
<li>
<p><code>Xcal</code> : <code style="white-space: pre;">⁠ ⁠</code>Z column-stacked with the J centered B-spline bases to yield the full design matrix (with column labels).
</p>
</li>
<li>
<p><code>pen.order</code> : <code style="white-space: pre;">⁠ ⁠</code>penalty order for the spline parameters in the additive terms.
</p>
</li>
<li>
<p><code>additive.lab</code> : <code style="white-space: pre;">⁠ ⁠</code>labels for the columns in &lt;Bcal&gt; associated to the additive terms.
</p>
</li>
<li>
<p><code>lambda.lab</code> : <code style="white-space: pre;">⁠ ⁠</code>labels for the penalty parameters.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. (2021). Fast Bayesian inference using Laplace approximations
in nonparametric double additive location-scale models with right- and
interval-censored data.
<em>Computational Statistics and Data Analysis</em>, 161: 107250.
&lt;doi:10.1016/j.csda.2021.107250&gt;
</p>


</div>