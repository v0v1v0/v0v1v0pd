<div class="container">

<table style="width: 100%;"><tr>
<td>internals_for_qqplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal functions for qqplot of package distr</h2>

<h3>Description</h3>

<p>These functions are used internally by qqplot of package distr.</p>


<h3>Usage</h3>

<pre><code class="language-R">.inGaps(x,gapm)
.isReplicated(x, tol = .Machine$double.eps)
.NotInSupport(x,D)
.SingleDiscrete(x,D)
.makeLenAndOrder(x,ord)

.BinomCI.in(t,p.bi,x.i, del.i=0,D.i,n.i,alpha.i)
.BinomCI(x,p.b,D,n,alpha, silent0 = TRUE)
.BinomCI.nosym(x,p.b,D,n,alpha, silent0 = TRUE)

.q2kolmogorov(alpha,n,exact=(n&lt;100), silent0 = TRUE)
.q2pw(x,p.b,D,n,alpha,exact=(n&lt;100),nosym=FALSE, silent0 = TRUE)

.confqq(x,D, datax=FALSE, withConf.pw  = TRUE,  withConf.sim = TRUE, alpha,
                    col.pCI, lty.pCI, lwd.pCI, pch.pCI, cex.pCI,
                    col.sCI, lty.sCI, lwd.sCI, pch.sCI, cex.sCI,
                    n,exact.sCI=(n&lt;100),exact.pCI=(n&lt;100),
                    nosym.pCI = FALSE, with.legend = TRUE,
                    legend.bg = "white", legend.pos = "topleft",
                    legend.cex = 0.8, legend.pref = "", legend.postf = "",
                    legend.alpha = alpha, qqb0 = NULL, transf0=NULL, debug = FALSE)

.deleteItemsMCL(mcl)
.distrExInstalled
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a (numeric) vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gapm</code></td>
<td>
<p>matrix; the gap matrix as in slot <code>gaps</code> of
an <code>"AbscontDistribution"</code> or <code>"UnivarLebDecDistribution"</code>
object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric; tolerance for separating points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>object of class <code>"UnivariateDistribution"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datax</code></td>
<td>
<p>logical; (to be used in <span class="pkg">distrMod</span>) shall data be plotted on x-axis?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>integer; the result of a call to <code>order</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric in [0,1]; confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer; sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>logical; shall finite sample version be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>current  (half of the) width of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.bi</code></td>
<td>
<p>(local) (binomial) c.d.f. value at <code>x.i</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.i</code></td>
<td>
<p>a (numeric) vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del.i</code></td>
<td>
<p>numeric; a (local) asymmetry parameter to pass on to
<code>optim</code> and <code>uniroot</code> — the endpoints of the searched interval
are <code>x.i+t/sqrt(n)+del.i/sqrt(n)</code> and <code>x.i-t/sqrt(n)+del.i/sqrt(n)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.i</code></td>
<td>
<p>object of class <code>"UnivariateDistribution"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.i</code></td>
<td>
<p>integer; (local) sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.i</code></td>
<td>
<p>numeric in [0,1]; (local) confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.b</code></td>
<td>
<p>(binomial) c.d.f. value at <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym</code></td>
<td>
<p>logical; shall we compute shortest (asymmetric) confidence intervals;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.pw</code></td>
<td>
<p>logical; shall pointwise confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withConf.sim</code></td>
<td>
<p>logical; shall simultaneous confidence lines be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.pCI</code></td>
<td>
<p>logical; shall pointwise CIs be determined with exact Binomial distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.sCI</code></td>
<td>
<p>logical; shall simultaneous CIs be determined with exact kolmogorov distribution?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym.pCI</code></td>
<td>
<p>logical; shall we use (shortest) asymmetric CIs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pCI</code></td>
<td>
<p>color for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.pCI</code></td>
<td>
<p>line type for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.pCI</code></td>
<td>
<p>line width for the pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in pointwise CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.sCI</code></td>
<td>
<p>color for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.sCI</code></td>
<td>
<p>line type for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.sCI</code></td>
<td>
<p>line width for the simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.sCI</code></td>
<td>
<p>symbol for points (for discrete mass points) in simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.sCI</code></td>
<td>
<p>magnification factor for points (for discrete mass points) in simultaneous CI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>logical; shall a legend be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.bg</code></td>
<td>
<p>background color for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p>position for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>
<p>magnification factor for the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pref</code></td>
<td>
<p>character to be prepended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.postf</code></td>
<td>
<p>character to be appended to legend text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.alpha</code></td>
<td>
<p>nominal coverage probability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcl</code></td>
<td>
<p>arguments in call as a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqb0</code></td>
<td>
<p>precomputed return value of <code>qqbounds</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transf0</code></td>
<td>
<p>optional transformation of x-values (by default <code>NULL</code> and then ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical; if <code>TRUE</code> additional output to debug confidence bounds. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent0</code></td>
<td>
<p>logical; it is used as argument <code>silent</code> in <code>try</code>-catches
within this function. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>.inGaps</code> produces a logical vector of same length as <code>x</code> with
entries <code>TRUE</code> if the corresponding component of <code>x</code> lies within a
gap as given by gap matrix <code>gapm</code> and <code>FALSE</code> otherwise.
</p>
<p><code>.isReplicated</code> produces a logical vector of same length as <code>x</code> with
entries <code>TRUE</code> if the corresponding component of <code>x</code> appears at least
twice within <code>x</code> and <code>FALSE</code> otherwise.
</p>
<p><code>.NotInSupport</code> produces a logical vector of same length as <code>x</code> with
entries <code>TRUE</code> if the corresponding component of <code>x</code> does not
lie within the support of <code>D</code> and <code>FALSE</code> otherwise.
</p>
<p><code>.SingleDiscrete</code> produces a numerical vector of same length as <code>x</code> with
values <code>0</code>  if the corresponding component of <code>x</code> is discrete mass point
of <code>D</code>, <code>1</code>  if the corresponding component of <code>x</code> lies within
the continuous support of <code>D</code>, <code>2</code> and <code>3</code>
if the corresponding component of <code>x</code>
is a left resp. right end point of a gap of <code>D</code>, and <code>4</code> if
the corresponding component of <code>x</code> does not lie within the support of <code>D</code>
at all.
</p>
<p><code>.makeLenAndOrder</code> by standard recycling roules respectively by truncation
at the end, forces <code>x</code> to length <code>length{ord}</code> and then orders the
result according to <code>ord</code>.
</p>
<p><code>.q2kolmogorov</code>, in the finite sample version (<code>exact==TRUE</code>),
returns the corresponding <code>alpha</code>-quantile
of the exact Kolmogorov distribution multiplied by <code class="reqn">\sqrt{n}</code>, and
in the asymptotic version (<code>exact==FALSE</code>),
the the corresponding (upper) <code>alpha</code>-quantile
of the asymptotic Kolmogorov distribution. Doing so we make use of
C-function <code>"pkolmogorov2x"</code> (from <code>ks.test</code> in package <span class="pkg">stats</span>)
and R-function <code>pkstwo</code> (again from <code>ks.test</code> in package <span class="pkg">stats</span>).
</p>
<p><code>.BinomCI.in</code> in a non-vectorized form, computes,
for given <code>t</code>, <code>x</code>, <code class="reqn">\alpha</code>, <code class="reqn">\delta</code>,
and for <code class="reqn">X\sim D</code>, the discrepancy
</p>
<p style="text-align: center;"><code class="reqn">P(\sqrt{n} |X-x-\delta| \leq t) - \alpha</code>
</p>

<p><code>.BinomCI</code>, in a vectorized form, computes,
for given <code>x</code>, <code class="reqn">\alpha</code>, <code class="reqn">\delta</code>,
values <code>t</code> such that,
pointwise in <code>x</code> and for <code class="reqn">X\sim D</code>,
</p>
<p style="text-align: center;"><code class="reqn">P(\sqrt{n} |X-x-\delta| \leq t) = \alpha</code>
</p>

<p><code>.BinomCI.nosym</code>, in an outer loop, by varying <code>del</code> in the former
formula, tries to minimize the length of
a corresponding level alpha confidence interval containing the estimate.
</p>
<p><code>.q2pw</code> computes  pointwise finite sample or asymptotic confidence widths
by means of binomial probabilities / quantiles, in the former case either
symmetric (default) or shortest asymmetric; in the asymptotic case, for
distributions without a Lebesgue density, for the corresponding
density value at the quantile appearing in the expression for the
asymptotic variance, we make an approximation of <code>(D-E(D))/sd(D)</code> by
the standard normal, using the density of the latter one; this latter approximation
is only  available if <code>.distrExInstalled == TRUE</code>; otherwise the corresponding
columns will be filled with <code>NA</code>.
</p>
<p><code>.confqq</code> calls <code>qqbound</code> to compute the confidence intervals
and plots them; returns the return value of qqbound.
</p>
<p><code>.deleteItemsMCL</code> deletes arguments from a call list which
functions like <code>plot</code>, <code>lines</code>, <code>points</code> cannot digest;
this is necessary in the manipulation of an original call
to a specific <code>qqplot</code> method to pass on the <code>...</code> argument
correctly to calls the mentioned functions.
</p>
<p><code>.distrExInstalled</code> is a constant logical — <code>TRUE</code> if package
<span class="pkg">distrEx</span> is installed.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.inGaps</code></td>
<td>
<p>a logical vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.isReplicated</code></td>
<td>
<p>a logical vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.NotInSupport</code></td>
<td>
<p>a logical vector of same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.SingleDiscrete</code></td>
<td>
<p>a vector of same length as <code>x</code> with entries in the
set <code class="reqn">\{0,1,2,3,4\}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.makeLenAndOrder</code></td>
<td>
<p>a numeric of length <code>length(ord</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.BinomCI.in</code></td>
<td>
<p>a numeric of length 1: the discrepancy
</p>
<p style="text-align: center;"><code class="reqn">P(\sqrt{n} |X-x-\delta| \leq t) - \alpha</code>
</p>

</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.BinomCI</code></td>
<td>
<p>a numeric matrix with two columns <code>"left"</code> and <code>"right"</code>
with the corresponding pointwise confidence widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.BinomCI.nosym</code></td>
<td>
<p>a numeric matrix with two columns <code>"left"</code> and <code>"right"</code>
with the corresponding pointwise confidence widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.q2kolmogorov</code></td>
<td>
<p>a numeric of length 1; a corresponding quantile of the
(exact/asymptotic) Kolmogorov distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.q2pw</code></td>
<td>
<p>a numeric matrix with two columns <code>"left"</code> and <code>"right"</code>
with the corresponding pointwise confidence widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.confqq</code></td>
<td>
<p><code>invisible(NULL)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.deleteItemsMCL</code></td>
<td>
<p>the manipulated list of arguments</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Ruckdeschel <a href="mailto:peter.ruckdeschel@uni-oldenburg.de">peter.ruckdeschel@uni-oldenburg.de</a>,
</p>


<h3>See Also</h3>

<p><code>ks.test</code>, <code>qqplot</code>
, <code>qqplot</code>, <code>qqplot</code>
</p>


</div>