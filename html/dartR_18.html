<div class="container">

<table style="width: 100%;"><tr>
<td>gl.diagnostics.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comparing simulations against theoretical expectations</h2>

<h3>Description</h3>

<p>Comparing simulations against theoretical expectations
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.diagnostics.sim(
  x,
  Ne,
  iteration = 1,
  pop_he = 1,
  pops_fst = c(1, 2),
  plot_theme = theme_dartR(),
  save2tmp = FALSE,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output from function <code>gl.sim.WF.run</code> [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ne</code></td>
<td>
<p>Effective population size to use as input to compare theoretical 
expectations [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>Iteration number to analyse [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_he</code></td>
<td>
<p>Population name in which the rate of loss of heterozygosity is
going to be compared against theoretical expectations [default 1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pops_fst</code></td>
<td>
<p>Pair of populations in which FST is going to be compared 
against theoretical expectations [default c(1,2)].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_theme</code></td>
<td>
<p>User specified theme [default theme_dartR()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save2tmp</code></td>
<td>
<p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default NULL, unless specified using gl.set.verbosity].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two plots are presented comparing the simulations against theoretical 
expectations:
</p>

<ol>
<li>
<p> Expected heterozygosity under neutrality (Crow &amp; Kimura, 1970, p. 329) is 
calculated as:
</p>
<p>Het = He0(1-(1/2Ne))^t,
</p>
<p>where Ne is effective population size, He0  is heterozygosity at generation 0
and t is the number of generations.
</p>
</li>
<li>
<p> Expected FST under neutrality (Takahata, 1983) is calculated as:
</p>
<p>FST=1/(4Nem(n/(n-1))^2+1),
</p>
<p>where Ne is effective populations size of each individual subpopulation, m is
dispersal rate and n the number of subpopulations (always 2).
</p>
</li>
</ol>
<h3>Value</h3>

<p>Returns plots comparing simulations against theoretical expectations
</p>


<h3>Author(s)</h3>

<p>Custodian: Luis Mijangos â€“ Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>
</p>


<h3>References</h3>


<ul>
<li>
<p> Crow JF, Kimura M. An introduction to population genetics theory. An 
introduction to population genetics theory. 1970.
</p>
</li>
<li>
<p> Takahata N. Gene identity and genetic differentiation of populations in 
the finite island model. Genetics. 1983;104(3):497-512.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>gl.filter.callrate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ref_table &lt;- gl.sim.WF.table(file_var=system.file('extdata', 
'ref_variables.csv', package = 'dartR'),interactive_vars = FALSE)
res_sim &lt;- gl.sim.WF.run(file_var = system.file('extdata', 
'sim_variables.csv', package ='dartR'),ref_table=ref_table,
interactive_vars = FALSE,number_pops_phase2=2,population_size_phase2="50 50")
res &lt;- gl.diagnostics.sim(x=res_sim,Ne=50)

## End(Not run)
</code></pre>


</div>