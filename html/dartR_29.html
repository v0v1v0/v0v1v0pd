<div class="container">

<table style="width: 100%;"><tr>
<td>gl.filter.callrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filters loci or specimens in a genlight {adegenet} object based on
call rate</h2>

<h3>Description</h3>

<p>SNP datasets generated by DArT have missing values primarily arising from
failure to call a SNP because of a mutation at one or both of the restriction
enzyme recognition sites. The script gl.filter.callrate() will filter out the
loci with call rates below a specified threshold.
</p>
<p>Tag Presence/Absence datasets (SilicoDArT) have missing values where it is
not possible to determine reliably if there the sequence tag can be called at
a particular locus.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.filter.callrate(
  x,
  method = "loc",
  threshold = 0.95,
  mono.rm = FALSE,
  recalc = FALSE,
  recursive = FALSE,
  plot.out = TRUE,
  plot_theme = theme_dartR(),
  plot_colors = two_colors,
  bins = 25,
  save2tmp = FALSE,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Name of the genlight object containing the SNP data, or the genind
object containing the SilocoDArT data [required].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Use method='loc' to specify that loci are to be filtered, 'ind'
to specify that specimens are to be filtered, 'pop' to remove loci that 
fail to meet the specified threshold in any one population [default 'loc'].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold value below which loci will be removed
[default 0.95].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mono.rm</code></td>
<td>
<p>Remove monomorphic loci after analysis is complete
[default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recalc</code></td>
<td>
<p>Recalculate the locus metadata statistics if any individuals
are deleted in the filtering [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recursive</code></td>
<td>
<p>Repeatedly filter individuals on call rate, each time
removing monomorphic loci. Only applies if method='ind' and mono.rm=TRUE
[default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.out</code></td>
<td>
<p>Specify if histograms of call rate, before and after, are to
be produced [default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_theme</code></td>
<td>
<p>User specified theme for the plot [default theme_dartR()].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_colors</code></td>
<td>
<p>List of two color names for the borders and fill of the
plots [default two_colors].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Number of bins to display in histograms [default 25].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save2tmp</code></td>
<td>
<p>If TRUE, saves any ggplots and listings to the session
temporary directory (tempdir) [default FALSE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2, unless specified using gl.set.verbosity].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Because this filter operates on call rate, this function recalculates Call
Rate, if necessary, before filtering. If individuals are removed using
method='ind', then the call rate stored in the genlight object is, 
optionally,
recalculated after filtering.
</p>
<p>Note that when filtering individuals on call rate, the initial call rate is
calculated and compared against the threshold. After filtering, if
mono.rm=TRUE, the removal of monomorphic loci will alter the call rates.
Some individuals with a call rate initially greater than the nominated
threshold, and so retained, may come to have a call rate lower than the
threshold. If this is a problem, repeated iterations of this function will
resolve the issue. This is done by setting mono.rm=TRUE and recursive=TRUE,
or it can be done manually.
</p>
<p>Callrate is summarized by locus or by individual to allow sensible decisions
on thresholds for filtering taking into consideration consequential loss of
data. The summary is in the form of a tabulation and plots.
</p>
<p>Plot themes can be obtained from </p>

<ul>
<li> <p><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">https://ggplot2.tidyverse.org/reference/ggtheme.html</a> and </p>
</li>
<li>
<p><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a>
</p>
</li>
</ul>
<p>Resultant ggplot(s) and the tabulation(s) are saved to the session's
temporary directory.
</p>


<h3>Value</h3>

<p>The reduced genlight or genind object, plus a summary
</p>


<h3>Author(s)</h3>

<p>Custodian: Arthur Georges â€“ Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>
</p>


<h3>See Also</h3>

<p><code>gl.report.callrate</code>
</p>
<p>Other filter functions: 
<code>gl.filter.allna()</code>,
<code>gl.filter.heterozygosity()</code>,
<code>gl.filter.hwe()</code>,
<code>gl.filter.ld()</code>,
<code>gl.filter.locmetric()</code>,
<code>gl.filter.maf()</code>,
<code>gl.filter.monomorphs()</code>,
<code>gl.filter.overshoot()</code>,
<code>gl.filter.parent.offspring()</code>,
<code>gl.filter.pa()</code>,
<code>gl.filter.rdepth()</code>,
<code>gl.filter.reproducibility()</code>,
<code>gl.filter.secondaries()</code>,
<code>gl.filter.sexlinked()</code>,
<code>gl.filter.taglength()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# SNP data
  result &lt;- gl.filter.callrate(testset.gl[1:10], method='loc', threshold=0.8,
   verbose=3)
  result &lt;- gl.filter.callrate(testset.gl[1:10], method='ind', threshold=0.8,
   verbose=3)
  result &lt;- gl.filter.callrate(testset.gl[1:10], method='pop', threshold=0.8,
   verbose=3)
# Tag P/A data
  result &lt;- gl.filter.callrate(testset.gs[1:10], method='loc', 
  threshold=0.95, verbose=3)
  result &lt;- gl.filter.callrate(testset.gs[1:10], method='ind', 
  threshold=0.8, verbose=3)
  result &lt;- gl.filter.callrate(testset.gs[1:10], method='pop', 
  threshold=0.8, verbose=3)
  
  res &lt;- gl.filter.callrate(platypus.gl)

</code></pre>


</div>