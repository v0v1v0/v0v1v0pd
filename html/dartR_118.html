<div class="container">

<table style="width: 100%;"><tr>
<td>gl.sfs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a site frequency spectrum based on a dartR or genlight object</h2>

<h3>Description</h3>

<p>Creates a site frequency spectrum based on a dartR or genlight object
</p>


<h3>Usage</h3>

<pre><code class="language-R">gl.sfs(
  x,
  minbinsize = 0,
  folded = TRUE,
  singlepop = FALSE,
  plot.out = TRUE,
  verbose = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>dartR/genlight object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minbinsize</code></td>
<td>
<p>remove bins from the left of the sfs. For example to remove
singletons (alleles only occurring once among all individuals) set
minbinsize to 2. If set to zero, also monomorphic (d0) loci are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folded</code></td>
<td>
<p>if set to TRUE (default) a folded sfs (minor allele frequency
sfs) is returned. If set to FALSE then an unfolded (derived allele frequency
sfs) is returned. It is assumed that 0 is homozygote for the reference and
2 is homozygote for the derived allele. So you need to make sure your
coding is correct.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singlepop</code></td>
<td>
<p>switch to force to create a one-dimensional sfs, even
though the genlight/dartR object contains more than one population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.out</code></td>
<td>
<p>Specify if plot is to be produced [default TRUE].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbosity: 0, silent or fatal errors; 1, begin and end; 2,
progress log ; 3, progress and results summary; 5, full report
[default 2, unless specified using gl.set.verbosity].</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns a site frequency spectrum, either a one dimensional vector
(only a single population in the dartR/genlight object or singlepop=TRUE) or
an n-dimensional array (n is the number of populations in the genlight/dartR
object). If the dartR/genlight object consists of several populations the
multidimensional site frequency spectrum for each population is returned
[=a multidimensional site frequency spectrum]. Be aware the
multidimensional spectrum works only for a limited number of population
and individuals [if too high the table command used internally will
through an error as the number of populations and individuals (and
therefore dimensions) are too large]. To get a single sfs for a
genlight/dartR object with multiple populations, you need to set
singlepop to TRUE. The returned sfs can be used to analyse demographics,
e.g. using fastsimcoal2.
</p>


<h3>Author(s)</h3>

<p>Custodian: Bernd Gruber &amp; Carlo Pacioni (Post to
<a href="https://groups.google.com/d/forum/dartr">https://groups.google.com/d/forum/dartr</a>)
</p>


<h3>References</h3>

<p>Excoffier L., Dupanloup I., Huerta-SÃ¡nchez E., Sousa V. C. and
Foll M. (2013) Robust demographic inference from genomic and SNP data. PLoS
genetics 9(10)
</p>


<h3>Examples</h3>

<pre><code class="language-R">gl.sfs(bandicoot.gl, singlepop=TRUE)
gl.sfs(possums.gl[c(1:5,31:33),], minbinsize=1)
</code></pre>


</div>