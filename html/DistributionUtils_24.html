<div class="container">

<table style="width: 100%;"><tr>
<td>moranTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Moran's Log Spacings Test
</h2>

<h3>Description</h3>

<p>This function implements a goodness-of-fit test using Moran's log
spacings statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moranTest(x, densFn, param = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>densFn</code></td>
<td>
<p>Character. The root name of the distribution to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric. Vector of data to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Numeric. A vector giving the parameter values for the
distribution specified by <code>densFn</code>. If no <code>param</code> values
are specified, then the default parameter values of the
distribution are used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to allow specification of the
parameters of the distribution other than specified by <code>param</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Moran(1951) gave a statistic for testing the goodness-of-fit of a
random sample of <code class="reqn">x</code>-values to a continuous univariate
distribution with cumulative distribution function
<code class="reqn">F(x,\theta)</code>, where <code class="reqn">\theta</code> is a vector of known
parameters. This function implements the Cheng and Stephens(1989)
extended Moran test for unknown parameters.
</p>
<p>The test statistic is
</p>
<p style="text-align: center;"><code class="reqn">T(\hat \theta)=(M(\hat
    \theta)+1/2k-C_1)/C_2</code>
</p>

<p>Where <code class="reqn">M(\hat \theta)</code>, the Moran statistic, is
</p>
<p style="text-align: center;"><code class="reqn">M(\theta)=-(log(y_1-y_0)+log(y_2-y_1)+...+log(y_m-y_{m-1}))</code>
</p>

<p>M(theta)=-(log(y_1-y_0)+log(y_2-y_1)+...+log(y_m-y_m-1))
</p>
<p>This test has null hypothesis:
<code class="reqn">H_0</code> : a random sample of <code class="reqn">n</code> values of <code class="reqn">x</code> comes
from distribution <code class="reqn">F(x, \theta)</code>, where
<code class="reqn">\theta</code> is the vector of parameters.
Here <code class="reqn">\theta</code> is expected to be the maximum
likelihood estimate <code class="reqn">\hat \theta</code>, an efficient
estimate. The test rejects <code class="reqn">H_0</code> at significance level
<code class="reqn">\alpha</code> if <code class="reqn">T(\hat \theta)</code> &gt;
<code class="reqn">\chi^2_n(\alpha)</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Numeric. The value of the Moran test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Numeric. A vector of parameter estimates for the tested
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>Numeric. The degrees of freedom for the Moran statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>Numeric. The p-value for the test</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>Character. A character string giving the name(s) of the
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character. Type of test performed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Xinxing Li <a href="mailto:xli053@aucklanduni.ac.nz">xli053@aucklanduni.ac.nz</a>
</p>


<h3>References</h3>

<p>Cheng, R. C. &amp; Stephens, M. A. (1989). A goodness-of-fit test using
Moran's statistic with estimated parameters. <em>Biometrika</em>,
<b>76</b>, 385–92.
</p>
<p>Moran, P. (1951). The random division of an interval—PartII.
<em>J. Roy. Statist. Soc. B</em>, <b>13</b>, 147–50.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Normal Distribution
x &lt;- rnorm(100, mean = 0, sd = 1)
muhat &lt;- mean(x)
sigmahat &lt;- sqrt(var(x)*(100 - 1)/100)
result &lt;- moranTest(x, "norm", mean = muhat, sd = sigmahat)
result

### Exponential Distribution
y &lt;- rexp(200, rate = 3)
lambdahat &lt;- 1/mean(y)
result &lt;- moranTest(y, "exp", rate = lambdahat)
result
</code></pre>


</div>