<div class="container">

<table style="width: 100%;"><tr>
<td>plot.DTRreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Diagnostic Plots for DTR Estimation</h2>

<h3>Description</h3>

<p>Diagnostic plots for assessment of treatment, treatment-free, and blip models 
following DTR estimation using DTRreg or DWSurv.
</p>
<p>DTR estimation using G-estimation and dWOLS requires the specification of 
three models: the treatment, treatment-free, and blip.  The treatment model 
may be assessed via standard diagnostics, whereas the treatment-free and 
blip models may be simultaneously assessed using diagnostic plots 
introduced by Rich et al.  The plot() function first presents diagnostic 
plots that assess the latter, plotting fitted values against residuals and 
covariates following DTR estimation.  If there is any evidence of a 
relationship between the variables in these plots, this is evidence that at 
least one of the blip or treatment-free models is mis-specified.
</p>
<p>Following these plots, the plot() function will present standard diagnostic 
plots for the treatment model.  These are produced directly by the standard 
plot() command applied to the models that were fit.  For example, if 
treatment is binary, the resulting plots are the same as those that are 
generated by the plot() command applied to a glm object for logistic 
regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'DTRreg'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A model object generated by the functions DTRreg and DWSurv.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Space for additional arguments (not currently used)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Wallace
</p>


<h3>References</h3>

<p>Chakraborty, B., Moodie, E. E. M. (2013) <em>Statistical Methods for 
Dynamic Treatment Regimes</em>. New York: Springer.
</p>
<p>Rich B., Moodie E. E. M., Stephens D. A., Platt R. W. (2010) Model 
Checking with Residuals for G-estimation of Optimal Dynamic Treatment 
Regimes. <em>International Journal of Biostatistics</em> <b>6</b>(2), 
Article 12.
</p>
<p>Robins, J. M. (2004) <em>Optimal structural nested models for optimal 
sequential decisions</em>. In Proceedings of the Second Seattle Symposium on 
Biostatistics, D. Y. Lin and P. J. Heagerty (eds), 189-326. 
New York: Springer.
</p>
<p>Wallace, M. P., Moodie, E. M. (2015) Doubly-Robust Dynamic Treatment 
Regimen Estimation Via Weighted Least Squares. <em>Biometrics</em> 
<b>71</b>(3), 636-644 (doi:10.1111/biom.12306.)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example single run of a 2-stage g-estimation analysis

set.seed(1)

# expit function
expit &lt;- function(x) { 1.0 / (1.0 + exp(-x)) }

# sample size
n &lt;- 10000

# variables (X = patient information, A = treatment)
X1 &lt;- rnorm(n)
A1 &lt;- rbinom(n, 1, expit(X1))
X2 &lt;- rnorm(n)
A2 &lt;- rbinom(n, 1, expit(X2))

# blip functions
gamma1 &lt;- A1 * (1 + X1)
gamma2 &lt;- A2 * (1 + X2)

# observed outcome: treatment-free outcome plus blip functions
Y &lt;- exp(X1) + exp(X2) + gamma1 + gamma2 + rnorm(n)

# models to be passed to DTRreg
# blip model
blip.mod &lt;- list(~ X1, ~ X2)
# treatment model (correctly specified)
treat.mod &lt;- list(A1 ~ X1, A2 ~ 1)
# treatment-free model (incorrectly specified)
tf.mod &lt;- list(~ X1, ~ X2)

# perform G-estimation
mod1 &lt;- DTRreg(twoStageCont$Y, blip.mod, treat.mod, tf.mod, 
               data = twoStageCont, method = "gest")
 
# model diagnostics: note treatment-free model is mis-specified
plot(mod1)

</code></pre>


</div>