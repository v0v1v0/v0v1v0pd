<div class="container">

<table style="width: 100%;"><tr>
<td>rank2map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert SNP Ranks To Windows Corresponding to Mapping Distance</h2>

<h3>Description</h3>

<p>This function estimates positions of ordered single nucleotide polymorphisms (SNPs) that correspond
to a window spanning a user-defined distance in the SNP positions mapped to a reference.
Each window is centered at the SNP mapped position.
Conversion of a SNP rank position metric to a mapped position metric is useful for
kernel smoothing of the <code>diem</code>
output state along a genomic sequence.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rank2map(includedSites, ChosenSites = "all", windowSize = 1e+07, nCores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>includedSites</code></td>
<td>
<p>A character path to a file with columns <code>CHROM</code> and <code>POS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ChosenSites</code></td>
<td>
<p>A logical vector indicating which sites are to be included in the
analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowSize</code></td>
<td>
<p>A numeric window size for metric conversion in base-pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>
<p>A numeric number of cores to be used for parallelisation. Must be
<code>nCores = 1</code> on Windows.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Single nucleotide polymorphisms (SNPs) tend to be spread across a genome randomly.
To facilitate interpretation of the <code>diem</code> output, the marker states should be
assessed on the metric of their position along chromosomes (contigs). The windows for
kernel smoothing might contain a variable number of markers. This function estimates
which markers should be assessed together given their proximity on a chromosome.
</p>
<p>Values in <code>includedSites</code> are in essence SNP positions in BED format with a header.
The <code>includedSites</code> file should ideally be generated by
vcf2diem to ensure congruence across all analyses.
</p>
<p>The function reads SNP positions from the specified BED-like file and divides the
genome into segments based on chromosomes. Each segment is then processed to identify
genomic windows encompassing each SNP, considering the specified window size. This
process is parallelized to enhance performance, and each SNP is considered within
its chromosomal context to ensure accurate window placement.
</p>
<p>Minimum value of <code>windowSize</code> is equal to 3, but in genomic data evaluations, window
size should be at least two orders of magnitude larger. A good approximation of a
useful minimum window size is $(genome size) / ((number of SNPSs) / 2)$.
</p>


<h3>Value</h3>

<p>A two-column matrix with the number of rows corresponding to the number of
<code>ChosenSites</code>, indicating start and end indices of adjacent markers that are
within an interval of length <code>windowSize</code> centered on the specific marker.
</p>


<h3>Note</h3>

<p>The unit of parallelization when using <code>nCores &gt; 1</code> is set per chromosome.
This may differ from the parallelization approach used in diem, where processing
of compartment files is parallelized. Note that while compartment files can correspond
to chromosomes, this is not necessarily the case.
</p>


<h3>Author(s)</h3>

<p>Natalia Martinkova
</p>
<p>Filip Jagos <a href="mailto:521160@mail.muni.cz">521160@mail.muni.cz</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
 # Run this example in a working directory with write permissions
 myo &lt;- system.file("extdata", "myotis.vcf", package = "diemr")
 vcf2diem(myo, "myo")
 rank2map("myo-includedSites.txt", windowSize = 50)
 
## End(Not run) 
</code></pre>


</div>