<div class="container">

<table style="width: 100%;"><tr>
<td>CalcStatsAllClusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtains the clusters with the maximum log-likelihood ratio or minimum DIC
for each center and start and end dates.</h2>

<h3>Description</h3>

<p>This function explores all possible clusters changing their center and start
and end dates. For each center and time periods, it obtains the cluster with
the maximum log-likelihood ratio or minimum DIC so that the maximum fraction
of the total population inside the cluster is less than fractpop, 
and the maximum distance to the center is less than radius.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalcStatsAllClusters(
  thegrid,
  CalcStatClusterGivenCenter,
  stfdf,
  rr,
  typeCluster,
  sortDates,
  idMinDateCluster,
  idMaxDateCluster,
  fractpop,
  model0,
  ClusterSizeContribution,
  numCPUS
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>thegrid</code></td>
<td>
<p>grid with the coordinates of the centers of the clusters
explored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CalcStatClusterGivenCenter</code></td>
<td>
<p>function to obtain the cluster with the
maximum log-likelihood ratio of all the clusters with the same center and
start and end dates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stfdf</code></td>
<td>
<p>spatio-temporal class object containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr</code></td>
<td>
<p>square of the maximum radius of the cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeCluster</code></td>
<td>
<p>type of clusters to be detected. "ST" for spatio-temporal
clusters or "S" spatial clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortDates</code></td>
<td>
<p>sorted vector of the times where disease cases occurred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idMinDateCluster</code></td>
<td>
<p>index of the closest date to the start date of the
cluster in the vector sortDates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idMaxDateCluster</code></td>
<td>
<p>index of the closest date to the end date of the
cluster in the vector sortDates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fractpop</code></td>
<td>
<p>maximum fraction of the total population inside the cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model0</code></td>
<td>
<p>Initial model (including covariates).
This can be "glm" for generalized linear models (glm stats),
"glmer" for generalized linear mixed model (glmer lme4),
"zeroinfl" for zero-inflated models (zeroinfl), or
"inla" for generalized linear, generalized linear mixed or zero-inflated models fitted with <code>inla</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterSizeContribution</code></td>
<td>
<p>Variable used to check the fraction of the 
population at risk in the cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCPUS</code></td>
<td>
<p>Number of cpus used when using parallel  to run the method.
If parallel is not used numCPUS is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data frame with information of the clusters with the maximum
log-likelihood ratio or minimum DIC for each center and start and end dates.
It contains the coordinates of the center, the size, the start and end dates,
the log-likelihood ratio or DIC, the p-value and the risk of each of the clusters.
</p>


</div>