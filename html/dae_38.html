<div class="container">

<table style="width: 100%;"><tr>
<td>fac.ar1mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>forms the ar1 correlation matrix for a (generalized) factor</h2>

<h3>Description</h3>

<p>Form the correlation matrix for a (generalized) factor where the 
correlation between the levels follows an autocorrelation of order 1 (ar1) 
pattern.</p>


<h3>Usage</h3>

<pre><code class="language-R">fac.ar1mat(factor, rho)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>The (generalized) <code>factor</code> for which the correlation between 
its levels displays an ar1 pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The correlation parameter for the ar1 process.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method is:
a) form an <code>n x n</code> matrix of all pairwise differences in the numeric values 
corresponding to the observed levels of the factor by taking the 
difference between the following two n x n matrices are equal: 1) each row 
contains the numeric values corresponding to the observed levels of the 
factor, and 2) each column contains the numeric values corresponding to 
the observed levels of the factor, 
b) replace each element of the pairwise difference matrix with rho raised to 
the absolute value of the difference.
</p>


<h3>Value</h3>

<p>An n x n <code>matrix</code>, where n is the length of the 
<code>factor</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>fac.vcmat</code>, <code>fac.meanop</code>, 
<code>fac.sumop</code> in package <span class="pkg">dae</span>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## set up a two-level factor and a three-level factor, both of length 12
A &lt;- factor(rep(1:2, each=6))
B &lt;- factor(rep(1:3, each=2, times=2))

## create a 12 x 12 ar1 matrix corrresponding to B
ar1.B &lt;- fac.ar1mat(B, 0.6)
</code></pre>


</div>