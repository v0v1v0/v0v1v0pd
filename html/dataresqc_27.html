<div class="container">

<table style="width: 100%;"><tr>
<td>wmo_gross_errors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>WMO Gross Errors Tests for Pressure, Temperature, Dew Point, and Wind Speed.</h2>

<h3>Description</h3>

<p>Applicable to a series (daily or sub-daily) of air pressure, air temperature (ta),
dew point temperature (td), wind speed (w).
The pressure series can be at mean sea level (mslp) or at station level (p). 
Flags the records where the observations values exceed the limit values given 
by WMO (1993).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wmo_gross_errors(series, meta = NULL, outpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A character string giving the path of the SEF file, or a
five or seven-column (daily or subdaily) data frame with the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta</code></td>
<td>
<p>A character vector with 6 elements: station ID, latitude, longitude,
altitude, variable code, units. If <code>series</code> is a path, <code>meta</code> is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outpath</code></td>
<td>
<p>Character string giving the path for the QC results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Input:</strong>
</p>

<ul><li>
<p> A SEF file or a data frame and metadata. The observations data frame
must have five or seven columns: variable code, year (YYYY), month (MM), day
(DD), (hour (HH), minute (MM)), observation. The required metadata are the
station identifier, the station latitude and variable units.
</p>
</li></ul>
<p><strong>The WMO gross error limits for air pressure, air temperature, dew
point temperature, and wind speed:</strong>
</p>

<ul>
<li>
<p> For station level pressure the gross error limits are latitude and
meteorological season independent (WMO, 1993: VI.7). According to the same
reference, for mean sea level pressure, temperature, dew point, and wind speed,
the WMO establishes the gross error limits as
function of the station latitude and the meteorological season in which the
observations were collected.
</p>
</li>
<li>
<p> The tests divide the meteorological seasons in Winter and Summer. So,
based on the meteorological calendar for the Northern Hemisphere, which
defines seasons as Spring (March, April, May), Summer (June, July, August),
Autumn (September, October, November) and Winter (December, January,
February), it was here considered:
</p>

<ul>
<li>
<p> Northern Hemisphere Winter / Southern Hemisphere Summer - January,
February, March, October, November, December;
</p>
</li>
<li>
<p> Northern Hemisphere Summer / Southern Hemisphere Winter  - April, May,
June, July, August, September.
</p>
</li>
</ul>
</li>
<li>
<p> The gross error limits for each variable divide the flagged values in
suspect and erroneous (WMO, 1993: VI.6 - VI.8).
</p>
</li>
<li> <p><strong>Latitude independent</strong>
</p>

<ul><li> <p><strong>Meteorological season independent</strong>
</p>

<ul><li> <p><strong>Station Level Pressure (p):</strong> 
</p>

<ul>
<li>
<p> Suspect: <em>300 &lt;= p &lt; 400 hPa or 1080 &lt; p &lt;= 1100 hPa</em>
</p>
</li>
<li>
<p> Erroneous: <em>p &lt; 300 or p &gt; 1100 hPa</em>
</p>
</li>
</ul>
</li></ul>
</li></ul>
</li>
<li> <p><strong>Latitudes belonging to the interval [-45, +45]</strong>
</p>

<ul>
<li> <p><strong>Winter</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>870 &lt;= mslp &lt; 910 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li>
<p> Erroneous: <em>mslp &lt; 870 hPa or mslp &gt; 1100 hPa</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-40 &lt;= ta &lt; -30 ºC or 50 &lt; ta &lt;= 55 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>ta &lt; -40 ºC or ta &gt; 55 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-45 &lt;= td &lt; -35 ºC or 35 &lt; td &lt;= 40 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>td &lt; -45 ºC or td &gt; 40 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>w &gt; 60 m/s and w &lt;= 125 m/s</em>
</p>
</li>
<li>
<p> Erroneous: <em>w &gt; 125 m/s</em>
</p>
</li>
</ul>
</li>
</ul>
</li>
<li> <p><strong>Summer</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>850 &lt;= mslp &lt; 900 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li>
<p> Erroneous: <em>mslp &lt; 850 hPa or mslp &gt; 1100 hPa</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-30 &lt;= ta &lt; -20 ºC or 50 &lt; ta &lt;= 60 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>ta &lt; -30 ºC or ta &gt; 60 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-35 &lt;= td &lt; -25 ºC or 35 &lt; td &lt;= 40 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>td &lt; -35 ºC or td &gt; 40 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>w &gt; 90 m/s and w &lt;= 150 m/s</em>
</p>
</li>
<li>
<p> Erroneous: <em>w &gt; 150 m/s</em>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li> <p><strong>Latitudes belonging to the interval [-90, -45[ U ]+45, +90]</strong>
</p>

<ul>
<li> <p><strong>Winter</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>910 &lt;= mslp &lt; 940 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li>
<p> Erroneous: <em>mslp &lt; 910 hPa or mslp &gt; 1100 hPa</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-90 &lt;= ta &lt; -80 ºC or 35 &lt; ta &lt;= 40 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>ta &lt; -90 ºC or ta &gt; 40 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-99 &lt;= td &lt; -85 ºC or 30 &lt; td &lt;= 35 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>td &lt; -99 ºC or td &gt; 35 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>w &gt; 50 m/s and w &lt;= 100 m/s</em>
</p>
</li>
<li>
<p> Erroneous: <em>w &gt; 100 m/s</em>
</p>
</li>
</ul>
</li>
</ul>
</li>
<li> <p><strong>Summer</strong>
</p>

<ul>
<li> <p><strong>Mean Sea Level Pressure (mslp)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>920 &lt;= mslp &lt; 950 hPa or 1080 &lt; mslp &lt;= 1100 hPa</em>
</p>
</li>
<li>
<p> Erroneous: <em>mslp &lt; 920 hPa or mslp &gt; 1100 hPa</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Air Temperature (ta)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-40 &lt;= ta &lt; -30 ºC or 40 &lt; ta &lt;= 50 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>ta &lt; -40 ºC or ta &gt; 50 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Dew Point Temperature (td)</strong>
</p>

<ul>
<li>
<p> Suspect: <em>-45 &lt;= td &lt; -35 ºC or 35 &lt; td &lt;= 40 ºC</em>
</p>
</li>
<li>
<p> Erroneous: <em>td &lt; -45 ºC or td &gt; 40 ºC</em>
</p>
</li>
</ul>
</li>
<li> <p><strong>Wind Speed (w)</strong>
</p>

<ul>
<li>
<p> Suspect values: <em>w &gt; 40 m/s and w &lt;= 75 m/s</em>
</p>
</li>
<li>
<p> Erroneous values: <em>w &gt; 75 m/s</em>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Output:</strong>
</p>

<ul><li>
<p> A text file of flagged observations with six or eight columns: variable
code, year (YYYY), month (MM), day (DD), (hour (HH), minute (MM)),
observation, test. The test column has the description "gross_errors".
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Clara Ventura, Yuri Brugnara
</p>


<h3>References</h3>

<p>WMO, 1993: Chapter 6 - Quality Control Procedures. Guide on the Global
Data-processing System, World Meteorological Organization, Geneva, No. 305,
VI.1-VI.27, ISBN 92-63-13305-0.
</p>


<h3>Examples</h3>

<pre><code class="language-R">wmo_gross_errors(series = Rosario$p, meta = Meta$p[which(Meta$p$id=="Rosario"),],
                 outpath = tempdir())
wmo_gross_errors(series = Rosario$ta, meta = Meta$ta[which(Meta$p$id=="Rosario"),],
                 outpath = tempdir())
wmo_gross_errors(series = Rosario$td, meta = Meta$td, outpath = tempdir())

</code></pre>


</div>