<div class="container">

<table style="width: 100%;"><tr>
<td>fac.meanop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>computes the projection matrix that produces means</h2>

<h3>Description</h3>

<p>Computes the symmetric projection matrix that produces the means 
corresponding to a (generalized) <code>factor</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">fac.meanop(factor)</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>The (generalized) <code>factor</code> whose means the projection matrix
computes from an observation-length vector.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The design matrix <b>X</b> for a (generalized) <code>factor</code> is formed with a 
column for each <code>level</code> of the (generalized) <code>factor</code>, this column 
being its indicator variable. The projection matrix is formed as 
<code>X %*% (1/diag(r) %*% t(X)</code>, where <code>r</code> is the <code>vector</code> of 
<code>levels</code> replications.
</p>
<p>A generalized <code>factor</code> is a <code>factor</code> formed from the 
combinations of the <code>levels</code> of several original <code>factors</code>. 
Generalized <code>factors</code> can be formed using <code>fac.combine</code>.</p>


<h3>Value</h3>

<p>A <code>projector</code> containing the symmetric, projection matrix 
and its degrees of freedom.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>fac.combine</code>, <code>projector</code>, <code>degfree</code>, 
<code>correct.degfree</code>, <code>fac.sumop</code> in package <span class="pkg">dae</span>.
</p>
<p><code>projector</code> for further information about this class.</p>


<h3>Examples</h3>

<pre><code class="language-R">## set up a two-level factor and a three-level factor, both of length 12
A &lt;- factor(rep(1:2, each=6))
B &lt;- factor(rep(1:3, each=2, times=2))

## create a generalized factor whose levels are the combinations of A and B
AB &lt;- fac.combine(list(A,B))

## obtain the operator that computes the AB means from a vector of length 12
M.AB &lt;- fac.meanop(AB)
</code></pre>


</div>