<div class="container">

<table style="width: 100%;"><tr>
<td>dbExpect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected value of cell counts in DNA database comparison</h2>

<h3>Description</h3>

<p>Computes the expected number of cell counts when comparing DNA profiles in a
DNA database. For every pair of DNA profiles in a database the number of
matching and partial matching loci is recorded. A match is declared if the
two DNA profiles coincide for both alleles in a locus and a partial-match is
recorded if only one allele is shared between the profiles. With a total of
L loci the number of matching loci is 0,...,L and partial number of matches
is 0,...,L-m, where m is the number of matching loci.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbExpect(
  probs,
  theta = 0,
  k = c(0, 0, 1),
  n = 1,
  r = 0,
  R = 0,
  round = FALSE,
  na = TRUE,
  vector = FALSE,
  collapse = FALSE,
  wildcard = FALSE,
  no.wildcard = NULL,
  rare.allele = FALSE,
  no.rare.allele = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>List of vectors with allele probabilities for each locus</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The coancestery coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The vector of identical-by-descent probabilities, k=(k2,k1,k0),
where for full-siblings k=c(1,2,1)/4. The default is k=c(0,0,1) refering to
unrelated individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of DNA profiles in the database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The probability assigned to the rare alleles (see rare allele
matching). If a vector must be of same length as <code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The probability assigned to alleles shorter or longer than allelic
ladder (see rare allele matching). If a vector must be of length 1 or 2, and
if a list it must be same length as <code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>Whether or not the results should be rounded or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>Whether or not the off-elements should be returned as 0 or NA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>Whether or not the result should be returned as a matrix or
vector. Note if 'collapse' is TRUE vector is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>Logical (default FALSE). If TRUE the (m,p)-matrix will be
collapased into a (2*m+p)-vector containing the total number of matching
alleles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wildcard</code></td>
<td>
<p>Should wildcards be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.wildcard</code></td>
<td>
<p>Should 'w' wildcards be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rare.allele</code></td>
<td>
<p>Should rare allele matching be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.rare.allele</code></td>
<td>
<p>Should 'r' rare allele loci be used?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the expected cell counts using a recursion formula. See Tvedebrink
et al (2011) for details.
</p>


<h3>Value</h3>

<p>Returns a matrix (or vector, see above) of expected cell counts.
</p>


<h3>Author(s)</h3>

<p>James Curran and Torben Tvedebrink
</p>


<h3>References</h3>

<p>T Tvedebrink, PS Eriksen, J Curran, HS Mogensen, N Morling.
'Analysis of matches and partial-matches in Danish DNA reference profile
database'. Forensic Science International: Genetics, 2011.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## Not run: 
  ## Simulate some allele frequencies:
  freqs &lt;-  replicate(10, { g = rgamma(n=10,scale=4,shape=3); g/sum(g)},
              simplify=FALSE)
  ## Compute the expected number for a DB with 10000 profiles:
  dbExpect(freqs,theta=0,n=10000)
  
## End(Not run) 

</code></pre>


</div>