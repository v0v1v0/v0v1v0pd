<div class="container">

<table style="width: 100%;"><tr>
<td>sharma.song.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sharma-Song Test for Second-Order Difference Across Contingency Tables</h2>

<h3>Description</h3>

<p>The test detects differential departure from independence via second-order difference in joint distributions underlying two or more contingency tables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sharma.song.test(
  tables, null.table.marginal = c("observed", "uniform"), 
  compensated = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>a list of at least two non-negative matrices or data frames representing contingency tables of the same dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.table.marginal</code></td>
<td>
<p>a character string to specify marginal distributions of null tables. The options are <code>"observed"</code>(default) and <code>"uniform"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compensated</code></td>
<td>
<p>a logical value to compensate for the Cochran's condition. It is only used if <code>null.table.marginal="observed"</code>. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Sharma-Song test determines whether the patterns underlying multiple input contingency tables are second-order differential. The test statistic measures differential departure form independence. Its null test statistic is proved to asymptotically follow the chi-squared distribution. For full detail of the test, see (Sharma et al. 2021).
</p>
<p>If <code>null.table.marginal</code> is set to <code>"observed"</code>, the null hypothesis uses the observed marginals. The <code>compensated</code> parameter, if set to <code>TRUE</code>, adds a small constant to each entry of the tables to address the Cochran's condition that the expected count in any table entry is 5 or less. 
</p>
<p>If the <code>null.table.marginal</code> is set to <code>"uniform"</code>, the null tables are set to have uniform marginals. No longer suffering from the Cochran's condition, it detects second-order differential patterns with additional robustness. 
</p>


<h3>Value</h3>

<p>A list with class "<code>htest</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the Sharma-Song chi-squared test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>degrees of freedom of the chi-squared test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the Sharma-Song test, computed using the chi-squared distribution.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ruby Sharma and Joe Song
</p>


<h3>References</h3>

<p>Sharma R, Kumar S, Song M (2021).
“Fundamental gene network rewiring at the second order within and across mammalian systems.”
<em>Bioinformatics</em>.
doi: <a href="https://doi.org/10.1093/bioinformatics/btab240">10.1093/bioinformatics/btab240</a>, <a href="https://doi.org/10.1093/bioinformatics/btab240">https://doi.org/10.1093/bioinformatics/btab240</a>. 
</p>


<h3>See Also</h3>

<p><code>cp.chisq.test</code>, <code>heterogeneity.test</code>,  <code>strength.test</code>, <code>marginal.change.test</code>, and
<code>type.analysis</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Two second-order differential tables:
  tables &lt;- list(
    matrix(c(4,0,0,
             0,4,0,
             0,0,4), nrow=3),
    matrix(c(0,4,4,
             4,0,4,
             4,4,0), nrow=3)
  )
  sharma.song.test(tables)
  
  # Three tables differ in the first-order but not second-order:
  tables &lt;- list(
    matrix(c(2, 4,  6,  8, 
             3, 6,  9, 12, 
             4, 8, 12, 16), nrow=4),
    matrix(c( 2, 1,  3,  7,
              2, 1,  3,  7,
             10, 5, 15, 35), nrow=4),
    matrix(c(40, 16, 72, 16, 
             45, 18, 81, 18,
             25, 10, 45, 10), nrow=4)
  )
  sharma.song.test(tables, null.table.marginal = "uniform")
</code></pre>


</div>