<div class="container">

<table style="width: 100%;"><tr>
<td>mat.sar2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Forms an sar2 correlation matrix</h2>

<h3>Description</h3>

<p>Form the correlation <code>matrix</code> of order <code>order</code> whose 
correlations follow the sar2 pattern, a pattern used in crop competition 
models. The resulting <code>matrix</code>
is banded and is a constrained AR3 matrix. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mat.sar2(gamma, order, print = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>A <code>numeric</code> containing the two values of <code>gamma</code>, being 
parameters linked with spatial dependence and competition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>The order of the <code>matrix</code> to be formed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>A <code>character</code> giving the object to be printed. Currently, 
only the claculated values of the <code>ar3parameters</code> can be printed. 
If NULL, nothing is printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values of the AR3 parameters, phi, are calculated from the gammas as follows: <br><code>phi[1] = gamma[1] + 2 * gamma[2]</code>; <code>phi[2] = -gamma[2] * (2*gamma[2] + gamma[1])</code>; <br><code>phi[3] = gamma[1] * gamma[2] * gamma[2]</code>.
</p>
<p>Then the correlations in the correlation matrix, <code>corr</code> say, are calculated 
from the correlation parameters, phi.
Let <code>omega = 1 - phi[2] - phi[3] * (phi[1] + phi[3])</code>. 
Then the values in 
</p>

<ul>
<li>
<p> the diagonal of <code>corr</code> (<code>k = 1</code>) are one; 
</p>
</li>
<li>
<p> the first subdiagonal band (<code>k = 2</code>) of <code>corr</code> are equal to 
<code>(phi[1] + phi[2]*phi[3]) / omega</code>; 
</p>
</li>
<li>
<p> the second subdiagonal band (<code>k = 3</code>) of <code>corr</code> are equal to <br><code>(phi[1] * (phi[1] + phi[3]) + phi[2] * (1 - phi[2])) / omega</code>; 
</p>
</li>
<li>
<p> the subsequent subdiagonal bands, (<code>k = 4:order</code>), of <code>corr</code> are equal to <br><code>phi[1]*corr[k-1] + phi[2]*corr[k-2] + phi[3]*corr[k-3]</code>.</p>
</li>
</ul>
<h3>Value</h3>

<p>A banded correlation <code>matrix</code> whose elements follow an sar2 pattern.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>mat.I</code>, <code>mat.J</code>, <code>mat.cor</code>, <code>mat.corg</code>, 
<code>mat.banded</code>, <code>mat.exp</code>, 
<code>mat.gau</code>, <code>mat.ar1</code>, <code>mat.ar2</code>, <code>mat.ar3</code>, <code>mat.sar</code>, 
<code>mat.ma1</code>, <code>mat.ma2</code>, <code>mat.arma</code></p>


<h3>Examples</h3>

<pre><code class="language-R">    corr &lt;- mat.sar2(gamma = c(-0.4, 0.2), order = 4)
    corr &lt;- mat.sar2(gamma = c(-0.4, 0.2), order = 4, print = "ar3")
</code></pre>


</div>