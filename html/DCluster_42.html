<div class="container">

<table style="width: 100%;"><tr>
<td>iscluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local Clustering Test Function</h2>

<h3>Description</h3>

<p>This function is passed to function <em>gam</em> as argument <em>iscluster</em>
to decide whether the current circle must be marked as a cluster or not.
</p>
<p><em>opgam.iscluster.default</em> is the function used by default, based on 
quantiles of the Poisson distribution.
</p>
<p><em>opgam.iscluster.negbin</em> is similar to the previous one but based
on the Negative Binomial distribution. Local significance
is estimated using bootstrap since it involves the sum of Negative Binomial
variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opgam.iscluster.default(data, idx, idxorder, alpha,  ...)
opgam.iscluster.negbin(data, idx, idxorder, alpha, mle, R=999, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe with the data, as explained in <em>DCluster</em> manual page.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>A boolean vector to know the areas in the current circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idxorder</code></td>
<td>
<p>A permutation of the rows of data to order the regions
according to their distance to the current center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Test signifiance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>Estimators of some parameters needed by the Negative Binomial
distribution. See <em>negbin.sim</em> manual page for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of simulations made used to estimate local pvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other arguments required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions take a number of arguments to be able to assess
whether the current ball is a cluster or not. We have follow this 
approarch to create a common framework for all scan methods.
</p>
<p>The vector returned by this functions can be of size higher than four,
but the first four elements must be those stated in this manual
page (and in the same order).
</p>
<p>More example can be found in the implementations of other scan methods,
such as Besag and Newell's, and Kulldorff and Nagarwalla's.
</p>


<h3>Value</h3>

<p>A vector with four values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Value of the statistic computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>A boolean value, which is <em>TRUE</em> for clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>The pvalue obtained for the test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Size of the cluster in inumber of regions from the centre.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>opgam, besagnewell, bn.iscluster, kullnagar, kn.iscluster, turnbull, tb.iscluster</p>


</div>